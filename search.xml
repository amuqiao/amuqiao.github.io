<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Mac下安装JDK1.8和JDK11双版本并任意切换</title>
      <link href="2023/02/14/mac-xia-an-zhuang-jdk1-8-he-jdk11-shuang-ban-ben-bing-ren-yi-qie-huan/"/>
      <url>2023/02/14/mac-xia-an-zhuang-jdk1-8-he-jdk11-shuang-ban-ben-bing-ren-yi-qie-huan/</url>
      
        <content type="html"><![CDATA[<p>1.官网下载JDK8和JDK11安装包，安装后打开bash,可以看到2个版本安装成功</p><pre class="line-numbers language-none"><code class="language-none">XXX-MacBook-Pro:~ chunyanzhang$ cd &#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachinesXXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ ls -altotal 0drwxr-xr-x  4 root  wheel  128 12 18 00:18 .drwxr-xr-x  4 root  wheel  128 11 15 17:25 ..drwxr-xr-x  3 root  wheel   96 11 15 17:25 jdk-11.0.2.jdkdrwxr-xr-x  3 root  wheel   96 12 18 00:18 jdk1.8.0_271.jdk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.编辑环境变量</p><pre class="line-numbers language-none"><code class="language-none">xport JAVA_11_HOME&#x3D;&#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk-11.0.2.jdk&#x2F;Contents&#x2F;Homeexport JAVA_8_HOME&#x3D;&#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk1.8.0_271.jdk&#x2F;Contents&#x2F;Homealias jdk8&#x3D;&#39;export JAVA_HOME&#x3D;$JAVA_8_HOME&#39;alias jdk11&#x3D;&#39;export JAVA_HOME&#x3D;$JAVA_11_HOME&#39;export JAVA_HOME&#x3D;$JAVA_8_HOMEexport ANDROID_HOME&#x3D;&#x2F;Users&#x2F;chunyanzhang&#x2F;Library&#x2F;Android&#x2F;sdkexport PATH&#x3D;$PATH:$ANDROID_HOME&#x2F;tools:$ANDROID_HOME&#x2F;platform-toolsalias python&#x3D;&quot;&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;3.11&#x2F;bin&#x2F;python3&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3.：wq! 保存并退出</p><p>4.执行使配置的环境变量生效 source ～/.bash_profile</p><p>5.查看当前jdk版本，使用命令： java -version</p><pre class="line-numbers language-none"><code class="language-none">XXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ java -versionjava version &quot;1.8.0_271&quot;Java(TM) SE Runtime Environment (build 1.8.0_271-b09)Java HotSpot(TM) 64-Bit Server VM (build 25.271-b09, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>6.在jdk8和jdk11之间切换</p><p>默认：jdk8</p><p>1）从jdk8切换到jdk11</p><pre class="line-numbers language-none"><code class="language-none">XXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ jdk11XXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ java -versionjava version &quot;11.0.2&quot; 2019-01-15 LTSJava(TM) SE Runtime Environment 18.9 (build 11.0.2+9-LTS)Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.2+9-LTS, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>从jdk11切换到jdk8<pre class="line-numbers language-none"><code class="language-none">XXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ jdk8XXX-MacBook-Pro:JavaVirtualMachines chunyanzhang$ java -versionjava version &quot;1.8.0_271&quot;Java(TM) SE Runtime Environment (build 1.8.0_271-b09)Java HotSpot(TM) 64-Bit Server VM (build 25.271-b09, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jdk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ChatGPT注册攻略</title>
      <link href="2023/02/14/chatgpt-zhu-ce-gong-lue/"/>
      <url>2023/02/14/chatgpt-zhu-ce-gong-lue/</url>
      
        <content type="html"><![CDATA[<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><ul><li>首先能能访问 Google（前置条件，不能明确说，懂得都懂）</li><li>你得有一个国外手机号，GV 号肯定不行。<ul><li>如果你没有国外手机号，推荐 sms-activate.org</li></ul></li></ul><h3 id="注册短信平台并充值"><a href="#注册短信平台并充值" class="headerlink" title="注册短信平台并充值"></a>注册短信平台并充值</h3><ul><li>先行注册 sms-activate.org</li><li>注册好之后进行对应的充值(支持支付宝)<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/n4x6tR.png" alt="n4x6tR"></li></ul><h3 id="注册OpenAI账号"><a href="#注册OpenAI账号" class="headerlink" title="注册OpenAI账号"></a>注册OpenAI账号</h3><ul><li>打开beta.openai.com/signup 页面进行相应的注册。<ul><li>这里同样需要你能访问Google且 ip 不是香港，最好是美国、新加坡等等，不然会提示不能在当前国家服务。</li></ul></li><li>注册成功进入下面填写手机号的页面<ul><li>下面记得切换下国家区号，这里的区号默认是你代理的。</li></ul></li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/QT6qj0.jpg" alt="QT6qj0"></p><h3 id="准备接码"><a href="#准备接码" class="headerlink" title="准备接码"></a>准备接码</h3><blockquote><p>这里需要注意下的就是，部分地区可能收到码，我选择的是巴西</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Opk2cg.png" alt="Opk2cg"></p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Uehg4b.png" alt="Uehg4b"></p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/JGISFI.png" alt="JGISFI"></p><p>然后再刚刚填写手机号码的页面填入申请的手机号</p><h3 id="开始使用ChatGPT"><a href="#开始使用ChatGPT" class="headerlink" title="开始使用ChatGPT"></a>开始使用ChatGPT</h3><p>注册完后，我们去ChatGPT网站去登陆。chat.openai.com/auth/login<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/YeHrD8.jpg" alt="YeHrD8"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Fe12re.jpg" alt="Fe12re"></p><h3 id="可能碰到的问题"><a href="#可能碰到的问题" class="headerlink" title="可能碰到的问题"></a>可能碰到的问题</h3><h4 id="接不到码"><a href="#接不到码" class="headerlink" title="接不到码"></a>接不到码</h4><ul><li>接不到码，可以在那个有效期内退回换个号试试。</li><li>有人直接把发的电话输入框里，没去掉区号也可以收到</li><li>这个接码网站很全面，我演示充值是 1 美元，你也可以冲一个 0.18美元</li><li>目前完全支持的是印度+巴西。你也可以选择其他国家的 any+other 选择合适的费用即可。</li></ul><h4 id="无法访问"><a href="#无法访问" class="headerlink" title="无法访问"></a>无法访问</h4><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/E6N9kY.png" alt="E6N9kY"><br>若出现ChatGPT官网拒绝访问的情况<br>一般你出现这种问题，就是因为你的代理没有全局，或者位置不对。香港或中国的的代理是100%无法通过的。</p><p>只要你出现了这个提示，那么你接下来怎么切换代理，都是没用的。需要清空浏览器缓存。<br>快速轻松浏览器缓存，先复制下面这段代码</p><pre class="line-numbers language-none"><code class="language-none">window.localStorage.removeItem(Object.keys(window.localStorage).find(i&#x3D;&gt;i.startsWith(&#39;@@auth0spajs&#39;)))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>按f12进入开发者模式，在控制台进行粘贴<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/8uxplO.png" alt="8uxplO"></p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><a href="https://juejin.cn/post/7173447848292253704">https://juejin.cn/post/7173447848292253704</a></li><li><a href="https://www.bilibili.com/read/cv20340415">https://www.bilibili.com/read/cv20340415</a></li><li><a href="https://uzbox.com/ai/sms-activate-chatgpt.html">https://uzbox.com/ai/sms-activate-chatgpt.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ChatGPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>经济学人20230202</title>
      <link href="2023/02/02/jing-ji-xue-ren-20230202/"/>
      <url>2023/02/02/jing-ji-xue-ren-20230202/</url>
      
        <content type="html"><![CDATA[<p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0001.jpg" alt="0001"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0002.jpg" alt="0002"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0003.jpg" alt="0003"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0004.jpg" alt="0004"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0005.jpg" alt="0005"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0006.jpg" alt="0006"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0007.jpg" alt="0007"></p><iframe src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/economist/2023/2.2.pdf" style="width:800px; height:500px;" frameborder="0"></iframe>]]></content>
      
      
      <categories>
          
          <category> 外刊精读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 经济学人 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python生成csv</title>
      <link href="2022/07/03/python-sheng-cheng-csv/"/>
      <url>2022/07/03/python-sheng-cheng-csv/</url>
      
        <content type="html"><![CDATA[<h3 id="写csv"><a href="#写csv" class="headerlink" title="写csv"></a>写csv</h3><pre class="line-numbers language-none"><code class="language-none">import csvymds &#x3D; [&#39;20180611&#39;, &#39;20180612&#39;]data &#x3D; &#123;    &#39;20180611&#39;:&#123;        &#39;name&#39;: &#39;tom&#39;,        &#39;score&#39;: 90    &#125;,    &#39;20180612&#39;:&#123;        &#39;name&#39;: &#39;tom&#39;,        &#39;score&#39;: 95    &#125;&#125;with open(&#39;test.csv&#39;, &#39;w&#39;) as f:    title_list &#x3D; [&#39;date&#39;, &#39;name&#39;, &#39;score&#39;]    fieldnames &#x3D; title_list  # 标题名称    writer &#x3D; csv.DictWriter(f, fieldnames&#x3D;fieldnames)    writer.writeheader()        for ymd in ymds:        row &#x3D; &#123;            &#39;date&#39;: ymd,            &#39;name&#39;: data[ymd][&#39;name&#39;],            &#39;score&#39;: data[ymd][&#39;score&#39;]        &#125;        writer.writerow(row)  # 按行写入    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="读csv"><a href="#读csv" class="headerlink" title="读csv"></a>读csv</h3><pre class="line-numbers language-none"><code class="language-none">def read_csv(file_name):    line &#x3D; []<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> csv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>非谓语动词详解II</title>
      <link href="2022/06/24/fei-wei-yu-dong-ci-xiang-jie-ii/"/>
      <url>2022/06/24/fei-wei-yu-dong-ci-xiang-jie-ii/</url>
      
        <content type="html"><![CDATA[<h2 id="Stage-II-核心"><a href="#Stage-II-核心" class="headerlink" title="Stage II 核心"></a>Stage II 核心</h2><p>我在以前的帖子中说过，与汉语相比，英语非常重视句子结构的严谨，【主谓宾(主系表)】是任何一个句子的基础。无论多么复杂冗长的句子，它<strong>有且仅有</strong>一个谓语动词。对于英语的句子结构，申小龙在1998年的著作《中国句型文化》有生动地描写：</p><blockquote><ol><li>英语句子呈「<strong>树</strong>」状辅排，即以主语与谓语动词搭配形成形式主轴，即句子的主干成分。</li></ol><ol start="2"><li>然后利用各种关联词和介词等把句中的各种短语（介词短语，名词短语），附加成分（同位语，插入语），分词（现在分词分句，独立成分）和从句（定语从句，状语从句，同位语从句）往这根主干上钩搭。<strong>犹如一棵枝叶横生的大树，盘根错节</strong>。</li></ol></blockquote><p>任何完整的一个英语句子，无论长短复杂，本质就是一棵树，它【<strong>有且必有】</strong>一个主干，即主语+谓语+（宾语）。</p><p>申小龙的精辟概括用下图描述：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/C6qEWk.jpg" alt="英语句子的树形结构"></p><p>说的通俗一点，如果把谓语动词比作老虎，那么英语句子就是【一山不容二虎】，绝对不允许两个（或更多）谓语动词同时存在。这时候，问题就来了：如果表达的意思比较复杂，涉及到了多个动作（动词），那英语是不是就要用多个完整独立的句子来分别表达了？</p><p>当然不需要，英语没有这么白痴。</p><p>谓语动词是老虎，一山不容二虎。这时候如果句子中需要出现其它动词，这个动词必须被【<strong>降级</strong>】，才能和谓语动词同时存在。通常来讲，有以下几种被<strong>降级</strong>的方式：</p><ol><li><strong>降为非谓语动词形态</strong>（不定式，现在式，过去式）</li><li><strong>从句形态</strong></li><li><strong>从属连词，例如because，although等（</strong>注意：这里不包括并列连词and，but和or。这一点我以后会讲）</li></ol><p>对应到第一个图，上面1，2，3种办法都让动词变成了树枝的形式，钩搭在【主谓宾】主干上。比如2，定语从句和状语从句的<strong>关系连词</strong>（which，that，when，whatever等）都是<strong>降级的标志</strong>，其后的从句虽然拥有自己的主谓宾结构，但这个谓语已经被关系连词降级了，例如定语从句：</p><blockquote><p>The boy who is crying said this.</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/q0L6uy.jpg" alt="定语从句"></p><p>我们学从句的时候被关系连词搞的晕头转向，不过从树形结构上来看，却很容易理解。你可以把他们理解为一种<strong>降级标记</strong>：<strong>从句中的谓语动词被降级，以树枝的形式存在，关系连词是将树枝钩搭在主干上的钩子</strong>。这时候如果漏了关系连词who，句子就会有两个谓语动词同时存在（said和is），违反了一个句子有且仅有一个谓语动词的规则，语法上句子就是错的。</p><p>第3点也是如此，although，because这些从属连词中的<strong>从属</strong>二字其实就是<strong>降级</strong>的意思，即让其后的句子变成从属关系（树枝）。聪明的你看到这里可能也明白了为什么although和but不能连用，因为这样两个句子都被降级，于是全句没有主干了，语法上就不构成一个完整的句子了。</p><hr><p>现在回到第1点，本篇帖子的核心——非谓语动词。</p><p>如果你打开任意一本语法书，里面会列出非谓语动词可以做的所有句子成分，主语，宾语，定语等等。</p><p>在<a href="http://mp.weixin.qq.com/s?__biz=MzIzMzE5NjIzMQ==&mid=2653450378&idx=1&sn=69d2e94aede5c920a7bba1c70ca36ba9&chksm=f3558f22c4220634d377555c1deab8d78b3bab8c9b949bde82c82469882ebf6972e3438342cb&scene=21#wechat_redirect">上一推</a>中，我们说了<strong>不定式和进行式可以被名词化</strong>，这时候，它们是可以做主干中的主语或者宾语的：</p><p><strong>1. 宾语（表语）：</strong></p><blockquote><p>I want <strong>to walk</strong>.</p><p>不定式to walk是名词，作谓语动词want的宾语。</p><p>I like <strong>walking</strong>.</p><p>动名词walking是名词，作谓语动词like的宾语。</p><p>His wish is <strong>to walk</strong>.</p><p>不定式to walk是名词，作表语。</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/4g210G.png" alt="名词化的非谓语动词作宾语"></p><p><strong>2. 主语</strong>：</p><blockquote><p>Walking is good.</p><p>动名词walking是名词，作主语。</p><p><strong>To see</strong> is to believe.</p><p>不定式to see是名词，作主语。</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/xymIRD.png" alt="名词化的非谓语动词作主语"></p><p>以上两种情况，由于不定式和进行式由动词变成了名词，可充当主语或宾语（表语），因此可以存在于树形结构中的主干中。</p><p>除了这两种情况之外，非谓语动词充当的其它成分都是以树枝的形式钩搭在主干上的，如定语，补语，状语等。在意思上，它们对主干提供的信息作补充说明。绝大多数语法书在讲到这部分时，都会按照句子成分来分别给出例句，令很多人都摸不着头脑。其实，个人认为，并不需要关注在句子中的成分，我们只需要牢牢把握住两点就能够准确确定非谓语动词：</p><ol><li>确定非谓语动词的逻辑主语，并确定它们之间是主动还是被动关系；</li><li>明确非谓语动词和主干谓语动词之间的时间关系。</li></ol><p>这两点是准确运用非谓语动词的核心。对于第2点，我会在扩展部分详细解释。我们先把关注放在第1点，无论非谓语动词在句中充当何种成分，它都拥有一个逻辑主语。根据非谓语动词和逻辑主语之间的主被动关系，配合非谓语动词的思维内涵，按照下表选择合适的形式：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/LugYp2.png" alt="语态"></p><p>我们通过例子来说明：</p><p>逻辑主语【世界（world）】和动词【改变（change）】，二者的关系可以是主动，也可以是被动，也就是说上表的5种形式都可以用，但是具体使用哪一个就取决于在句子中的思维内涵了，例句如下：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/OroGi1.png" alt="语态"></p><p>五个例句中动词change的逻辑主语都是world，我们只需要明确它们是主动还是被动关系，如：</p><blockquote><p>This is a changing world。</p><p>world和change是主动关系，世界正在改变，这里change前置于逻辑主语world。</p><p>This is a world being changed by globalization。</p><p>world和change是被动关系，世界正在被改变，这里change后置于逻辑主语world。</p></blockquote><p>可见，只要确定了逻辑主语，以及它和动词之间的主被动关系，配合思维内涵就可以准确使用非谓语动词。</p><p>上面的例子中，无论前置还是后置，逻辑主语和非谓语动词都是紧紧挨在一起的，可有时候不是这样的，我们需要自己确定逻辑主语：</p><blockquote><p>We have empty bottles to recycle.</p><p>我们有很多空瓶子要回收。</p><p>recycle的逻辑主语是We，所以用不定式的主动形式。</p><p>We have empty bottles to be recycled.</p><p>我们有很多空瓶子等着被回收。</p><p>recycle的逻辑主语是We，所以用不定式的被动形式。</p></blockquote><p>那么下面这个句子很多人会认为错了，因为problem和deal with明显是被动关系啊</p><blockquote><p>There is a problem to deal with.</p></blockquote><p>其实这个句子是对的，只是逻辑主语（sb）被省略了，补全如下：</p><blockquote><p>There is a problem for you to deal with.</p><p>you和deal with是主动关系。</p></blockquote><p>当然，这个句子也可以写成</p><blockquote><p>There is a problem to be dealt with.</p><p>这时候逻辑主语就变成了problem。</p><p>My mother would always buy me some toys to play with.</p><p>play with的逻辑主语是me。</p></blockquote><p>通过这些例句，我们应该明白了如何识别非谓语动词的逻辑主语，以及如何确定它们之间主被动关系了。下面我们来看稍微复杂点的情况。</p><p>上面说了，一个句子只能有一个主语+谓语动词，如果要加入另外的动词，就必须通过1，2或3的方式<strong>降级</strong>。例如下面的A和B句：</p><blockquote><p>句子A：My colleague has the report.</p><p>句子B：My colleague teaches English.</p></blockquote><p>两个句子都是【主谓宾】结构，如果要合并，就必须要将其中一个谓语动词降级，我们将B句降级成树枝。</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/ABCMaT.png" alt="合并句子"></p><p>合并后的句子为：</p><blockquote><p>My colleague who teaches English has the report.</p></blockquote><p>这个句子语法上没有错误，但是外国人很少会这样说，因为略显啰嗦。因此，<strong>当定语从句本身较为简单，且只是描述一种状态（teaches）的时候，我们可以将定语从句简化成非谓语动词</strong>：</p><blockquote><p>My colleague teaching English has the report.</p><p>colleague是teach的逻辑主语，主动关系，由于描述的是现在的状态，所以用现在式。</p></blockquote><p><strong>另外，当定语从句为who+be或which+be的形式时，有时候也可以简化为非谓语动词</strong>：</p><blockquote><p>原句：The first textbook which was written for English teaching came out in the 16th century.</p><p>改为：The first textbook written for English teaching came out in the 16th century.</p><p>textbook和written是被动关系，并且已经写完，所以用完成式。</p></blockquote><p>除了以上两种情况以外，还有以下几种情况中的从句往往都简化为非谓语动词：</p><p><strong>1. 表示原因，并且两个句子主语相同</strong></p><blockquote><p>句A：I didn’t receive any message from her.</p><p>句B：I gave her a phone call.</p></blockquote><p>以通过从句降级的方式来合并两个句子，句子A通过连词as降级为原因状语从句：</p><blockquote><p>As I didn’t receive any message from her, I gave her a phone call.</p><p>由于我没有收到她任何的消息，我就给她打了电话。</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/0eaVwL.png" alt="主语相同"></p><p>可见，两个句子的主语相同，从句表示原因，此时可以直接将从句简化为分词：</p><blockquote><p>Not receiving any message from her, I gave her a call.</p><p>没有收到她的消息，我打电话给她了。<br>I是receive的逻辑主语，是主动关系，表明没有收到的状态，所以为进行式的主动形态。<br>Helped by local students, we spent only an hour to complete the job.<br>有当地学生的帮忙，我们只花了一个小时就完成了工作。<br>we和help是被动关系，工作已经完成，所以用完成态。</p></blockquote><p><strong>2. 表示结果。</strong></p><blockquote><p>In Sydney the Chinese team got 28 gold medals, who ranked third of all the competing countries.</p></blockquote><p>who的先行词是the Chinese team，这里可以直接简化为非谓语动词形式</p><blockquote><p>In Sydney the Chinese team got 28 gold medals, ranking third of all the competing countries.<br>the Chinese team和rank是主动关系，用进行态的主动形式。</p></blockquote><p>注意，当表示结果的时候，逻辑主语有可能是整个句子。</p><blockquote><p>Carbon burns in oxygen or air, forming carbon dioxide.</p><p>form的逻辑主语是前面的整个句子，不仅仅是Carbon。</p></blockquote><p>当然，真实中非谓语动词作状语的情况要更加丰富多样，我就不再这里举例了，因为它们基本的原理都相通。在实际学习中，要不断增加输入量，满满去感受分词作状语的效果。这只能下死功夫。</p><h2 id="Stage-III-扩展"><a href="#Stage-III-扩展" class="headerlink" title="Stage III 扩展"></a>Stage III 扩展</h2><p>在上一节，我说过学好非谓语动词需要把握两点：</p><ol><li>确定非谓语动词的逻辑主语，并确定它们之间是主动还是被动关系；</li><li>明确非谓语动词和主干谓语动词之间的时间关系。</li></ol><p>第1点我们已经说完了，现在来看第2点。<strong>非谓语动词也可以带有时态，但这个时态也被降级了，非谓语动词的时态只是【相对时态】，即和主干谓语动词设立时间参考点的相对时间。</strong></p><p>之前表是非谓语动词的一般态，下面的表拓展了完成态和进行态：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/RkLKV3.png" alt="完成态和进行态"></p><ol><li><strong>强调</strong>非谓语动词时间早于主干谓语动词，用完成态。</li><li><strong>强调</strong>非谓语动词时间和主干谓语动词同时进行，用进行态。</li><li>非谓语动词时间是主干谓语动词的将来，用一般态的不定式。</li></ol><p>介于此，由于非谓语动词带有了被降级的时态属性，我们常常用它来<strong>特意强调</strong>时间顺序。</p><blockquote><p>给他讲了这么多遍之后，他才明白。<br>Having been told this many times, he finally understood it.<br>he和tell是被动关系，并且强调动作先后：被告知了多次—–&gt;才理解，所以用进行式的完成态。</p></blockquote><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/UtFcHq.png" alt="UtFcHq"></p><blockquote><p>He was angry with himself for having made such a stupid mistake.<br>he是made的逻辑主语，主动关系，强调made在was angry之前，所以用进行式的完成态。</p></blockquote><p>注意，我在描述完成态时，特意加粗了<strong>强调</strong>二字。这是因为在实际使用中，完成态和一般态的界限往往不明显，譬如之前的一个例句</p><blockquote><p>Not receiving any message from her, I gave her a call.<br>没有收到她的任何消息，我打电话给她了。</p></blockquote><p>严格意义上讲，receive肯定是在give之前，是应该用完成态的。但其实老外一般没有那么严谨，这种说法反而更加普遍一些。所以，除非你是在刻意强调时间的先后顺序，才会将句式写成：</p><blockquote><p>Not having received any message from her, I gave her a call.<br>没有收到她的任何消息之后，我打电话给她了。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 考研英语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 非谓语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>非谓语动词详解I</title>
      <link href="2022/06/23/fei-wei-yu-dong-ci-xiang-jie-i/"/>
      <url>2022/06/23/fei-wei-yu-dong-ci-xiang-jie-i/</url>
      
        <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a><strong>基础</strong></h2><p>汉语中的动词不需要变形，一个动词在字典里是什么样，在句子里就是什么样子。如果要描述这个动作发生的时间或者状态，可以通过另外的状语来达成，但是动词本身不会变化。这是汉语的特点。</p><p>英语则完全不同。理解非谓语动词，首先要意识到这一点。</p><h2 id="时态"><a href="#时态" class="headerlink" title="时态"></a>时态</h2><p><strong>所有的动作都有两个内涵，一个是状态，一个是时间。</strong></p><p>时间好理解，就是这个动作发生的时间，是在过去，现在，还是将来。状态和时间<strong>没有关系</strong>，状态是描述动作还没发生？正在发生？将要发生？还是已经结束？</p><p>状态和时间交错就形成了英语的时态。如果用数学逻辑来诠释就是：</p><p><strong>时间（4种） X 状态（4种） = 时态（16种）</strong></p><p>汉语通过另外的状语表现时态。英语通过<strong>动词变形</strong>，使动词具有了【状态】和【时间】两个属性。一个躺在字典中的动词，只表示一个抽象的动作，既没有状态也没有时间，我们称之为动词原形，英文叫做base form(基本形式)。动词原形就像是一个初生的婴儿，没有工作能力，它不能在句子中充当任何成分。</p><p>而当动词拥有了【<strong>状态</strong>】和【<strong>时间</strong>】属性后，它就由一个婴儿成长为一个健全的成年人，可以在句子中充当谓语，我们将其称之为<strong>谓语动词</strong>。也就是说，<strong>谓语动词是既具有【状态】也具有【时间】的动词，它们彼此为充分必要条件（谓语动词&lt;—&gt;状态+时间）</strong>。</p><p>像小孩子长大一样，动词由base form到谓语动词也不是一蹴而就的。过程分为两步，第一步，<strong>动词原形先被赋予【状态】，变成了非谓语动词</strong>；第二步，再被赋予【时间】，最终成为谓语动词。</p><p>非谓语动词具有【状态】属性，但不具有【时间】属性。非谓语动词不能做谓语，在句子中只能充当其它成分。也正是如此，人们觉得非谓语动词难学，因为它可以充当除了谓语之外几乎任何成分。</p><p>非谓语动词本质也是动词，表示动作，是动作就一定有逻辑上的主语。因此学好非谓语动词的一条重要原则是：<strong>要明确它的逻辑主语是谁，它们之间是主动还是被动关系。</strong></p><p>到此，我们从宏观上知道了非谓语动词的内涵。下面我们再回到源头，来详述它的来龙去脉。</p><ol><li>既然说非谓语动词有【状态】属性，那么到底有几个状态？</li></ol><p>以一个具体的动词fall为例。</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/zvKGbr.jpg" alt="zvKGbr"></p><p>fall的动词原形</p><p>上图是字典里的fall，是动词原形，无状态无时间，只表示一个抽象的动作。</p><p>我们想象如下的一个场景，Joe在挑战一项极限运动，从开始，坠落中到躺在地上。</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/1eZO3q.jpg" alt="1eZO3q"></p><h2 id="非谓语动词的三种形式"><a href="#非谓语动词的三种形式" class="headerlink" title="非谓语动词的三种形式"></a>非谓语动词的三种形式</h2><p>I. <strong>不定态 to fall</strong>。他准备要fall，但是还没有fall，动作还没发生，强调<strong>要发生还未发</strong>生的<strong>状态</strong>。</p><blockquote><p>Joe wants to fall.</p></blockquote><p><strong>II. 进行态 falling</strong>。他正在fall，动作正在进行，强调<strong>正在进行</strong>的<strong>状态</strong>。</p><blockquote><p>Joe is falling.</p></blockquote><p><strong>III. 完成态 fallen</strong>。他已经fall完了，现在躺在地上，强调<strong>已经完成</strong>的<strong>状态</strong>。</p><blockquote><p>Joe lay fallen on the ground.</p></blockquote><p>我相信这个例子是非常容易理解的，它很浅显的描述了三大非谓语动词的内涵。当然，不同于一般语法书只是概念的罗列，这个例子<strong>揭示了三个非谓语之间的内在联系</strong>。</p><p>总结一下三大非谓语动词，就得到了下表：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/FYBYpZ.jpg" alt="FYBYpZ"></p><p>这是非谓语动词最核心，也是最简单的表格，随着内容的深入，我们会逐渐扩展这个表。</p><p>刚才我说过一条重要的原则，非谓语动词本质也是动词，动词必然存在逻辑主语，例如上例中的fall的逻辑主语就是Joe，它们之间是主动还是被动的关系就决定了用形式上的主动还是被动。这一点我们后面还会讲。</p><h2 id="非谓语动词的名词化"><a href="#非谓语动词的名词化" class="headerlink" title="非谓语动词的名词化"></a>非谓语动词的名词化</h2><p><strong>2. 先来歪个楼：非谓语动词的名词化</strong></p><p>这篇帖子是将【非谓语动词】当做动词来诠释的，那就总有动作的实施者（主动）或者动作的承受者（被动）。而之所以我在标题说歪个楼，是因为本小节探讨的是<strong>名词化了的非谓语动词</strong>，也就是说，它们虽然依旧被称为【非谓语动词】，但实际上它们已经变成了名副其实的名词。</p><p>上面的表格中，<strong>只有不定态和进行态都可以名词化，完成态不可以名词化</strong>。在其它语法书中，进行态的名词化被称为<strong>动名词</strong>。</p><p>汉语里的动词往往可以直接名词化，形式上不发生任何变化。比如【走路】在【我在走路】中是动词，而在【走路对你的健康好】中就是名词，前后形式上没有任何变化。英语不同，动词walk表示走路，【I usually <strong>walk</strong> home】，但如果要名词化，就要变成to walk或者walking，【<strong>Walking</strong> is good for your health】。这时候，动词walk由具体的动作抽象成为了走路这个概念，这时候我们就不必关心【谁】走路，对于名词化的非谓语动词，逻辑主语自然就淡化了。</p><p>不定态（to do）和进行态（doing）都可以名词化，那么它们的区别是什么呢？实际上，万变不离其宗，它们的区别来源于内涵，就还是上面那张表，to do的往往有<strong>变化</strong>的意味，要做未做，还没发生；doing的内涵是<strong>进行</strong>，所以常常指现状。另外，doing和to do比，往往将动词的<strong>抽象化</strong>，<strong>一般化</strong>了。</p><p><strong>I. 名词做主语</strong></p><blockquote><p><strong>To complete the project</strong> needs much effort. 项目没有做完，有【将做未做】的内涵。</p><p><strong>Swimming</strong> is a great pleasure for me. 这里的swimming指游泳这个一般化的动作，swimming相比to swim要更合适些。</p></blockquote><p><strong>II. 名词做宾语</strong></p><p>I expected <strong>a salary increase.</strong> 中及物动词expect后面一定是名词。那么如果要用动词，就一定要用名词化的非谓语动词（to do或doing），就应该写成：</p><blockquote><p>I expected <strong>to receive a salary increase</strong>.</p></blockquote><p>在expected的时间点上，加薪还是一件将发生而未发生的事情，属于不定态的内涵本质。这样说来，</p><blockquote><p>I expected <strong>receiving a salary increase</strong>.</p></blockquote><p>虽然语法上没有错，但却是不正确的。（注意，在某些情境下，作者可能为了某种表达需要，刻意用这种方式，这属于个人的写作风格。）</p><p>类似的例子还有：</p><blockquote><p>I decided <strong>to leave</strong> early.</p><p>They are hoping <strong>to arrive</strong> on time.</p><p>We should arrange <strong>to meet</strong> at 10.00pm.</p></blockquote><p>都不能替换为动名词（doing）形式。</p><p>再来看如下的例子：</p><blockquote><p>My boss is used to <strong>working long hours</strong>.</p><p>He is <em>looking forward to</em> <strong>meeting her</strong>.</p><p>I am <em>good at</em> <strong>swimming</strong>.</p></blockquote><p>上面例子中的 to 是介词，介词后面一定是名词。那么为什么要用动名词呢？其实又回到了思维内涵，这三个例子都强调动作本身，没有不定态内涵【变化】的意思。</p><p>再来看两个很常用的句子：</p><blockquote><p>I like <strong>to eat fish</strong>.</p><p>I like <strong>eating fish</strong>.</p></blockquote><p>两个句子都常用，你能从思维上体会二者的不同吗？二者大体的意思是相同的。细微的差别在于，前者的不定态体现在【我可以吃鱼，也可以吃鸡，但是我显然喜欢吃鱼肉】的意味里，类似 I prefer to eat fish。而后者的画面是【我正在吃鱼】，我喜欢吃鱼这个过程，由进行感，类似I enjoy eating fish。</p><p>从这个意义上讲，如果你正生活在X地，而且你很喜欢这里。更合适的说法就是 I like living here，这时候 I like to live here 就稍稍有点不太合适了。</p>]]></content>
      
      
      <categories>
          
          <category> 考研英语 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 非谓语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFS日志采集案例</title>
      <link href="2021/06/11/hdfs-ri-zhi-cai-ji-an-li/"/>
      <url>2021/06/11/hdfs-ri-zhi-cai-ji-an-li/</url>
      
        <content type="html"><![CDATA[<p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/G4Qbv4.png" alt="G4Qbv4"></p><h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><ul><li>定时采集已滚动完毕日志文件 </li><li>将待采集文件上传到临时目录 </li><li>备份日志文件</li></ul><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><h3 id="验证调优"><a href="#验证调优" class="headerlink" title="验证调优"></a>验证调优</h3>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
            <tag> log </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFS读写数据解析</title>
      <link href="2021/06/04/hdfs-du-xie-shu-ju-jie-xi/"/>
      <url>2021/06/04/hdfs-du-xie-shu-ju-jie-xi/</url>
      
        <content type="html"><![CDATA[<h3 id="HDFS读数据流程"><a href="#HDFS读数据流程" class="headerlink" title="HDFS读数据流程"></a>HDFS读数据流程</h3><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/s76ija.png" alt="读数据流程"></p><ol><li>客户端通过Distributed FileSystem向NameNode请求下载文件，NameNode通过查询元数据， 找到文件块所在的DataNode地址。</li><li>挑选一台DataNode（就近原则，然后随机）服务器，请求读取数据。</li><li>DataNode开始传输数据给客户端（从磁盘里面读取数据输入流，以Packet为单位来做校验）。</li><li>客户端以Packet为单位接收，先在本地缓存，然后写入目标文件。</li></ol><h3 id="HDFS写数据流程"><a href="#HDFS写数据流程" class="headerlink" title="HDFS写数据流程"></a>HDFS写数据流程</h3><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/vB0RtP.png" alt="写数据流程"></p><ol><li>客户端通过Distributed FileSystem模块向NameNode请求上传文件，NameNode检查目标文件 是否已存在，父目录是否存在。</li><li>NameNode返回是否可以上传。</li><li>客户端请求第一个 Block上传到哪几个DataNode服务器上。</li><li>NameNode返回3个DataNode节点，分别为dn1、dn2、dn3。</li><li>客户端通过FSDataOutputStream模块请求dn1上传数据，dn1收到请求会继续调用dn2，然后 dn2调用dn3，将这个通信管道建立完成。</li><li>dn1、dn2、dn3逐级应答客户端。</li><li>客户端开始往dn1上传第一个Block（先从磁盘读取数据放到一个本地内存缓存），以Packet为单 位，dn1收到一个Packet就会传给dn2，dn2传给dn3；dn1每传一个packet会放入一个确认队列 等待确认。</li><li>当一个Block传输完成之后，客户端再次请求NameNode上传第二个Block的服务器。（重复执行 3-7步）。</li><li></li></ol><h3 id="演示从本地文件系统上传文件到hdfs"><a href="#演示从本地文件系统上传文件到hdfs" class="headerlink" title="演示从本地文件系统上传文件到hdfs"></a>演示从本地文件系统上传文件到hdfs</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//1. 准备读取本地文件的输入流</span>    <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/Users/wangqiao/Downloads/test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//2. 准备好写出数据到hdfs的输出流</span>    <span class="token class-name">FSDataOutputStream</span> fsDataOutputStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/api_test/test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Progressable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">progress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// 这个progress方法就是每传输64KB（packet）就会执行一次</span>            <span class="token comment">// 如果有数据要传递，建立通道时会执行一次</span>            <span class="token comment">// 所以当传输 0kb的文件时，不会打印&amp;</span>            <span class="token comment">// 传递小于64kb的文件时打印2个&amp;</span>            <span class="token comment">// 传递小于128kb的文件时会打印3个&amp;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//3. 实现流拷贝 默认关闭流选项是true，所以会自动关闭</span>    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copyBytes</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">,</span> fsDataOutputStream<span class="token punctuation">,</span> conf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//4. 关闭流 可以再次关闭也可以不关了</span>    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">closeStream</span><span class="token punctuation">(</span>fsDataOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">closeStream</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
            <tag> hdfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Hadoop 完全分布式集群搭建（四）</title>
      <link href="2021/06/04/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-si/"/>
      <url>2021/06/04/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-si/</url>
      
        <content type="html"><![CDATA[<h3 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h3><h4 id="修改副本数量"><a href="#修改副本数量" class="headerlink" title="修改副本数量"></a>修改副本数量</h4><p>在configuration中新增配置，并同步到其他节点</p><pre class="line-numbers language-none"><code class="language-none">vi hdfs-site.xml&lt;configuration&gt;     &lt;property&gt;         &lt;name&gt;dfs.replication&lt;&#x2F;name&gt;         &lt;value&gt;1&lt;&#x2F;value&gt;     &lt;&#x2F;property&gt; &lt;&#x2F;configuration&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参数优先级</p><p>参数优先级排序：（1）代码中设置的值 &gt;（2）用户自定义配置文件 &gt;（3）服务器的默认配置</p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Junit基本注解</title>
      <link href="2021/06/04/junit-ji-ben-zhu-jie/"/>
      <url>2021/06/04/junit-ji-ben-zhu-jie/</url>
      
        <content type="html"><![CDATA[<blockquote><p>unit中集中基本注解，是必须掌握的。</p></blockquote><h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><ul><li>@BeforeClass – 表示在类中的任意public static void方法执行之前执行</li><li>@AfterClass – 表示在类中的任意public static void方法执行之后执行</li><li>@Before – 表示在任意使用@Test注解标注的public void方法执行之前执行</li><li>@After – 表示在任意使用@Test注解标注的public void方法执行之后执行</li><li>@Test – 使用该注解标注的public void方法会表示为一个测试方法</li></ul><h3 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h3><p>输入</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>luffy<span class="token punctuation">.</span>junit</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">After</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">AfterClass</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Before</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">BeforeClass</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JunitDemo</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// Run once, e.g. Database connection, connection pool</span>    <span class="token annotation punctuation">@BeforeClass</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">runOnceBeforeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@BeforeClass - runOnceBeforeClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Run once, e.g close connection, cleanup</span>    <span class="token annotation punctuation">@AfterClass</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">runOnceAfterClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@AfterClass - runOnceAfterClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Should rename to @BeforeTestMethod</span>    <span class="token comment">// e.g. Creating an similar object and share for all @Test</span>    <span class="token annotation punctuation">@Before</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">runBeforeTestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@Before - runBeforeTestMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Should rename to @AfterTestMethod</span>    <span class="token annotation punctuation">@After</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">runAfterTestMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@After - runAfterTestMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_method_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@Test - test_method_1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_method_2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"@Test - test_method_2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@BeforeClass</span> <span class="token operator">-</span> runOnceBeforeClass<span class="token annotation punctuation">@Before</span> <span class="token operator">-</span> runBeforeTestMethod<span class="token annotation punctuation">@Test</span> <span class="token operator">-</span> test_method_1<span class="token annotation punctuation">@After</span> <span class="token operator">-</span> runAfterTestMethod<span class="token annotation punctuation">@Before</span> <span class="token operator">-</span> runBeforeTestMethod<span class="token annotation punctuation">@Test</span> <span class="token operator">-</span> test_method_2<span class="token annotation punctuation">@After</span> <span class="token operator">-</span> runAfterTestMethod<span class="token annotation punctuation">@AfterClass</span> <span class="token operator">-</span> runOnceAfterClass<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.cnblogs.com/hezhiyao/p/9440277.html">认识Junit基本注解@Before、@After、@Test、@BeforeClass、@AfterClass</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> junit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAC安装JDK8</title>
      <link href="2021/06/03/mac-an-zhuang-jdk8/"/>
      <url>2021/06/03/mac-an-zhuang-jdk8/</url>
      
        <content type="html"><![CDATA[<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="下载java8安装包"><a href="#下载java8安装包" class="headerlink" title="下载java8安装包"></a>下载<code>java8</code>安装包</h4><p>前往<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle官网</a>下载java8版本安装包 </p><p>当前演示版本为 jdk-8u291-macosx-x64.dmg<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/SgHA5z.png" alt="SgHA5z"></p><h4 id="安装java8"><a href="#安装java8" class="headerlink" title="安装java8"></a>安装<code>java8</code></h4><p>安装完成后查看版本信息</p><pre class="line-numbers language-none"><code class="language-none">➜  Downloads java -versionjava version &quot;1.8.0_291&quot;Java(TM) SE Runtime Environment (build 1.8.0_291-b10)Java HotSpot(TM) 64-Bit Server VM (build 25.291-b10, mixed mode)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>定位<code>JAVA_HOME</code>位置</p><pre class="line-numbers language-none"><code class="language-none">➜  ~ &#x2F;usr&#x2F;libexec&#x2F;java_home -VMatching Java Virtual Machines (2):    1.8.291.10 (x86_64) &quot;Oracle Corporation&quot; - &quot;Java&quot; &#x2F;Library&#x2F;Internet Plug-Ins&#x2F;JavaAppletPlugin.plugin&#x2F;Contents&#x2F;Home    1.8.0_291 (x86_64) &quot;Oracle Corporation&quot; - &quot;Java SE 8&quot; &#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk1.8.0_291.jdk&#x2F;Contents&#x2F;Home&#x2F;Library&#x2F;Internet Plug-Ins&#x2F;JavaAppletPlugin.plugin&#x2F;Contents&#x2F;Home<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置<code>JAVA_HOME</code>环境变量, 编辑<code>~/.bash_profile</code>,添加</p><pre class="line-numbers language-none"><code class="language-none"># java export JAVA_HOME&#x3D;&quot;&#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk1.8.0_291.jdk&#x2F;Contents&#x2F;Home&quot;export CLASS_PATH&#x3D;&quot;$JAVA_HOME&#x2F;lib&quot;# 方式一export PATH&#x3D;&quot;.;$PATH:$JAVA_HOME&#x2F;bin&quot;# 方式二export PATH&#x3D;:$JAVA_HOME&#x2F;bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>验证环境变量</p><pre class="line-numbers language-none"><code class="language-none">export export $PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>使配置生效</p><pre class="line-numbers language-none"><code class="language-none">source ~&#x2F;.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>验证环境变量配置是否成功</p><pre class="line-numbers language-none"><code class="language-none">$ echo $JAVA_HOME        &#x2F;Library&#x2F;Java&#x2F;JavaVirtualMachines&#x2F;jdk1.8.0_291.jdk&#x2F;Contents&#x2F;Home<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>参考：<br><a href="https://blog.csdn.net/irokay/article/details/71374426">macOS安装java8及环境变量配置</a></p>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> mac </tag>
            
            <tag> jdk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAC配置环境变量</title>
      <link href="2021/06/03/mac-pei-zhi-huan-jing-bian-liang/"/>
      <url>2021/06/03/mac-pei-zhi-huan-jing-bian-liang/</url>
      
        <content type="html"><![CDATA[<p>编辑~/.zshrc</p><pre class="line-numbers language-none"><code class="language-none">vi ~&#x2F;.zshrc# 设置别名alias ll&#x3D;&#39;ls -alF&#39;alias la&#x3D;&#39;ls -A&#39;alias l&#x3D;&#39;ls -CF&#39;# 添加docker&#x2F;bin路径# export PATH&#x3D;$&#123;PATH&#125;:&#x2F;Applications&#x2F;Docker.app&#x2F;Contents&#x2F;Resources&#x2F;bin; # 语法 export PATH&#x3D;$&#123;PATH&#125;:相关目录路径;# hadoopexport HADOOP_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;servers&#x2F;hadoop-2.9.2export PATH&#x3D;:$HADOOP_HOME&#x2F;bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置完立即生效</p><pre class="line-numbers language-none"><code class="language-none">source ~&#x2F;.zshrc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFS常用shell命令</title>
      <link href="2021/06/03/hdfs-chang-yong-shell-ming-ling/"/>
      <url>2021/06/03/hdfs-chang-yong-shell-ming-ling/</url>
      
        <content type="html"><![CDATA[<blockquote><p>HSFS常用命令</p></blockquote><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><pre class="line-numbers language-none"><code class="language-none">bin&#x2F;hadoop fs 具体命令ORbin&#x2F;hdfs dfs 具体命令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="命令大全"><a href="#命令大全" class="headerlink" title="命令大全"></a>命令大全</h3><pre class="line-numbers language-none"><code class="language-none">[root@linux121 ~]# hdfs dfsUsage: hadoop fs [generic options][-appendToFile &lt;localsrc&gt; ... &lt;dst&gt;][-cat [-ignoreCrc] &lt;src&gt; ...][-checksum &lt;src&gt; ...][-chgrp [-R] GROUP PATH...][-chmod [-R] &lt;MODE[,MODE]... | OCTALMODE&gt; PATH...][-chown [-R] [OWNER][:[GROUP]] PATH...][-copyFromLocal [-f] [-p] [-l] [-d] &lt;localsrc&gt; ... &lt;dst&gt;][-copyToLocal [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;][-count [-q] [-h] [-v] [-t [&lt;storage type&gt;]] [-u] [-x] &lt;path&gt; ...][-cp [-f] [-p | -p[topax]] [-d] &lt;src&gt; ... &lt;dst&gt;][-createSnapshot &lt;snapshotDir&gt; [&lt;snapshotName&gt;]][-deleteSnapshot &lt;snapshotDir&gt; &lt;snapshotName&gt;][-df [-h] [&lt;path&gt; ...]][-du [-s] [-h] [-x] &lt;path&gt; ...][-expunge][-find &lt;path&gt; ... &lt;expression&gt; ...][-get [-f] [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;][-getfacl [-R] &lt;path&gt;][-getfattr [-R] &#123;-n name | -d&#125; [-e en] &lt;path&gt;][-getmerge [-nl] [-skip-empty-file] &lt;src&gt; &lt;localdst&gt;][-help [cmd ...]][-ls [-C] [-d] [-h] [-q] [-R] [-t] [-S] [-r] [-u] [&lt;path&gt; ...]][-mkdir [-p] &lt;path&gt; ...][-moveFromLocal &lt;localsrc&gt; ... &lt;dst&gt;][-moveToLocal &lt;src&gt; &lt;localdst&gt;][-mv &lt;src&gt; ... &lt;dst&gt;][-put [-f] [-p] [-l] [-d] &lt;localsrc&gt; ... &lt;dst&gt;][-renameSnapshot &lt;snapshotDir&gt; &lt;oldName&gt; &lt;newName&gt;][-rm [-f] [-r|-R] [-skipTrash] [-safely] &lt;src&gt; ...][-rmdir [--ignore-fail-on-non-empty] &lt;dir&gt; ...][-setfacl [-R] [&#123;-b|-k&#125; &#123;-m|-x &lt;acl_spec&gt;&#125; &lt;path&gt;]|[--set &lt;acl_spec&gt; &lt;path&gt;]][-setfattr &#123;-n name [-v value] | -x name&#125; &lt;path&gt;][-setrep [-R] [-w] &lt;rep&gt; &lt;path&gt; ...][-stat [format] &lt;path&gt; ...][-tail [-f] &lt;file&gt;][-test -[defsz] &lt;path&gt;][-text [-ignoreCrc] &lt;src&gt; ...][-touchz &lt;path&gt; ...][-truncate [-w] &lt;length&gt; &lt;path&gt; ...][-usage [cmd ...]]Generic options supported are:-conf &lt;configuration file&gt;        specify an application configuration file-D &lt;property&#x3D;value&gt;               define a value for a given property-fs &lt;file:&#x2F;&#x2F;&#x2F;|hdfs:&#x2F;&#x2F;namenode:port&gt; specify default filesystem URL to use, overrides &#39;fs.defaultFS&#39; property from configurations.-jt &lt;local|resourcemanager:port&gt;  specify a ResourceManager-files &lt;file1,...&gt;                specify a comma-separated list of files to be copied to the map reduce cluster-libjars &lt;jar1,...&gt;               specify a comma-separated list of jar files to be included in the classpath-archives &lt;archive1,...&gt;          specify a comma-separated list of archives to be unarchived on the compute machinesThe general command line syntax is:command [genericOptions] [commandOptions]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="HDFS命令演示"><a href="#HDFS命令演示" class="headerlink" title="HDFS命令演示"></a>HDFS命令演示</h3><ol><li>启动Hadoop集群（方便后续的测试）</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ sbin&#x2F;start-dfs.sh [root@linux123 hadoop-2.9.2]$ sbin&#x2F;start-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="2"><li>-help：输出这个命令参数</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -help rm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>-ls: 显示目录信息</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -ls &#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="4"><li>-mkdir：在HDFS上创建目录</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -mkdir -p &#x2F;lagou&#x2F;bigdata<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>-moveFromLocal：从本地剪切粘贴到HDFS</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ touch hadoop.txt[root@linux121 hadoop-2.9.2]$ hadoop fs -moveFromLocal .&#x2F;hadoop.txt &#x2F;lagou&#x2F;bigdata<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="6"><li>-appendToFile：追加一个文件到已经存在的文件末尾</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ touch hdfs.txt [root@linux121 hadoop-2.9.2]$ vi hdfs.txt输入namenode datanode block replication[root@linux121 hadoop-2.9.2]$ hadoop fs -appendToFile hdfs.txt &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="7"><li>-cat：显示文件内容 </li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -cat &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="8"><li>-chgrp 、-chmod、-chown：Linux文件系统中的用法一样，修改文件所属权限</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -chmod 666 &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt[root@linux121 hadoop-2.9.2]$ hadoop fs -chown root:root &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="9"><li>-copyFromLocal：从本地文件系统中拷贝文件到HDFS路径去</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -copyFromLocal README.txt &#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="10"><li>-copyToLocal：从HDFS拷贝到本地</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -copyToLocal &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt .&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="11"><li>-cp ：从HDFS的一个路径拷贝到HDFS的另一个路径</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -cp &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt &#x2F;hdfs.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="12"><li>-mv：在HDFS目录中移动文件</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -mv &#x2F;hdfs.txt &#x2F;lagou&#x2F;bigdata&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="13"><li>-get：等同于copyToLocal，就是从HDFS下载文件到本地</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -get &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt .&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="14"><li>-put：等同于copyFromLocal</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -mkdir -p &#x2F;user&#x2F;root&#x2F;test&#x2F; #本地文件系统创建yarn.txt [root@linux121 hadoop-2.9.2]$ vim yarn.txt resourcemanager nodemanager[root@linux121 hadoop-2.9.2]$ hadoop fs -put .&#x2F;yarn.txt &#x2F;user&#x2F;root&#x2F;test&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="16"><li>-tail：显示一个文件的末尾</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -tail &#x2F;user&#x2F;root&#x2F;test&#x2F;yarn.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="17"><li>-rm：删除文件或文件夹</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -rm &#x2F;user&#x2F;root&#x2F;test&#x2F;yarn.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="18"><li>-rmdir：删除空目录 </li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -mkdir &#x2F;test [root@linux121 hadoop-2.9.2]$ hadoop fs -rmdir &#x2F;test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="19"><li>-du统计文件夹的大小信息</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -du -s -h &#x2F;user&#x2F;root&#x2F;test[root@linux121 hadoop-2.9.2]$ hadoop fs -du -h &#x2F;user&#x2F;root&#x2F;test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="20"><li>-setrep：设置HDFS中文件的副本数量</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop fs -setrep 10 &#x2F;lagou&#x2F;bigdata&#x2F;hadoop.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hdfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAC下面有什么好用的终端工具</title>
      <link href="2021/06/01/mac-xia-mian-you-shi-me-hao-yong-de-zhong-duan-gong-ju/"/>
      <url>2021/06/01/mac-xia-mian-you-shi-me-hao-yong-de-zhong-duan-gong-ju/</url>
      
        <content type="html"><![CDATA[<blockquote><p>实际上，一个好的终端工具使用体验 = 一个好的终端 Terminal + 一个好的 Shell</p></blockquote><span id="more"></span><h3 id="如何选择-Terminal"><a href="#如何选择-Terminal" class="headerlink" title="如何选择 Terminal"></a>如何选择 Terminal</h3><p>一句话概括：想要颜值高选 Hyper, 想要性能好选 iTerm。我用的是 Hyper。<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/zfu5ww.png" alt="如何选择 Terminal"></p><h3 id="如何选择-Shell"><a href="#如何选择-Shell" class="headerlink" title="如何选择 Shell"></a>如何选择 Shell</h3><p>习惯了写 Python 的话可以选 xonsh，懒得折腾的话可以用系统默认的 bash，zsh 是在知乎上最受热捧的，fish 比 zsh 要新一点。我用的是 xonsh。</p><p>具体对比如下：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/kvMDzg.png" alt="如何选择 Shell"></p><p>如果你是新手，搞不清楚什么是 Shell, 什么是 Terminal，或者想看看上面几个工具的演示与解析，可以看下这个视频详解：</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>500</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>792</span><span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://vdn1.vzuu.com/SD/e3cc53d8-a9cb-11e8-9bd8-0242ac112a24.mp4?disable_local_cache=1&amp;auth_key=1622534176-0-0-63692becd56e6a743c78d08f951eccd8&amp;f=mp4&amp;bu=http-com&amp;expiration=1622534176&amp;v=hw<span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span> <span class="token attr-name">framespacing</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">allowfullscreen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe height=500 width=792 src="https://vdn1.vzuu.com/SD/e3cc53d8-a9cb-11e8-9bd8-0242ac112a24.mp4?disable_local_cache=1&auth_key=1622534176-0-0-63692becd56e6a743c78d08f951eccd8&f=mp4&bu=http-com&expiration=1622534176&v=hw" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Hadoop 完全分布式集群搭建（三）</title>
      <link href="2021/05/31/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-san/"/>
      <url>2021/05/31/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-san/</url>
      
        <content type="html"><![CDATA[<blockquote><p>第三部分:集群测试&amp;配置历史服务器</p></blockquote><span id="more"></span><h3 id="集群测试"><a href="#集群测试" class="headerlink" title="集群测试"></a>集群测试</h3><h4 id="HDFS-分布式存储初体验"><a href="#HDFS-分布式存储初体验" class="headerlink" title="HDFS 分布式存储初体验"></a>HDFS 分布式存储初体验</h4><p>从linux本地文件系统上传下载文件验证HDFS集群工作正常</p><pre class="line-numbers language-none"><code class="language-none"># 在HDFS文件系统根目录下面创建文件夹hdfs dfs -mkdir -p &#x2F;test&#x2F;input #本地home目录创建一个文件 vim &#x2F;root&#x2F;test.txthello hdfs#上传linxu文件到Hdfs hdfs dfs -put &#x2F;root&#x2F;test.txt &#x2F;test&#x2F;input# 删除本地文件rm -rf &#x2F;root&#x2F;test.txt#从Hdfs下载文件到linux本地 hdfs dfs -get &#x2F;test&#x2F;input&#x2F;test.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="MapReduce-分布式计算初体验"><a href="#MapReduce-分布式计算初体验" class="headerlink" title="MapReduce 分布式计算初体验"></a>MapReduce 分布式计算初体验</h4><p>在HDFS文件系统根目录下面创建一个wcinput文件夹</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hdfs dfs -mkdir &#x2F;wcinput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在/root/目录下创建一个wc.txt文件(本地文件系统),并进行编辑</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;root&#x2F;wc.txthadoop mapreduce yarn hdfs hadoop mapreduce mapreduce yarn lagou lagou lagou<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上传wc.txt到Hdfs目录/wcinput下</p><pre class="line-numbers language-none"><code class="language-none">hdfs dfs -put wc.txt &#x2F;wcinput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行程序</p><blockquote><p><code>\wcoutput</code> 目录无需手动创建，程序执行过程中会创建</p></blockquote><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2&#x2F;hadoop jar share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-examples-2.9.2.jar wordcount &#x2F;wcinput &#x2F;wcoutput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看结果</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]# hdfs dfs -cat &#x2F;wcoutput&#x2F;part-r-00000hadoop  2hdfs    1lagou   3mapreduce       3yarn    2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="本机查看hdfs目录"><a href="#本机查看hdfs目录" class="headerlink" title="本机查看hdfs目录"></a>本机查看hdfs目录</h4><p>访问 <a href="http://192.168.80.121:50070/dfshealth.html#tab-overview">http://192.168.80.121:50070/dfshealth.html#tab-overview</a><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/9nIB44.png" alt="9nIB44"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/zDoOPk.png" alt="zDoOPk"></p><h3 id="配置历史服务器"><a href="#配置历史服务器" class="headerlink" title="配置历史服务器"></a>配置历史服务器</h3><blockquote><p>在Yarn中运行的任务产生的日志数据不能查看，为了查看程序的历史运行情况，需要配置一下历史日志服务器</p></blockquote><ol><li>配置mapred-site.xml<pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop]# vi &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2&#x2F;etc&#x2F;hadoop&#x2F;mapred-site.xml# 添加以下配置&lt;!-- 历史服务器端地址 --&gt;&lt;property&gt;     &lt;name&gt;mapreduce.jobhistory.address&lt;&#x2F;name&gt;    &lt;value&gt;linux121:10020&lt;&#x2F;value&gt; &lt;&#x2F;property&gt;&lt;!-- 历史服务器web端地址 --&gt;&lt;property&gt;     &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;&#x2F;name&gt;    &lt;value&gt;linux121:19888&lt;&#x2F;value&gt; &lt;&#x2F;property&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>分发mapred-site.xml到其它节点</li></ol><pre class="line-numbers language-none"><code class="language-none">rsync-script mapred-site.xml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>启动历史服务器</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ sbin&#x2F;mr-jobhistory-daemon.sh start historyserverstarting historyserver, logging to &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2&#x2F;logs&#x2F;mapred-root-historyserver-linux121.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="4"><li>查看历史服务器是否启动</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ jps...82008 JobHistoryServer...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li>查看JobHistory</li></ol><ul><li><a href="http://linux121:19888/jobhistory">http://linux121:19888/jobhistory</a> 或者</li><li><a href="http://linux121:19888/jobhistory">http://192.168.80.121:19888/jobhistory</a></li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/P6W8a8.png" alt="历史服务器"></p><h4 id="配置日志的聚集"><a href="#配置日志的聚集" class="headerlink" title="配置日志的聚集"></a>配置日志的聚集</h4><ul><li>日志聚集：应用(Job)运行完成以后，将应用运行日志信息从各个task汇总上传到HDFS系统上。</li><li>日志聚集功能好处：可以方便的查看到程序运行详情，方便开发调试。<blockquote><p>注意：开启日志聚集功能，需要重新启动NodeManager 、ResourceManager和 HistoryManager。</p></blockquote></li></ul><ol><li>配置yarn-site.xml</li></ol><pre class="line-numbers language-html" data-language="html"><code class="language-html">[root@linux121 hadoop]$ vi yarn-site.xml# 新增以下配置<span class="token comment">&lt;!-- 日志聚集功能使能 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>yarn.log-aggregation-enable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 日志保留时间设置7天 --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>yarn.log-aggregation.retain-seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>604800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>yarn.log.server.url<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>http://linux121:19888/jobhistory/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>分发yarn-site.xml到集群其它节点</li></ol><pre class="line-numbers language-none"><code class="language-none">rsync-script yarn-site.xml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>重启历史服务器节点的NodeManager 、ResourceManager和HistoryManager</li></ol><pre class="line-numbers language-none"><code class="language-none"># 关闭[root@linux121 hadoop-2.9.2]$ sbin&#x2F;yarn-daemon.sh stop resourcemanager[root@linux121 hadoop-2.9.2]$ sbin&#x2F;yarn-daemon.sh stop nodemanager[root@linux121 hadoop-2.9.2]$ sbin&#x2F;mr-jobhistory-daemon.sh stop historyserver# 开启[root@linux121 hadoop-2.9.2]$ sbin&#x2F;yarn-daemon.sh start resourcemanager[root@linux121 hadoop-2.9.2]$ sbin&#x2F;yarn-daemon.sh start nodemanager[root@linux121 hadoop-2.9.2]$ sbin&#x2F;mr-jobhistory-daemon.sh start historyserver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>删除HDFS上已经存在的输出文件</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ bin&#x2F;hdfs dfs -rm -R &#x2F;wcoutput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>执行WordCount程序</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop jar share&#x2F;hadoop&#x2F;mapreduce&#x2F;hadoop-mapreduce-examples-2.9.2.jar wordcount &#x2F;wcinput &#x2F;wcoutput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="6"><li>查看日志，如图所示<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/gWfN3H.png" alt="历史服务器"><br>点击Job ID查看任务详情<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/H9dSE5.png" alt="任务详情"><br>点击logs查看日志详情<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/WbHxfv.png" alt="日志详情"></li></ol>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux配置ssh免密登陆</title>
      <link href="2021/05/31/linux-pei-zhi-ssh-mian-mi-deng-lu/"/>
      <url>2021/05/31/linux-pei-zhi-ssh-mian-mi-deng-lu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>三台机器机器实现互相免密码登录</p></blockquote><span id="more"></span><p>三台机器规划<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/6ZP9e2.png" alt="6ZP9e2"></p><ol><li>配置hostname与IP映射</li></ol><p>修改hosts文件，在三台机器上增加以下配置</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;hosts192.168.80.121 linux121192.168.80.122 linux122192.168.80.123 linux123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><p>在所有主机上创建⽬录并赋予权限</p><pre class="line-numbers language-none"><code class="language-none">mkdir &#x2F;root&#x2F;.ssh chmod 700 &#x2F;root&#x2F;.ssh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>在三台机器执⾏以下命令，⽣成公钥与私钥</p><pre class="line-numbers language-none"><code class="language-none">cd ~ #进⼊⽤户⽬录 ssh-keygen -t rsa -P &quot;&quot; 是⽣成ssh密码的命令，-t参数表示⽣成算法，有rsa和dsa两种；-P表示使⽤的密码，这⾥使⽤&quot;&quot;空字 符串表示⽆密码。cd ~&#x2F;.ssh进⼊.sshcat id_rsa.pub &gt;&gt; authorized_keys #这个命令将id_rsa.pub的内容追加到了authorized_keys的内容后⾯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/OrnCow.png" alt="OrnCow"></p></li><li><p>复制linux122机器的认证到其他机器</p><pre class="line-numbers language-none"><code class="language-none">scp authorized_keys linux121:&#x2F;root&#x2F;.ssh&#x2F; scp authorized_keys linux123:&#x2F;root&#x2F;.ssh&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><p>密码传输过程中只使⽤⼀次，以后再使⽤linux122 ssh linux121、linux123即不在需要密码，实现免密钥登录。</p><ol start="5"><li><p>三台机器互相免密登录<br>将三台机器的公钥添加到authorized_keys中，然后复制到三台机器.ssh目录下</p></li><li><p>mac 实现免密登录虚拟机<br>将mac ~/.ssh路径下的id_rsa.pub 追加到linux121、linux122、linux121 ~/.ssh/authorized_keys文件末尾</p></li></ol><pre class="line-numbers language-none"><code class="language-none">ssh root@192.168.80.121<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac的VMwareFusion安装VMware Tools解决不能复制粘贴的问题</title>
      <link href="2021/05/31/mac-de-vmwarefusion-an-zhuang-vmware-tools-jie-jue-bu-neng-fu-zhi-nian-tie-de-wen-ti/"/>
      <url>2021/05/31/mac-de-vmwarefusion-an-zhuang-vmware-tools-jie-jue-bu-neng-fu-zhi-nian-tie-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<blockquote><p>另一种思路：mac ssh 虚拟机也可以解决复制粘贴问题</p></blockquote><span id="more"></span><ul><li>将VMTools拷贝到虚拟机中手动安装</li><li>在虚拟机中安装VMTools，缺少编译环境则安装编辑环境</li><li>在所需环境都安装完成后，执行VMTools安装</li><li>开启共享文件夹</li></ul><p>/Applications/VMware Fusion.app/Contents/Library/isoimages<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/qh9yVD.png" alt="qh9yVD"><br>点击linux.iso<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/qLgrZi.png" alt="qLgrZi"><br>将MwareTools-10.3.23-17030940.tar.gz复制到Downloads文件夹<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/CAnncG.png" alt="CAnncG"></p><p>将VMTools拷贝到虚拟机中进行安装</p><pre class="line-numbers language-none"><code class="language-none">scp ~&#x2F;Downloads&#x2F;VMwareTools-10.3.23-17030940.tar.gz root@192.168.80.121:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;VMwareTools-10.3.23-17030940.tar.gz root@192.168.80.122:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;VMwareTools-10.3.23-17030940.tar.gz root@192.168.80.123:&#x2F;opt&#x2F;lagou&#x2F;software<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>解压</p><pre class="line-numbers language-none"><code class="language-none">tar -zxvf VMwareTools-10.3.23-17030940.tar.gz ..&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="安装VMTools"><a href="#安装VMTools" class="headerlink" title="安装VMTools"></a>安装VMTools</h3><pre class="line-numbers language-none"><code class="language-none">cd vmware-tools-distrib.&#x2F;vmware-install.pl -bash: .&#x2F;vmware-install.pl: &#x2F;usr&#x2F;bin&#x2F;perl: bad interpreter: No such file or directory<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>安装perl, gcc</p><pre class="line-numbers language-none"><code class="language-none">yum -y updateyum -y install kernel-headers kernel-devel gcc perl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>重启reboot 很重要！！！</p><p>环境安装后重复上面运行vmware-install.pl即可</p><pre class="line-numbers language-none"><code class="language-none">sudo .&#x2F;vmware-install.pl open-vm-tools packages are available from the OS vendor and VMware recommends using open-vm-tools packages. See http:&#x2F;&#x2F;kb.vmware.com&#x2F;kb&#x2F;2073803 for more information.Do you still want to proceed with this installation? [no]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输入yes，然后一路回车，默认选项安装。</p><pre class="line-numbers language-none"><code class="language-none">To enable advanced X features (e.g., guest resolution fit, drag and drop, and file and text copy&#x2F;paste), you will need to do one (or more) of the following:1. Manually start &#x2F;usr&#x2F;bin&#x2F;vmware-user2. Log out and log back into your desktop session3. Restart your X session.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/WNqYPN.png" alt="WNqYPN"></p><pre class="line-numbers language-none"><code class="language-none">&#x2F;usr&#x2F;bin&#x2F;vmware-user start &#x2F;&#x2F;&#x2F;手动启动vmware-user: could not open &#x2F;proc&#x2F;fs&#x2F;vmblock&#x2F;dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>此错误未解决</p><p>可以设置共享目录</p><p>然后设置虚拟机共享目录后即可在/mnt/hgfs下看到共享目录</p><h3 id="其他解决途径"><a href="#其他解决途径" class="headerlink" title="其他解决途径"></a>其他解决途径</h3><blockquote><p>mac ssh vmware 虚拟机 解决复制粘贴问题</p></blockquote><pre class="line-numbers language-none"><code class="language-none">ssh 虚拟机用户名@虚拟机ip地址输入密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h3><h4 id="yum-y-install安装失败"><a href="#yum-y-install安装失败" class="headerlink" title="yum -y install安装失败"></a>yum -y install安装失败</h4><p>安装编译环境</p><pre class="line-numbers language-none"><code class="language-none"># yum -y install perl gcc make kernel-headers kernel-develyum -y updateyum -y install kernel-headers kernel-devel gcc perl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>出现错误</p><pre class="line-numbers language-none"><code class="language-none">...http:&#x2F;&#x2F;mirrors.163.com&#x2F;centos&#x2F;7.2.1511&#x2F;os&#x2F;x86_64&#x2F;repodata&#x2F;repomd.xml: [Errno 14] curl#6 - &quot;Could not resolve host: mirrors.163.com; Unknown error&quot;Trying other mirror....<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>一眼一看就知道是网络的问题，是不是没设置DNS，检查发现ping baidu.com不通，应该是DNS问题</p><p>修改DNS配置，将MAC的DNS地址添加进来</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33DNS1&#x3D;xxxxDNS2&#x3D;xxxx# 保存退出，重启网络服务systemctl restart network 或者 service network restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启网络后，能正常ping通baidu.com</p><p>继续执行</p><h4 id="卸载VMTools"><a href="#卸载VMTools" class="headerlink" title="卸载VMTools"></a>卸载VMTools</h4><p>三、卸载：</p><p>到刚才解压的目录/usr/local/vmware-tools-distrib/bin 目录或者 /usr/bin</p><pre class="line-numbers language-none"><code class="language-none">cd vmware-tools-distrib&#x2F;bin.&#x2F;vmware-uninstall-tools.pl    &#x2F;&#x2F;&#x2F;运行卸载程序rm -rf &#x2F;etc&#x2F;vmware-caf     &#x2F;&#x2F;&#x2F;递归强制 删除残留目录rm -rf &#x2F;etc&#x2F;vmware-tools   &#x2F;&#x2F;&#x2F;递归强制 删除残留目录rm -rvf &#x2F;usr&#x2F;lib&#x2F;vmware-tools     &#x2F;&#x2F;&#x2F;递归强制 删除残留目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.cnblogs.com/joxin/p/9700653.html">VMware安装CentOS7踩坑</a></li><li><a href="https://blog.csdn.net/yuesichiu/article/details/53351324">【CentOS7】yum安装时出现错误Errno 14 Couldn’t resolve host的解决办法</a></li><li><a href="https://blog.csdn.net/u013162548/article/details/45567681/">VMwareTools安装及出现kernel header path的解决方法</a></li><li><a href="https://blog.csdn.net/z69183787/article/details/79283313">Centos7最小化终端命令行安装VMware-tools.pl</a></li><li><a href="https://blog.csdn.net/sirchenhua/article/details/49719659">解决vmware fusion + centos 7安装vmtools时提示The path “” is not a valid path to the xxx kernel headers.</a></li><li><a href="https://finolo.gy/2020/01/Windows%E4%B8%BB%E6%9C%BA%E7%8E%AF%E5%A2%83CentOS7%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85VMware-Tools/">Windows主机环境CentOS7虚拟机安装VMware Tools</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vmware fusion </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Hadoop 完全分布式集群搭建（二）</title>
      <link href="2021/05/26/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-er/"/>
      <url>2021/05/26/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-er/</url>
      
        <content type="html"><![CDATA[<blockquote><p>第二部分:集群规划&amp;安装Hadoop</p></blockquote><span id="more"></span><h3 id="集群规划"><a href="#集群规划" class="headerlink" title="集群规划"></a>集群规划</h3><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/iIVicu.png" alt="集群规划"></p><h3 id="安装Hadoop"><a href="#安装Hadoop" class="headerlink" title="安装Hadoop"></a>安装Hadoop</h3><p>登录linux121节点；进入/opt/lagou/software,解压安装文件到/opt/lagou/servers</p><pre class="line-numbers language-none"><code class="language-none">tar -zxvf hadoop-2.9.2.tar.gz -C &#x2F;opt&#x2F;lagou&#x2F;servers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看是否解压成功</p><pre class="line-numbers language-none"><code class="language-none">ll &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>添加Hadoop到环境变量 vim /etc/profile</p><pre class="line-numbers language-none"><code class="language-none">##HADOOP_HOME export HADOOP_HOME&#x3D;&#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2 export PATH&#x3D;$PATH:$HADOOP_HOME&#x2F;bin export PATH&#x3D;$PATH:$HADOOP_HOME&#x2F;sbin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>使环境变量生效</p><pre class="line-numbers language-none"><code class="language-none">source &#x2F;etc&#x2F;profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>验证hadoop</p><pre class="line-numbers language-none"><code class="language-none">hadoop version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/ErqgrJ.png" alt="hadoop version"></p><p>hadoop目录<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/xm4o4d.png" alt="xm4o4d"></p><pre class="line-numbers language-none"><code class="language-none">1. bin目录:对Hadoop进行操作的相关命令，如hadoop,hdfs等2. etc目录：Hadoop的配置文件目录，入hdfs-site.xml,core-site.xml等3. lib目录：Hadoop本地库（解压缩的依赖）4. sbin目录：存放的是Hadoop集群启动停止相关脚本，命令5. share目录：Hadoop的一些jar,官方案例jar，文档等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h3><blockquote><p>Hadoop集群配置 = HDFS集群配置 + MapReduce集群配置 + Yarn集群配置</p></blockquote><p>HDFS集群配置</p><ol><li>将JDK路径明确配置给HDFS（修改<code>hadoop-env.sh</code>）</li><li>指定NameNode节点以及数据存储目录（修改<code>core-site.xml</code>）</li><li>指定SecondaryNameNode节点（修改hdfs-site.xml）</li><li>指定DataNode从节点（修改etc/hadoop/slaves文件，每个节点配置信息占一行） </li></ol><p>MapReduce集群配置</p><ol><li>将JDK路径明确配置给MapReduce（修改<code>mapred-env.sh</code>）</li><li>指定MapReduce计算框架运行Yarn资源调度框架（修改<code>mapred-site.xml</code>） </li></ol><p>Yarn集群配置</p><ol><li>将JDK路径明确配置给Yarn（修改<code>yarn-env.sh</code>）</li><li>指定ResourceManager老大节点所在计算机节点（修改<code>yarn-site.xml</code>）</li><li>指定NodeManager节点（会通过slaves文件内容确定）</li></ol><h4 id="HDFS集群配置"><a href="#HDFS集群配置" class="headerlink" title="HDFS集群配置"></a>HDFS集群配置</h4><pre class="line-numbers language-none"><code class="language-none">cd &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2&#x2F;etc&#x2F;hadoop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li>配置：hadoop-env.sh,将JDK路径明确配置给HDFS</li></ol><pre class="line-numbers language-none"><code class="language-none">vim hadoop-env.shexport JAVA_HOME&#x3D;&#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;jdk1.8.0_231<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="2"><li>指定NameNode节点以及数据存储目录（修改core-site.xml）</li></ol><p>覆盖原文件信息</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">vim core-site.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 指定HDFS中NameNode的地址 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>hdfs://linux121:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>/opt/lagou/servers/hadoop-2.9.2/data/tmp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/LRVmOT.png" alt="LRVmOT"></p><ol start="3"><li><p>指定secondarynamenode节点(修改hdfs-site.xml)</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">vim hdfs-site.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 指定Hadoop辅助名称节点主机配置 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>linux123:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--副本数量 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>指定datanode从节点(修改slaves文件，每个节点配置信息占一行)</p><pre class="line-numbers language-none"><code class="language-none">vim slaveslinux121 linux122 linux123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p><strong>注意：该文件中添加的内容结尾不允许有空格，文件中不允许有空行。</strong></p><h4 id="MapReduce集群配置"><a href="#MapReduce集群配置" class="headerlink" title="MapReduce集群配置"></a>MapReduce集群配置</h4><ol><li>指定MapReduce使用的jdk路径（修改mapred-env.sh）</li></ol><pre class="line-numbers language-none"><code class="language-none">vim mapred-env.shexport JAVA_HOME&#x3D;&#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;jdk1.8.0_231<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="2"><li>指定MapReduce计算框架运行Yarn资源调度框架(修改mapred-site.xml)</li></ol><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">mv mapred-site.xml.template mapred-site.xml vim mapred-site.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 指定MR运行在Yarn上 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Yarn集群配置"><a href="#Yarn集群配置" class="headerlink" title="Yarn集群配置"></a>Yarn集群配置</h4><ol><li>指定JDK路径</li></ol><pre class="line-numbers language-none"><code class="language-none">vim yarn-env.sh export JAVA_HOME&#x3D;&#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;jdk1.8.0_231<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="2"><li>指定ResourceMnager的master节点信息(修改yarn-site.xml)</li></ol><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">vim yarn-site.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- 指定YARN的ResourceManager的地址 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>linux123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- Reducer获取数据的方式 --></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>指定NodeManager节点（slaves文件已修改）</li></ol><p>注意： Hadoop安装目录所属用户和所属用户组信息，默认是501 dialout，而我们操作Hadoop集群的用户使 用的是虚拟机的root用户， 所以为了避免出现信息混乱，修改Hadoop安装目录所属用户和用户组！！</p><pre class="line-numbers language-none"><code class="language-none">chown -R root:root &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="分发配置"><a href="#分发配置" class="headerlink" title="分发配置"></a>分发配置</h3><blockquote><p>编写集群分发脚本rsync-script,用于同步linux121的配置信息到linux122、linux123中</p></blockquote><p>rsync主要用于备份和镜像。具有速度快、避免复制相同内容和支持符号链接的优点。 </p><p>rsync和scp区别：用rsync做文件的复制要比scp的速度快，rsync只对差异文件做更新。scp是把所有文 件都复制过去。</p><ol><li>基本语法</li></ol><pre class="line-numbers language-none"><code class="language-none">rsync -rvl $pdir&#x2F;$fname $user@$host:$pdir&#x2F;$fname命令 选项参数 要拷贝的文件路径&#x2F;名称 目的用户@主机:目的路径&#x2F;名称<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><table><thead><tr><th>选项</th><th>功能</th></tr></thead><tbody><tr><td>-r</td><td>递归</td></tr><tr><td>-v</td><td>显示复制过程</td></tr><tr><td>-l</td><td>拷贝符号连接</td></tr></tbody></table><h4 id="rsync案例"><a href="#rsync案例" class="headerlink" title="rsync案例"></a>rsync案例</h4><ol><li>三台虚拟机安装rsync (执行安装需要保证机器联网)</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 ~]# yum install -y rsync<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>把linux121机器上的/opt/lagou/software目录同步到linux122服务器的root用户下的/opt/目录</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 opt]$ rsync -rvl &#x2F;opt&#x2F;lagou&#x2F;software&#x2F; root@linux122:&#x2F;opt&#x2F;lagou&#x2F;software<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="集群分发脚本编写"><a href="#集群分发脚本编写" class="headerlink" title="集群分发脚本编写"></a>集群分发脚本编写</h4><blockquote><p>需求：循环复制文件到集群所有节点的相同目录下</p></blockquote><p>rsync命令原始拷贝：</p><pre class="line-numbers language-none"><code class="language-none">rsync -rvl &#x2F;opt&#x2F;module root@linux123:&#x2F;opt&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>期望脚本</p><p>脚本+要同步的文件名称</p><p>说明：在/usr/local/bin这个目录下存放的脚本，root用户可以在系统任何地方直接执行。</p><p>脚本实现</p><ol><li><p>在/usr/local/bin目录下创建文件rsync-script，文件内容如下：</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 bin]$ touch rsync-script[root@linux121 bin]$ vim rsync-script<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>在文件中编写shell代码</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment">#1 获取命令输入参数的个数，如果个数为0，直接退出命令 </span><span class="token assign-left variable">paramnum</span><span class="token operator">=</span><span class="token variable">$#</span><span class="token keyword">if</span><span class="token variable"><span class="token punctuation">((</span>paramnum<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">then</span>     <span class="token builtin class-name">echo</span> no params<span class="token punctuation">;</span> <span class="token builtin class-name">exit</span><span class="token punctuation">;</span> <span class="token keyword">fi</span><span class="token comment">#2 根据传入参数获取文件名称 </span><span class="token assign-left variable">p1</span><span class="token operator">=</span><span class="token variable">$1</span> <span class="token assign-left variable">file_name</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">basename</span> $p1<span class="token variable">`</span></span> <span class="token builtin class-name">echo</span> <span class="token assign-left variable">fname</span><span class="token operator">=</span><span class="token variable">$file_name</span><span class="token comment">#3 获取输入参数的绝对路径</span><span class="token assign-left variable">pdir</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">cd</span> -P <span class="token punctuation">$(</span>dirname $p1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token builtin class-name">pwd</span><span class="token variable">`</span></span> <span class="token builtin class-name">echo</span> <span class="token assign-left variable">pdir</span><span class="token operator">=</span><span class="token variable">$pdir</span><span class="token comment">#4 获取用户名称 </span><span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span><span class="token comment">#5 循环执行rsync</span><span class="token keyword">for</span><span class="token variable"><span class="token punctuation">((</span>host<span class="token operator">=</span><span class="token number">121</span><span class="token punctuation">;</span> host<span class="token operator">&lt;</span><span class="token number">124</span><span class="token punctuation">;</span> host<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span><span class="token builtin class-name">echo</span> -------------linux<span class="token variable">$host</span> -------------<span class="token function">rsync</span> -rvl <span class="token variable">$pdir</span>/<span class="token variable">$file_name</span> <span class="token variable">$user</span>@linux<span class="token variable">$host</span><span class="token builtin class-name">:</span><span class="token variable">$pdir</span><span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>修改脚本 rsync-script 具有执行权限</p></li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 bin]$ chmod 777 rsync-script<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>调用脚本形式：rsync-script 文件名称</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 bin]$ rsync-script &#x2F;home&#x2F;root&#x2F;bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行该路径会报错，先不理会</p><ol start="4"><li>调用脚本分发Hadoop安装目录到其它节点</li></ol><pre class="line-numbers language-none"><code class="language-none">[root@linux121 bin]$ rsync-script &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/JBuGvl.png" alt="JBuGvl"></p><h3 id="启动集群"><a href="#启动集群" class="headerlink" title="启动集群"></a>启动集群</h3><blockquote><p>注意：如果集群是第一次启动，需要在Namenode所在节点格式化NameNode，非第一次不用执行格 式化Namenode操作！！</p></blockquote><h4 id="单节点启动"><a href="#单节点启动" class="headerlink" title="单节点启动"></a>单节点启动</h4><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop namenode -format<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>格式化命令执行效果：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/d2gPoU.png" alt="formatted"><br>格式化后创建的文件：/opt/lagou/servers/hadoop-2.9.2/data/tmp/dfs/name/current<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/lXfYXL.png" alt="fsimage"></p><ol><li><p>在linux121上启动NameNode</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ hadoop-daemon.sh start namenode [root@linux121 hadoop-2.9.2]$ jps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>jps是jdk提供的一个查看当前java进程的小工具,JavaVirtual Machine Process Status Tool的缩写</p></blockquote></li><li><p>在linux121、linux122以及linux123上分别启动DataNode</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]# hadoop-daemon.sh start namenodestarting namenode, logging to &#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;hadoop-2.9.2&#x2F;logs&#x2F;hadoop-root-namenode-linux121.out[root@linux121 hadoop-2.9.2]# jps75537 Jps75452 NameNode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>web端查看Hdfs界面</p></li></ol><ul><li><a href="http://linux121:50070/dfshealth.html#tab-overview">http://linux121:50070/dfshealth.html#tab-overview</a>【主机已配置域名映射点击这个链接】</li><li><a href="http://192.168.80.121:50070/dfshealth.html#tab-overview">http://192.168.80.121:50070/dfshealth.html#tab-overview</a>【主机未配置域名映射点击这个链接】</li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/bbYvlR.png" alt="bbYvlR"></p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/4geSBI.png" alt="4geSBI"><br>点击Live Nodes查看详情<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/vym73F.png" alt="vym73F"></p><p>若配置后，没有按照预期的显示</p><p>关闭集群，把三台机子上的Hadoop安装目录下的data、logs文件夹均删除，然后格式化namenode，最后重启集群</p><h4 id="集群群起"><a href="#集群群起" class="headerlink" title="集群群起"></a>集群群起</h4><p>如果已经单节点方式启动了Hadoop,可以先停止之前的启动的Namenode与Datanode进程,如果之前Namenode没有执行格式化，这里需要执行格式化!!!!</p><pre class="line-numbers language-none"><code class="language-none">hadoop namenode -format<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li><p>启动HDFS</p><pre class="line-numbers language-none"><code class="language-none">[root@linux121 hadoop-2.9.2]$ sbin&#x2F;start-dfs.sh [root@linux121 hadoop-2.9.2]$ jps 4166 NameNode 4482 Jps 4263 DataNode[root@linux122 hadoop-2.9.2]$ jps 3218 DataNode 3288 Jps[root@linux123 hadoop-2.9.2]$ jps 3221 DataNode 3283 SecondaryNameNode 3364 Jps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>启动YARN</p><blockquote><p>NameNode和ResourceManger不是在同一台机器，不能在NameNode上启动 YARN，应该 在ResouceManager所在的机器上启动YARN。</p></blockquote></li></ol><p>在linux123上启动yarn</p><pre class="line-numbers language-none"><code class="language-none">[root@linux123 hadoop-2.9.2]$ sbin&#x2F;start-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Hadoop集群启动停止命令汇总"><a href="#Hadoop集群启动停止命令汇总" class="headerlink" title="Hadoop集群启动停止命令汇总"></a>Hadoop集群启动停止命令汇总</h4><p>各个服务组件逐一启动/停止</p><pre class="line-numbers language-none"><code class="language-none"># 分别启动&#x2F;停止HDFS组件hadoop-daemon.sh start|stop namenode|datanode|secondarynamenode# 启动&#x2F;停止YARNyarn-daemon.sh start|stop resourcemanager|nodemanager<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>各个模块分开启动/停止（配置ssh是前提）常用</p><pre class="line-numbers language-none"><code class="language-none"># 整体启动&#x2F;停止HDFSstart-dfs.shstop-dfs.sh# 整体启动&#x2F;停止YARNstart-yarn.shstop-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Hadoop 完全分布式集群搭建（一）</title>
      <link href="2021/05/20/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-yi/"/>
      <url>2021/05/20/apache-hadoop-wan-quan-fen-bu-shi-ji-qun-da-jian-yi/</url>
      
        <content type="html"><![CDATA[<blockquote><p>第一部分:虚拟机环境准备</p></blockquote><span id="more"></span><p>目标：</p><ul><li>三台虚拟机（静态IP，关闭防火墙，修改主机名，配置免密登录，集群时间同步）(admin:hadoop)</li><li>在/opt目录下创建文件夹  <pre class="line-numbers language-none"><code class="language-none">mkdir -p &#x2F;opt&#x2F;lagou&#x2F;software  # 软件安装包存放目录mkdir -p &#x2F;opt&#x2F;lagou&#x2F;servers   # 软件安装目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.9.2/">Hadoop-2.9.2下载地址</a></li><li><a href="https://hadoop.apache.org/releases.html">Hadoop最新下载地址</a></li><li><a href="http://hadoop.apache.org/">Hadoop官网地址</a></li><li>上传hadoop安装文件到/opt/lagou/software  <pre class="line-numbers language-none"><code class="language-none">scp ~&#x2F;Downloads&#x2F;hadoop-2.9.2.tar.gz root@192.168.80.121:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;hadoop-2.9.2.tar.gz root@192.168.80.122:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;hadoop-2.9.2.tar.gz root@192.168.80.123:&#x2F;opt&#x2F;lagou&#x2F;software<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ul><!--more--><h3 id="Hadoop搭建方式"><a href="#Hadoop搭建方式" class="headerlink" title="Hadoop搭建方式"></a>Hadoop搭建方式</h3><ul><li>单机模式：单节点模式，非集群，生产不会使用这种方式</li><li>单机伪分布式模式：单节点，多线程模拟集群的效果，生产不会使用这种方式</li><li>完全分布式模式：多台节点，真正的分布式Hadoop集群的搭建（生产环境建议使用这种方式）</li></ul><h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><blockquote><p>目标：使用vmware虚拟机虚拟三台linux节点，linux操作系统：Centos7</p></blockquote><ul><li><a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">JDK8版本下载</a>（Hadoop框架是采用Java语言编写，需要java环境（jvm））</li><li><a href="https://my.vmware.com/web/vmware/downloads/info/slug/desktop_end_user_computing/vmware_fusion/12_0?wd=&eqid=935f58bd0000e0bb0000000660a60ca6">VMware Fusion 12  pro 下载地址</a></li><li><a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.9.2/">Hadoop-2.9.2下载地址</a></li></ul><blockquote><p>虚拟机软件使用 VMware Fusion 12</p></blockquote><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>第一部分</p><ol><li>安装软件VMware Fusion 12 </li><li>在虚拟机上安装CentOS7</li><li>准备三台虚拟机（静态IP，关闭防火墙，修改主机名，配置免密登录，集群时间同步）</li></ol><p>第二部分</p><ol><li>集群规划</li><li>安装Hadoop</li><li>启动集群</li></ol><p>第三部分</p><ol><li>集群测试</li><li>配置日志历史服务器</li></ol><h3 id="VMware-Fusion-12-1-2-激活码"><a href="#VMware-Fusion-12-1-2-激活码" class="headerlink" title="VMware Fusion 12.1.2 激活码"></a>VMware Fusion 12.1.2 激活码</h3><pre class="line-numbers language-none"><code class="language-none">ZF3R0-FHED2-M80TY-8QYGC-NPKYFYF390-0HF8P-M81RQ-2DXQE-M2UT6ZF71R-DMX85-08DQY-8YMNC-PPHV8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="安装VMware-Fusion-12和CentOS7"><a href="#安装VMware-Fusion-12和CentOS7" class="headerlink" title="安装VMware Fusion 12和CentOS7"></a>安装VMware Fusion 12和CentOS7</h3><blockquote><p>本示例VMware Fusion使用版本12.1.2，目前生产环境大多数用CentOS7</p></blockquote><ul><li><a href="https://my.vmware.com/web/vmware/downloads/info/slug/desktop_end_user_computing/vmware_fusion/12_0?wd=&eqid=935f58bd0000e0bb0000000660a60ca6">VMware Fusion 12.1.2 下载地址</a></li><li><a href="https://www.centos.org/centos-linux/">CentOS7 下载地址</a>(选择7(2009)-&gt;x86_64-&gt;选择一个镜像站点-&gt;选择<code>CentOS-7-x86_64-DVD-2009.iso</code>下载即可)</li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/azhlDs.png" alt="azhlDs"></p><p>默认容量20GB，默认内存1GB<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/hGVLLt.png" alt="hGVLLt"></p><p>自定义参数</p><ul><li>修改内存为2048MB</li><li>处理器数量1<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/jREAbM.png" alt="内存设置"></li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/uES73T.png" alt="选择网络类型"></p><p>磁盘大小一般建议20G，将虚拟磁盘拆分为多个文件<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/OXN98Y.png" alt="磁盘类型"><br>启动磁盘，安装CentOS7<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/p4qjjw.png" alt="p4qjjw"></p><p>配置语言环境，选择English，继续<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/QD3x8A.png" alt="设置语言"></p><p>配置时区，点击DATE&amp;TIME，地图选择中国，时区填上海，点击左上角Done完成配置<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/tGcbHs.png" alt="设置时区"></p><p>选择INSTALLATION DESTINATION，选择<code>I will configure partitioning</code>自定义分区,左上角Done<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/dGp3Qg.png" alt="dGp3Qg"><br>点击+号<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/IDzSv7.png" alt="IDzSv7"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/V0DiUY.png" alt="V0DiUY"><br>点击+ 添加swap分区<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/wAUkjH.png" alt="wAUkjH"><br>点击+，添加根分区，不设置分区大小，把剩余空间都给根分区<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/OGxEVZ.png" alt="OGxEVZ"><br>点击Done完成分区设置，点击Accept Changes 完成设置<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/QKUuxA.png" alt="QKUuxA"></p><p>此时返回上一页，点击Begin Installation开始安装<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/eXml8J.png" alt="eXml8J"></p><p>创建密码，密码为hadoop，不创建用户，默认用户root<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/RMPTvL.png" alt="RMPTvL"></p><p>设置完密码会显示Performing post-installation setup tasks<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/2RUabL.png" alt="2RUabL"></p><p>重启<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/E7tlaP.png" alt="重启"></p><h3 id="给虚拟机配置静态ip地址"><a href="#给虚拟机配置静态ip地址" class="headerlink" title="给虚拟机配置静态ip地址"></a>给虚拟机配置静态ip地址</h3><ol><li>在VMware Fusion的网络配置中新增网络连接，允许使用NAT，并配置自定义网段</li><li>在本机终端中，查看配置好的NAT网段的网关ip</li><li>给虚拟机配置静态ip地址和NAT网关地址，配置主机的DNS解析地址(mac-网络-高级-DNS查看ip)</li><li>验证网络是否通畅(ping 网关ip，ping dns ip，ping baidu.com) </li></ol><h4 id="1-新建NAT网络"><a href="#1-新建NAT网络" class="headerlink" title="1.新建NAT网络"></a>1.新建NAT网络</h4><p>VMware Fusion&gt;偏好设置&gt;网络&gt; 点击+ 新增网络连接</p><ul><li>允许使用NAT</li><li>配置IP网段</li></ul><p>这里主要需要手动配置子网ip，我将它自定义为了：192.168.100.0<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/pKpmgD.png" alt="新建NAT网络"></p><h4 id="2-查看vnet配置"><a href="#2-查看vnet配置" class="headerlink" title="2.查看vnet配置"></a>2.查看vnet配置</h4><pre class="line-numbers language-none"><code class="language-none">cat &#x2F;Library&#x2F;Preferences&#x2F;VMware\ Fusion&#x2F;networking...answer VNET_4_DHCP yesanswer VNET_4_HOSTONLY_NETMASK 255.255.255.0  # 这个是子网掩码answer VNET_4_HOSTONLY_SUBNET 192.168.100.0 # 这个是子网地址answer VNET_4_NAT yesanswer VNET_4_NAT_PARAM_UDP_TIMEOUT 30answer VNET_4_VIRTUAL_ADAPTER yes...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-查看vnet4的nat配置"><a href="#3-查看vnet4的nat配置" class="headerlink" title="3.查看vnet4的nat配置"></a>3.查看vnet4的nat配置</h4><blockquote><p>VMware Fusion 文件夹有空格,vmnet可以替换成其他网络连接名称</p></blockquote><p>主要是查看NAT网段的网关ip</p><pre class="line-numbers language-none"><code class="language-none">cat &#x2F;Library&#x2F;Preferences&#x2F;VMware\ Fusion&#x2F;vmnet4&#x2F;nat.conf...# NAT gateway addressip &#x3D; 192.168.100.1netmask &#x3D; 255.255.255.0# Last DHCP addresslastDhcpAddress &#x3D; 192.168.100.127...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-修改虚拟机网络连接"><a href="#4-修改虚拟机网络连接" class="headerlink" title="4.修改虚拟机网络连接"></a>4.修改虚拟机网络连接</h4><blockquote><p>虚拟机&gt;网络适配器&gt;网络适配器 设置…<br>这里我们选择新增的选择vmnet4<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/HaOZPU.png" alt="HaOZPU"></p></blockquote><h4 id="5-修改虚拟机配置文件"><a href="#5-修改虚拟机配置文件" class="headerlink" title="5.修改虚拟机配置文件"></a>5.修改虚拟机配置文件</h4><blockquote><p>虚拟机中的配置</p></blockquote><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>原始配置</p><pre class="line-numbers language-none"><code class="language-none">TYPE&#x3D;EthernetBOOTPROTO&#x3D;dhcp  # 需要修改为 staticDEFROUTE&#x3D;yesPEERDNS&#x3D;yesPEERROUTES&#x3D;yesIPV4_FAILURE_FATAL&#x3D;noNAME&#x3D;ens33DEVICE&#x3D;ens33ONBOOT&#x3D;no  # 需要修改为 yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置静态ip地址</p><pre class="line-numbers language-none"><code class="language-none">TYPE&#x3D;EthernetBOOTPROTO&#x3D;staticDEFROUTE&#x3D;yesPEERDNS&#x3D;yesPEERROUTES&#x3D;yesIPV4_FAILURE_FATAL&#x3D;noNAME&#x3D;ens33DEVICE&#x3D;ens33ONBOOT&#x3D;yesIPADDR&#x3D;192.168.100.2      &#x2F;&#x2F; 自定义的虚拟机IP， ip属于vmnet4网段GATEWAY&#x3D;192.168.100.1      &#x2F;&#x2F; 配置的vmnet4网关地址NETMASK&#x3D;255.255.255.0       &#x2F;&#x2F; 配置的掩码DNS&#x3D;192.168.8.1        &#x2F;&#x2F; macOS本机的DNS地址。 系统偏好设置-&gt; 网络 -&gt; 在左侧选择当前使用的网络，点击右下角的“高级”按钮 -&gt; 切换Tab页，可找到DNS地址。若有多个DNS地址，则用DNS1，DNS2 区分# 保存退出，重启网络服务systemctl restart network 或者 service network restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-查看IP是否配置成功"><a href="#7-查看IP是否配置成功" class="headerlink" title="7.查看IP是否配置成功"></a>7.查看IP是否配置成功</h4><pre class="line-numbers language-none"><code class="language-none">ip addr # 查看DNS配置 修改后立即生效，不需要重启服务&#x2F;etc&#x2F;resolv.conf  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/19LS8C.png" alt="查看IP是否配置成功"></p><h4 id="8-验证网络"><a href="#8-验证网络" class="headerlink" title="8.验证网络"></a>8.验证网络</h4><ul><li>虚拟机 ping vmnet4 网关</li><li>主机 ping 虚拟机</li><li>虚拟机 ping dns ip</li><li>虚拟机 ping baidu.com</li></ul><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Dthyn9.png" alt="Dthyn9"><br>重启VMware 网络</p><pre class="line-numbers language-none"><code class="language-none">sudo &#x2F;Applications&#x2F;VMware\ Fusion.app&#x2F;Contents&#x2F;Library&#x2F;vmnet-cli --stopsudo &#x2F;Applications&#x2F;VMware\ Fusion.app&#x2F;Contents&#x2F;Library&#x2F;vmnet-cli --start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="关闭CentOS7防⽕墙"><a href="#关闭CentOS7防⽕墙" class="headerlink" title="关闭CentOS7防⽕墙"></a>关闭CentOS7防⽕墙</h4><p>防⽕墙相关的命令：</p><pre class="line-numbers language-none"><code class="language-none">systemctl status ﬁrewalld.service # 查看ﬁrewall状态 systemctl stop ﬁrewalld.service # 停⽌ﬁrewall systemctl disable ﬁrewalld.service # 禁⽌ﬁrewall开机启动<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="修改虚拟机名称和hostname"><a href="#修改虚拟机名称和hostname" class="headerlink" title="修改虚拟机名称和hostname"></a>修改虚拟机名称和hostname</h3><p>修改虚拟机名称 右键重命名即可<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/54Wlxo.png" alt="修改虚拟机名称"></p><p>修改hostname</p><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;sysconﬁg&#x2F;network 打开network编辑# Create by anacondaNETWORKING&#x3D;yes  # 新增hostname&#x3D;linux121 # 新增<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>保存退出后输⼊hostname,即可显示出centos121</p><p>注意：改动配置⽂件后要进⾏⽹络重启  或重启init 6 从⽽使配置⽂件⽣效</p><pre class="line-numbers language-none"><code class="language-none">service network restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="配置hostname与IP映射"><a href="#配置hostname与IP映射" class="headerlink" title="配置hostname与IP映射"></a>配置hostname与IP映射</h3><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;hosts# 新增192.168.80.121 linux121192.168.80.122 linux122192.168.80.123 linux123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我此时已经配置了三台机器的IP与hostname映射，从⽽可以达到，在本机ping hostname可通，如果 没有配此映射，需⽤ping IP地址可通。如果是三台机器互相⽤hostname来ping，那么三台机器必须同 时配好三个IP和hostname的映射。</p><p>⾄此，⽹络配置完成。</p><h3 id="克隆并配置⽹络"><a href="#克隆并配置⽹络" class="headerlink" title="克隆并配置⽹络"></a>克隆并配置⽹络</h3><p>三台机器规划<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/6ZP9e2.png" alt="6ZP9e2"></p><p>在linux122 上ping linux121 成功</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/DLXVfk.png" alt="DLXVfk"></p><h3 id="⼤数据集群环境准备"><a href="#⼤数据集群环境准备" class="headerlink" title="⼤数据集群环境准备"></a>⼤数据集群环境准备</h3><h4 id="三台虚拟机关闭防⽕墙"><a href="#三台虚拟机关闭防⽕墙" class="headerlink" title="三台虚拟机关闭防⽕墙"></a>三台虚拟机关闭防⽕墙</h4><pre class="line-numbers language-none"><code class="language-none">查看防⽕墙状态 systemctl status ﬁrewalld停用防火墙systemctl stop firewalld开机自动关闭防火墙systemctl disable firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="三台机器关闭selinux"><a href="#三台机器关闭selinux" class="headerlink" title="三台机器关闭selinux"></a>三台机器关闭selinux</h4><pre class="line-numbers language-none"><code class="language-none">vi &#x2F;etc&#x2F;selinux&#x2F;config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/iMh0B3.png" alt="iMh0B3"></p><h4 id="三台机器机器免密码登录"><a href="#三台机器机器免密码登录" class="headerlink" title="三台机器机器免密码登录"></a>三台机器机器免密码登录</h4><ol><li><p>配置hostname与IP映射<br>pass</p></li><li><p>在所有主机上创建⽬录并赋予权限</p><pre class="line-numbers language-none"><code class="language-none">mkdir &#x2F;root&#x2F;.ssh chmod 700 &#x2F;root&#x2F;.ssh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>在三台机器执⾏以下命令，⽣成公钥与私钥</p><pre class="line-numbers language-none"><code class="language-none">cd ~ #进⼊⽤户⽬录 ssh-keygen -t rsa -P &quot;&quot; 是⽣成ssh密码的命令，-t参数表示⽣成算法，有rsa和dsa两种；-P表示使⽤的密码，这⾥使⽤&quot;&quot;空字 符串表示⽆密码。cd ~&#x2F;.ssh进⼊.sshcat id_rsa.pub &gt;&gt; authorized_keys #这个命令将id_rsa.pub的内容追加到了authorized_keys的内容后⾯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/uNJHSM.png" alt="uNJHSM"></p></li><li><p>复制第⼀台机器的认证到其他机器</p><pre class="line-numbers language-none"><code class="language-none">scp authorized_keys linux121:&#x2F;root&#x2F;.ssh&#x2F; scp authorized_keys linux123:&#x2F;root&#x2F;.ssh&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><p>密码传输过程中只使⽤⼀次，以后再使⽤ssh linux121或ssh linux123即不在需要密码，实现免密钥登录。</p><h4 id="三台机器时钟同步"><a href="#三台机器时钟同步" class="headerlink" title="三台机器时钟同步"></a>三台机器时钟同步</h4><p>时间同步的⽅式：在集群中找⼀台机器，作为时间服务器。</p><pre class="line-numbers language-none"><code class="language-none">通过⽹络连接外⽹进⾏时钟同步,必须保证虚拟机连上外⽹ntpdate us.pool.ntp.org; 阿⾥云时钟同步服务器 ntpdate ntp4.aliyun.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>集群中其他机器与这台机器定时的同步时间，⽐如，每 隔⼗分钟，同步⼀次时间。</p><ol><li>时间服务器配置（必须root⽤户）</li></ol><p>第⼀步:确定是否安装了ntpd的服务</p><blockquote><p>NTP 是网络时间协议(Network Time Protocol)，它是用来同步网络中各个计算机的时间的协议。<br>ntpd 是网络时间协议 (NTP) 的守护进程</p></blockquote><pre class="line-numbers language-none"><code class="language-none">如果没有安装,可以进行在线安装yum -y install ntp 启动ntpd的服务 service ntpd start 设置ntpd的服务开机启动 chkconfig ntpd on第⼀步:确定是否安装了ntpd的服务 rpm -qa | grep ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第⼆步:编辑/etc/ntp.conf</p><pre class="line-numbers language-none"><code class="language-none">编辑第⼀台机器的&#x2F;etc&#x2F;ntp.confvim &#x2F;etc&#x2F;ntp.conf 在⽂件中添加如下内容restrict 192.168.80.0 注释⼀下四⾏内容 #server 0.centos.pool.ntp.org #server 1.centos.pool.ntp.org #server 2.centos.pool.ntp.org #server 3.centos.pool.ntp.org 去掉以下内容的注释，如果没有这两⾏注释，那就⾃⼰添加上 server 127.127.1.0 # local clock fudge 127.127.1.0 stratum 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/frJchA.png" alt="frJchA"><br>配置以下内容，保证BIOS与系统时间同步 vim /etc/sysconﬁg/ntpd 添加⼀⾏内容</p><pre class="line-numbers language-none"><code class="language-none">SYNC_HWLOCK&#x3D;yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第三步：重新启动ntpd</p><pre class="line-numbers language-none"><code class="language-none">service ntpd status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>若ntpd 已停</p><pre class="line-numbers language-none"><code class="language-none">service ntpd start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>使NTP服务可以在系统引导的时候⾃动启动 ：</p><pre class="line-numbers language-none"><code class="language-none">chkconfig ntpd on<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>其他机器配置（必须root⽤户）</li></ol><p>第⼀步：在其他机器配置10分钟与时间服务器同步⼀次</p><pre class="line-numbers language-none"><code class="language-none">crontab -e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编写脚本 使另外两台机器与192.168.80.121进⾏时钟同步</p><pre class="line-numbers language-none"><code class="language-none">*&#x2F;10 * * * * &#x2F;usr&#x2F;sbin&#x2F;ntpdate 192.168.80.121<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第⼆步：修改任意机器时间</p><pre class="line-numbers language-none"><code class="language-none">date -s &quot;2020-06-20 11:11:11&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>第三步：⼗分钟后查看机器是否与时间服务器同步</p><pre class="line-numbers language-none"><code class="language-none">date<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="三台机器安装jdk"><a href="#三台机器安装jdk" class="headerlink" title="三台机器安装jdk"></a>三台机器安装jdk</h4><p>查看⾃带的openjdk</p><pre class="line-numbers language-none"><code class="language-none">rpm -qa | grep java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果有⾃带的，卸载系统⾃带的openjdk</p><pre class="line-numbers language-none"><code class="language-none">rpm -e java-1.6.0-openjdk-1.6.0.41-1.13.13.1.el6_8.x86_64 tzdata-java-2016j1.el6.noarch java-1.7.0-openjdk-1.7.0.131-2.6.9.0.el6_8.x86_64 --nodeps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上传jdk并解压然后配置环境变量</p><pre class="line-numbers language-none"><code class="language-none">所有软件的安装路径 mkdir -p &#x2F;opt&#x2F;lagou&#x2F;servers所有软件压缩包的存放路径 mkdir -p &#x2F;opt&#x2F;lagou&#x2F;software<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">scp ~&#x2F;Downloads&#x2F;jdk-8u231-linux-x64.tar.gz root@192.168.80.121:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;jdk-8u231-linux-x64.tar.gz root@192.168.80.122:&#x2F;opt&#x2F;lagou&#x2F;softwarescp ~&#x2F;Downloads&#x2F;jdk-8u231-linux-x64.tar.gz root@192.168.80.123:&#x2F;opt&#x2F;lagou&#x2F;software<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>解压</p><pre class="line-numbers language-none"><code class="language-none">tar -zxvf &#x2F;opt&#x2F;lagou&#x2F;software&#x2F;jdk-8u231-linux-x64.tar.gz -C ..&#x2F;servers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>配置环境变量 vi /etc/proﬁle</p><pre class="line-numbers language-none"><code class="language-none">export JAVA_HOME&#x3D;&#x2F;opt&#x2F;lagou&#x2F;servers&#x2F;jdk1.8.0_231export PATH&#x3D;:$JAVA_HOME&#x2F;bin:$PATH# 修改完成后 source &#x2F;etc&#x2F;proﬁle 使配置⽣效<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="安装rz上传⼯具"><a href="#安装rz上传⼯具" class="headerlink" title="安装rz上传⼯具"></a>安装rz上传⼯具</h4><pre class="line-numbers language-none"><code class="language-none">yum -y install lrzsz rz 命令上传<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/352193144">VMWare Fusion12下设置虚拟机的固定IP</a></li><li><a href="https://wsgzao.github.io/post/vmware-fusion/">VMware Fusion NAT 无法连网解决方案</a></li><li><a href="https://www.cnblogs.com/ryxiong-blog/p/14543598.html">mac os下 vmware Fusion Linux虚拟机配置静态ip无法上网问题</a></li><li><a href="https://sysin.org/article/change-vmware-fusion-networking/">如何修改 VMware Fusion 中的虚机网络 IP 地址段</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 博客提交百度、必应、谷歌搜索引擎收录</title>
      <link href="2021/05/19/hexo-bo-ke-ti-jiao-bai-du-bi-ying-gu-ge-sou-suo-yin-qing-shou-lu/"/>
      <url>2021/05/19/hexo-bo-ke-ti-jiao-bai-du-bi-ying-gu-ge-sou-suo-yin-qing-shou-lu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>让搜索引擎收录你的博客</p></blockquote><span id="more"></span><p>SEO优化</p><blockquote><p>SEO（Search Engine Optimization）：汉译为搜索引擎优化。是一种方式：利用搜索引擎的规则提高网站在有关搜索引擎内的自然排名。 ——百度百科</p></blockquote><h3 id="百度收录站点"><a href="#百度收录站点" class="headerlink" title="百度收录站点"></a>百度收录站点</h3><blockquote><p>GitHub是不允许百度的Spider（蜘蛛）爬取GitHub上的内容的，所以任何部署在GitHub上的静态博客都是不能百度爬取到的！</p></blockquote><p>首先来搞百度的，刚建完站在百度上是不可能搜索到我们的网站的，可以先在百度上搜索site:&lt;你的域名&gt;，一般是搜不到的<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/fKHiND.png" alt="搜索站点"></p><ol><li>注册、登陆百度搜索资源平台（ <a href="https://ziyuan.baidu.com/">https://ziyuan.baidu.com/</a> ）</li><li>用户中心，站点管理，添加网站</li><li>输入网站-&gt;站点属性-&gt;验证网站，选择HTML标签验证，复制HTML标签，在主题目录下<code>hexo-theme-matery/layout/_partial/head.ejs</code>中添加HTML标签(matery主题默认添加了该HTML标签)，完成验证</li><li>搜索服务-&gt;普通收录-&gt;API提交，记下下方接口调用地址的【百度站长平台中注册的域名，密匙】：<a href="http://data.zz.baidu.com/urls?site=https://amuqiao.github.io&amp;token=%E5%AF%86%E9%92%A5%EF%BC%8C%E8%BF%99%E9%87%8C%E5%8D%B3%E3%80%90https://amuqiao.github.io&amp;token=%E5%AF%86%E9%92%A5%E3%80%91">http://data.zz.baidu.com/urls?site=https://amuqiao.github.io&amp;token=密钥，这里即【https://amuqiao.github.io&amp;token=密钥】</a></li></ol><h3 id="使用插件向搜索引擎推送网站"><a href="#使用插件向搜索引擎推送网站" class="headerlink" title="使用插件向搜索引擎推送网站"></a>使用插件向搜索引擎推送网站</h3><blockquote><p>使用<a href="https://github.com/cjh0613/hexo-submit-urls-to-search-engine">hexo-submit-urls-to-search-engine</a>插件向搜索引擎推送网站【<a href="https://cjh0613.com/20200603HexoSubmitUrlsToSearchEngine.html">说明文档</a>】</p></blockquote><ol><li>获取各站长平台密钥</li><li>安装并配置hexo-submit-urls-to-search-engine插件</li><li>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d，并查询推送结果</li><li>如果推送成功，前往 <a href="https://github.com/cjh0613/hexo-submit-urls-to-search-engine">Github 地址</a>点击 Star 按钮以支持</li></ol><p>安装插件</p><p>请在 hexo 根目录运行</p><pre class="line-numbers language-none"><code class="language-none">npm install --save hexo-submit-urls-to-search-engine<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑hexo的_config.yml</p><pre class="line-numbers language-none"><code class="language-none">hexo_submit_urls_to_search_engine:  submit_condition: count #链接被提交的条件，可选值：count | period 现仅支持count  count: 10 # 提交最新的10个链接  period: 900 # 提交修改时间在 900 秒内的链接  google: 0 # 是否向Google提交，可选值：1 | 0（0：否；1：是）  bing: 1 # 是否向bing提交，可选值：1 | 0（0：否；1：是）  baidu: 1 # 是否向baidu提交，可选值：1 | 0（0：否；1：是）  txt_path: submit_urls.txt ## 文本文档名， 需要推送的链接会保存在此文本文档里  baidu_host: https:&#x2F;&#x2F;cjh0613.github.io ## 在百度站长平台中注册的域名  baidu_token: 请按照文档说明获取 ## 请注意这是您的秘钥， 所以请不要把它直接发布在公众仓库里!  bing_host: https:&#x2F;&#x2F;cjh0613.github.io ## 在bing站长平台中注册的域名  bing_token: 请按照文档说明获取 ## 请注意这是您的秘钥， 所以请不要把它直接发布在公众仓库里!  google_host: https:&#x2F;&#x2F;cjh0613.github.io ## 在google站长平台中注册的域名  google_key_file: Project.json #存放google key的json文件，放于网站根目录（与hexo _config.yml文件位置相同），请不要把json文件内容直接发布在公众仓库里!  google_proxy: http:&#x2F;&#x2F;127.0.0.1:8080 # 向谷歌提交网址所使用的系统 http 代理，填 0 不使用  replace: 0  # 是否替换链接中的部分字符串，可选值：1 | 0（0：否；1：是）  find_what: http:&#x2F;&#x2F;cjh0613.github.io&#x2F;blog  replace_with: https:&#x2F;&#x2F;cjh0613.com# deplpy 增加配置deploy:- type: git  repo:     coding: git@xxx  branch: master   #添加本插件的配置项 注意有-：- type: cjh_google_url_submitter- type: cjh_bing_url_submitter- type: cjh_baidu_url_submitter<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行<code>hexo g</code>后在根目录生成<code>public\submit_urls.txt</code>文件，需要推送的链接会保存在此文本文档里</p><p>执行<code>hexo d</code>同时向搜索引擎推送网站</p><h3 id="推送成功返回信息"><a href="#推送成功返回信息" class="headerlink" title="推送成功返回信息"></a>推送成功返回信息</h3><p>必应</p><pre class="line-numbers language-none"><code class="language-none">Bing response:  &#123; d: null &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>百度</p><pre class="line-numbers language-none"><code class="language-none">Baidu response:  &#123;&quot;remain&quot;:2999,&quot;success&quot;:1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>谷歌</p><pre class="line-numbers language-none"><code class="language-none">Google response:  &#123; urlNotificationMetadata:   &#123; url:      &#39;https:&#x2F;&#x2F;cjh0613.github.io&#39;,     latestUpdate:      &#123; url:         &#39;https:&#x2F;&#x2F;cjh0613.github.io&#39;,        type: &#39;URL_UPDATED&#39;,        notifyTime: &#39;2020-06-12T05:37:25.701779228Z&#39; &#125; &#125; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>推送成功后并没有立即收录</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://github.com/cjh0613/hexo-submit-urls-to-search-engine">hexo-submit-urls-to-search-engine 搜索引擎收录</a></li><li><a href="https://github.com/huiwang/hexo-baidu-url-submit">hexo-baidu-url-submit 百度收录</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> seo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grafana配置手册</title>
      <link href="2021/05/19/grafana-pei-zhi-shou-ce/"/>
      <url>2021/05/19/grafana-pei-zhi-shou-ce/</url>
      
        <content type="html"><![CDATA[<blockquote><p>一个开源的指标量监测和可视化工具</p></blockquote><span id="more"></span><p>Grafana是一个开源的指标量监测和可视化工具。常用于展示基础设施的时序数据和应用程序运行分析。Grafana的dashboard展示非常炫酷，绝对是运维提升逼格的一大利器。</p><p>官方在线的demo可以在这里找到: <a href="http://play.grafana.org/">http://play.grafana.org/</a><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/3uhNgK.jpg" alt="grafana示例"></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Grafana的安装非常简单，官方就有软件仓库可以直接使用，也可以通过docker镜像等方式直接本地启动。</p><p>参考官方文档的安装方法，对应找到你的操作系统的安装方法即可: <a href="http://docs.grafana.org/">http://docs.grafana.org/</a></p><blockquote><p>值得一提的是，由于官方仓库托管在S3上，国内用户直接访问苦不堪言，万幸的是清华大学tuna镜像站已经提供了grafana的镜像，只需要将官方文档中提到的仓库地址对应的换成清华大学的镜像站的地址即可: <a href="https://mirrors.tuna.tsinghua.edu.cn/grafana/">https://mirrors.tuna.tsinghua.edu.cn/grafana/</a></p></blockquote><p>安装完毕后，使用service grafana-server start就可以启动grafana，访问<a href="http://your-host:3000就可以看到登录界面了。">http://your-host:3000就可以看到登录界面了。</a></p><p>默认的用户名和密码都是admin。</p><blockquote><p>默认情况下，grafana的配置存储于sqlite3中，如果你想使用其他存储后端，如mysql，postgresql等，请参考官方文档配置: <a href="http://docs.grafana.org/installation/configuration/">http://docs.grafana.org/installation/configuration/</a></p></blockquote><p>grafana的几个基本构成和基本概念参考官方文档: <a href="http://docs.grafana.org/guides/basic_concepts/">http://docs.grafana.org/guides/basic_concepts/</a> ，后面会逐步提到这些关键词。</p><h3 id="配置数据源"><a href="#配置数据源" class="headerlink" title="配置数据源"></a>配置数据源</h3><p>先要明确一点，grafana只是一个dashboard(4版本开始将引入报警功能)，负责把数据库中的数据进行可视化展示，本身并不存储任何数据，另外某些查询和聚合使用的是数据库本身提供的功能，需要对应的数据库去支持。因此不代表你换了一个数据库后端就一定能展示相同的图形。</p><p>grafana目前支持的时序数据库有: Graphite, Prometheus, Elasticsearch, InfluxDB, OpenTSDB, AWS Cloudwatch。未来可能会有更多的数据库的支持加入，请关注更新。也可以使用第三方插件引入支持。</p><p>我们这里使用Elasticsearch作为数据库的来源。</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://elkguide.elasticsearch.cn/elasticsearch/other/grafana.html">ELKstack 中文指南Grafana【详细】</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> grafana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>django中使用celery</title>
      <link href="2021/05/18/django-zhong-shi-yong-celery/"/>
      <url>2021/05/18/django-zhong-shi-yong-celery/</url>
      
        <content type="html"><![CDATA[<blockquote><p>将celery集成到Django框架中</p></blockquote><span id="more"></span><p>celery很容易集成到Django框架中，实现定时任务需要安装django-celery-beat插件.</p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><h4 id="添加定时任务"><a href="#添加定时任务" class="headerlink" title="添加定时任务"></a>添加定时任务</h4><p>通过django-celery-beat 在后台添加定时任务</p><ul><li>安装django-celery-beat</li><li>在tasks.py中添加定任务</li><li>在setting.py中注册定时任务</li><li>启动celery beat和worker</li><li>django-celery-beat会自动发现定时任务</li><li>在CELERY_RESULT_BACKEND中查看定时任务的执行结果</li></ul><h4 id="在ORM中查看任务执行结果"><a href="#在ORM中查看任务执行结果" class="headerlink" title="在ORM中查看任务执行结果"></a>在ORM中查看任务执行结果</h4><p>通过django-celery-results 在后台查看定时任务的执行结果</p><ul><li>安装 django-celery-results</li><li>登录django admin后台，在CELERY RESULTS中查看任务执行结果</li></ul><h3 id="项目配置"><a href="#项目配置" class="headerlink" title="项目配置"></a>项目配置</h3><p>新建立django项目django_init，tasks文件，用于定义任务：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">django_init├── app01│  ├── __init__<span class="token punctuation">.</span>py│  ├── apps<span class="token punctuation">.</span>py│  ├── migrations│  │  └── __init__<span class="token punctuation">.</span>py│  ├── models<span class="token punctuation">.</span>py│  ├── tasks<span class="token punctuation">.</span>py│  └── views<span class="token punctuation">.</span>py├── manage<span class="token punctuation">.</span>py├── django_init│  ├── __init__<span class="token punctuation">.</span>py│  ├── settings<span class="token punctuation">.</span>py│  ├── urls<span class="token punctuation">.</span>py│  └── wsgi<span class="token punctuation">.</span>py└── templates<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在项目目录<code>django_init/django_init/</code>目录下新建<code>celery.py</code>:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> os<span class="token keyword">from</span> celery <span class="token keyword">import</span> Celery<span class="token comment"># 设置django环境</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation">,</span> <span class="token string">'django_init.settings'</span><span class="token punctuation">)</span>app <span class="token operator">=</span> Celery<span class="token punctuation">(</span><span class="token string">'django_init'</span><span class="token punctuation">)</span><span class="token comment"># 使用CELERY作为前缀，在settings中写配置</span>app<span class="token punctuation">.</span>config_from_object<span class="token punctuation">(</span><span class="token string">'django.conf:settings'</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'CELERY'</span><span class="token punctuation">)</span><span class="token comment"># 自动发现任务,发现任务文件每个app下的task.py</span>app<span class="token punctuation">.</span>autodiscover_tasks<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>django_init/django_init/__init__.py</code>中添加配置：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> <span class="token punctuation">.</span>celery <span class="token keyword">import</span> app <span class="token keyword">as</span> celery_app__all__ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'celery_app'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="定义定时任务"><a href="#定义定时任务" class="headerlink" title="定义定时任务"></a>定义定时任务</h3><p>任务定义在每个tasks文件中，<code>djcelery_beat_app/tasks.py</code>：</p><p>创建<code>djcelery_beat_app</code>应用</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python manage<span class="token punctuation">.</span>py startapp djcelery_beat_appcd djcelery_beat_apptouch tasks<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>在<code>djcelery_beat_app/tasks.py</code>中添加定时任务</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> time<span class="token keyword">from</span> django_init <span class="token keyword">import</span> celery_app<span class="token decorator annotation punctuation">@celery_app<span class="token punctuation">.</span>task</span><span class="token keyword">def</span> <span class="token function">print_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""定时打印时间"""</span>    timestamp <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 将时间戳转换为本地时间字符串</span>    time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"django_celery_beat 定时任务: 打印当前时间</span><span class="token interpolation"><span class="token punctuation">&#123;</span>time_str<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="注册定时任务"><a href="#注册定时任务" class="headerlink" title="注册定时任务"></a>注册定时任务</h3><p>在setting.py 中添加</p><pre class="line-numbers language-none"><code class="language-none">CELERY_IMPORTS &#x3D; (    &#39;django_celery_beat.tasks&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="在视图中触发定时任务"><a href="#在视图中触发定时任务" class="headerlink" title="在视图中触发定时任务"></a>在视图中触发定时任务</h3><pre class="line-numbers language-none"><code class="language-none">from django.http import JsonResponsefrom app01 import tasks# Create your views here.def index(request,*args,**kwargs):    res&#x3D;tasks.add.delay(1,3)    #任务逻辑    return JsonResponse(&#123;&#39;status&#39;:&#39;successful&#39;,&#39;task_id&#39;:res.task_id&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="在Django后台中配置定时任务"><a href="#在Django后台中配置定时任务" class="headerlink" title="在Django后台中配置定时任务"></a>在Django后台中配置定时任务</h3><p>在django后台中配置定时任务功能同样是靠beat完成任务发送功能，需要安装django-celery-beat插件。以下将介绍使用过程。</p><h4 id="安装django-celery-beat"><a href="#安装django-celery-beat" class="headerlink" title="安装django-celery-beat"></a>安装django-celery-beat</h4><pre class="line-numbers language-none"><code class="language-none">pip install django_celery_beat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="注册APP"><a href="#注册APP" class="headerlink" title="注册APP"></a>注册APP</h4><pre class="line-numbers language-none"><code class="language-none">INSTALLED_APPS &#x3D; [    ....       &#39;django_celery_beat&#39;,]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="数据库变更"><a href="#数据库变更" class="headerlink" title="数据库变更"></a>数据库变更</h4><pre class="line-numbers language-none"><code class="language-none">python3 manage.py migrate django_celery_beat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="分别启动woker和beat"><a href="#分别启动woker和beat" class="headerlink" title="分别启动woker和beat"></a>分别启动woker和beat</h4><pre class="line-numbers language-none"><code class="language-none">#启动beat 调度器使用数据库celery -A django_init beat -l info --scheduler django_celery_beat.schedulers:DatabaseScheduler  #启动wokercelery -A django_init worker -l info<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="配置admin"><a href="#配置admin" class="headerlink" title="配置admin"></a>配置admin</h4><p><code>/django_init/django_init/urls.py</code></p><pre class="line-numbers language-none"><code class="language-none">from django.urls import path, includefrom django.contrib import admin urlpatterns &#x3D; [    path(&#39;admin&#x2F;&#39;, admin.site.urls),]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h4><pre class="line-numbers language-none"><code class="language-none">python3 manage.py createsuperuser <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="启动Django服务"><a href="#启动Django服务" class="headerlink" title="启动Django服务"></a>启动Django服务</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">python manage<span class="token punctuation">.</span>py runserver <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8001</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="添加定时任务-1"><a href="#添加定时任务-1" class="headerlink" title="添加定时任务"></a>添加定时任务</h4><p>打开浏览器访问<a href="http://127.0.0.1:8001/admin/">http://127.0.0.1:8001/admin/</a><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/E94vxx.png" alt="PERIODIC TASKS"></p><ul><li>Clocked</li><li>Crontabs 计划任务定义</li><li>Intervals 间隔任务</li><li>Periodic tasks 任务定义</li><li>Solar events 根据太阳升起、降落定义任务</li></ul><p>Periodic tasks 任务定义<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/oAsOHd.png" alt="oAsOHd"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/xkOgGk.png" alt="xkOgGk"></p><p>保存后，可在celery workers中看到定时任务被执行的日志</p><h3 id="动态添加定时任务"><a href="#动态添加定时任务" class="headerlink" title="动态添加定时任务"></a>动态添加定时任务</h3><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; from django_celery_beat.models import PeriodicTask, IntervalSchedule# 添加定时间隔周期#IntervalSchedule.DAYS#IntervalSchedule.HOURS#IntervalSchedule.MINUTES#IntervalSchedule.SECONDS#IntervalSchedule.MICROSECONDS&gt;&gt;&gt; schedule, created &#x3D; IntervalSchedule.objects.get_or_create(...     every&#x3D;10,...     period&#x3D;IntervalSchedule.SECONDS,... )#添加定时任务&gt;&gt;&gt; PeriodicTask.objects.create(...     interval&#x3D;schedule,                  # we created this above....     name&#x3D;&#39;Importing contacts&#39;,          # simply describes this periodic task....     task&#x3D;&#39;proj.tasks.add&#39;,  # name of task.... )#下面是添加带参数的定时任务&gt;&gt;&gt; import json&gt;&gt;&gt; from datetime import datetime, timedelta&gt;&gt;&gt; PeriodicTask.objects.create(...     interval&#x3D;schedule,                  # we created this above....     name&#x3D;&#39;Importing contacts&#39;,          # simply describes this periodic task....     task&#x3D;&#39;proj.tasks.add&#39;,  # name of task....     args&#x3D;json.dumps([&#39;arg1&#39;, &#39;arg2&#39;]),...     kwargs&#x3D;json.dumps(&#123;...        &#39;be_careful&#39;: True,...     &#125;),...     expires&#x3D;datetime.utcnow() + timedelta(seconds&#x3D;30)... )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Django的orm作为结果存储"><a href="#Django的orm作为结果存储" class="headerlink" title="Django的orm作为结果存储"></a>Django的orm作为结果存储</h3><p>除了redis、rabbitmq能做结果存储外，还可以使用Django的orm作为结果存储，当然需要安装依赖插件，这样的好处在于我们可以直接通过django的数据查看到任务状态，同时为可以制定更多的操作，下面介绍如何使用orm作为结果存储。</p><p>安装</p><pre class="line-numbers language-none"><code class="language-none">pip install django-celery-results<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>配置settings.py，注册app</p><pre class="line-numbers language-none"><code class="language-none">INSTALLED_APPS &#x3D; (    ...,    &#39;django_celery_results&#39;,)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>修改backend配置，将redis改为django-db</p><pre class="line-numbers language-none"><code class="language-none">#CELERY_RESULT_BACKEND &#x3D; &#39;redis:&#x2F;&#x2F;10.1.210.69:6379&#x2F;0&#39; # BACKEND配置，这里使用redisCELERY_RESULT_BACKEND &#x3D; &#39;django-db&#39;  #使用django orm 作为结果存储<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>修改数据库</p><pre class="line-numbers language-none"><code class="language-none">python manage.py migrate django_celery_results<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此时会看到数据库会多创建<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/vYNA6P.png" alt="vYNA6P"></p><p>在 /django_init/venv/lib/python3.7/site-packages/django_celery_results/models.py 可以看到<br>TaskResult表的定义</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">TaskResult</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Task result/status."""</span>    task_id <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        max_length<span class="token operator">=</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>            settings<span class="token punctuation">,</span>            <span class="token string">'DJANGO_CELERY_RESULTS_TASK_ID_MAX_LENGTH'</span><span class="token punctuation">,</span>            <span class="token number">255</span>        <span class="token punctuation">)</span><span class="token punctuation">,</span>        unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task ID'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Celery ID for the Task that was run'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    task_name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task Name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Name of the Task which was run'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    task_args <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task Positional Arguments'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'JSON representation of the positional arguments '</span>                    <span class="token string">'used with the task'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    task_kwargs <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task Named Arguments'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'JSON representation of the named arguments '</span>                    <span class="token string">'used with the task'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    status <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> default<span class="token operator">=</span>states<span class="token punctuation">.</span>PENDING<span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        choices<span class="token operator">=</span>TASK_STATE_CHOICES<span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task State'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Current state of the task being run'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    worker <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Worker'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Worker that executes the task'</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span>    content_type <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        max_length<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Result Content Type'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Content type of the result data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    content_encoding <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>        max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Result Encoding'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'The encoding used to save the task result data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    result <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Result Data'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'The data returned by the task.  '</span>                    <span class="token string">'Use content_encoding and content_type fields to read.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    date_created <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>        auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Created DateTime'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Datetime field when the task result was created in UTC'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    date_done <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>        auto_now<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Completed DateTime'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Datetime field when the task was completed in UTC'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    traceback <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>        blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Traceback'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Text of the traceback if the task generated one'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    meta <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span>        null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> editable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>        verbose_name<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'Task Meta Information'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        help_text<span class="token operator">=</span>_<span class="token punctuation">(</span><span class="token string">'JSON meta information about the task, '</span>                    <span class="token string">'such as information on child tasks'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    objects <span class="token operator">=</span> managers<span class="token punctuation">.</span>TaskResultManager<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Table information."""</span>        ordering <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'-date_done'</span><span class="token punctuation">]</span>        verbose_name <span class="token operator">=</span> _<span class="token punctuation">(</span><span class="token string">'task result'</span><span class="token punctuation">)</span>        verbose_name_plural <span class="token operator">=</span> _<span class="token punctuation">(</span><span class="token string">'task results'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">as_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>            <span class="token string">'task_id'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>task_id<span class="token punctuation">,</span>            <span class="token string">'task_name'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>task_name<span class="token punctuation">,</span>            <span class="token string">'task_args'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>task_args<span class="token punctuation">,</span>            <span class="token string">'task_kwargs'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>task_kwargs<span class="token punctuation">,</span>            <span class="token string">'status'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>status<span class="token punctuation">,</span>            <span class="token string">'result'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>result<span class="token punctuation">,</span>            <span class="token string">'date_done'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>date_done<span class="token punctuation">,</span>            <span class="token string">'traceback'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>traceback<span class="token punctuation">,</span>            <span class="token string">'meta'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>meta<span class="token punctuation">,</span>            <span class="token string">'worker'</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>worker        <span class="token punctuation">&#125;</span>    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'&lt;Task: &#123;0.task_id&#125; (&#123;0.status&#125;)>'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在admin后台查看task result的执行结果<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/mQlnbp.png" alt="mQlnbp"></p><h3 id="Celery参考配置"><a href="#Celery参考配置" class="headerlink" title="Celery参考配置"></a>Celery参考配置</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Celery 配置</span>CELERY_BROKER_URL <span class="token operator">=</span> <span class="token string">'redis://127.0.0.1:6379/0'</span>  <span class="token comment"># Broker配置，使用Redis作为消息中间件</span><span class="token comment"># CELERY_RESULT_BACKEND = 'redis://10.1.210.69:6379/0'  # BACKEND配置，这里使用redis</span>CELERY_RESULT_BACKEND <span class="token operator">=</span> <span class="token string">'django-db'</span>  <span class="token comment"># 使用django orm 作为结果存储</span>CELERY_RESULT_SERIALIZER <span class="token operator">=</span> <span class="token string">'json'</span>  <span class="token comment"># 结果序列化方案</span><span class="token comment"># 注册定时任务</span>CELERY_IMPORTS <span class="token operator">=</span> <span class="token punctuation">(</span>    <span class="token string">'djcelery_beat_app.tasks'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.cnblogs.com/wdliu/p/9530219.html">Django中使用Celery</a></li><li><a href="https://www.cnblogs.com/wdliu/p/9517535.html">分布式任务队列Celery入门与进阶</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
            <tag> django-celery-beat </tag>
            
            <tag> celery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>以太坊（ETH）挖矿教程</title>
      <link href="2021/05/06/yi-tai-fang-eth-wa-kuang-jiao-cheng/"/>
      <url>2021/05/06/yi-tai-fang-eth-wa-kuang-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>挖矿教程</p></blockquote><span id="more"></span><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ol><li>准备一台电脑，提供良好的网络</li><li>注册交易所</li><li>注册矿池</li><li>下载挖矿软件</li><li>在挖矿软件中填写矿池地址，开始挖矿</li><li>将矿池中的币提取到交易所，进行交易</li></ol><h3 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h3><p><strong>带独显的电脑</strong></p><p>N卡选择GTX1060 6G及其以上，A卡选择RX470 8G及其以上。很多老卡已经不能挖了，或者说有的老卡收益非常低，抵不过电费。</p><p><strong>良好的网络</strong></p><p>网络延迟太厉害会影响产量。另外，接网线比较稳定。</p><h3 id="各种注册"><a href="#各种注册" class="headerlink" title="各种注册"></a>各种注册</h3><h4 id="注册交易所"><a href="#注册交易所" class="headerlink" title="注册交易所"></a>注册交易所</h4><p>注册交易所，作为你贮存ETH和卖出ETH的地点。</p><p>常见的交易所有：火币、币安、OKEX、中币等等等等。</p><p>至于使用哪个交易所，我不提供建议，需要各位自己上网了解各家利弊和风险，自主选择。</p><p>注册完之后，记住“充币地址“，以后从矿池里挖矿到提币门槛，币就会自动从矿池账户转到交易所账户，然后直接开展交易。</p><h4 id="注册矿池"><a href="#注册矿池" class="headerlink" title="注册矿池"></a>注册矿池</h4><p>注册一个自己的矿池，作为你挖矿的地点。</p><p>常见的矿池平台有星火矿池、鱼池、火币矿池等等，我自己用的是星火矿池。</p><p>注册之后，记住你的”<strong>矿池地址</strong>“和”<strong>钱包地址</strong>“，以后挖矿软件要用到。</p><p>然后在提币设置里面输入之前注册交易所里面的”充币地址”，以后从矿池里挖矿到提币门槛了，币就会自动从矿池账户转到交易所账户。</p><p>如果挖币不急着交易，想日积月累以后统一卖了，也可以注册一个钱包来储存ETH，比如Metamask，把矿池里面的自动提币设置改成Metamask里面的ETH账户地址。</p><p><a href="https://help.sparkpool.com/hc/kb/article/1413628/?lang=zh_cn">ETH挖矿教程—星火矿池</a></p><h3 id="各种软件"><a href="#各种软件" class="headerlink" title="各种软件"></a>各种软件</h3><p><strong>挖矿软件</strong></p><p>你需要使用挖矿软件在矿池里面挖矿。</p><p>现在傻瓜式挖矿软件众多，抽水也不低。建议用原版内核，抽水少一点，比如PhoenixMiner或者NBMiner。</p><h4 id="PhoenixMiner"><a href="#PhoenixMiner" class="headerlink" title="PhoenixMiner"></a>PhoenixMiner</h4><ol><li>下载地址github下载</li><li>下载后解压，解压密码phoenix</li><li>用记事本打开start_miner.bat文件</li><li>将ssl:\<a href="http://eu1.ethermine.org:5555修改为你要挖矿的矿池地址，详询矿池">http://eu1.ethermine.org:5555修改为你要挖矿的矿池地址，详询矿池</a></li><li>将0x39e987c72d3b35da03ba9aca26a9e9f91c16c04c修改为你的钱包地址</li><li>将Rig001修改为你的矿工名</li><li>保存后关闭，双击运行开始挖矿</li></ol><h4 id="NBMiner"><a href="#NBMiner" class="headerlink" title="NBMiner"></a>NBMiner</h4><ol><li>下载地址github下载</li><li>下载后解压</li><li>用记事本打开start_eth.bat文件</li><li>将<a href="http://cn.sparkpool.com:13333修改为你要挖矿的矿池地址，详询矿池">http://cn.sparkpool.com:13333修改为你要挖矿的矿池地址，详询矿池</a></li><li>将0x4296116d44a4a7259B52B1A756e19083e675062A修改为你的钱包地址</li><li>将default修改为你的矿工名</li><li>保存后关闭，双击运行开始挖矿</li></ol><h4 id="超频软件"><a href="#超频软件" class="headerlink" title="超频软件"></a>超频软件</h4><p>微星小飞机或者各显卡品牌自带的超频软件，游戏玩家都知道，我就不展开了。</p><p>具体超频思路是，降功耗墙，拉显存，每个显卡体质不同，建议量力而行，搞好散热工作。</p><p>毕竟只是恶心下矿佬，别往极限超。比如RTX3060ti和3070用户，功耗墙56%/显存400/风扇60%就够了。怕坏的话，显存就不要超了，风扇再拉低到50%这样。</p><p>RTX3080和3090用户显存有点危险，想超的话建议给显存加散热贴，把温度传递到背板和散热器上，有条件的知友可以试试</p><h4 id="监测软件"><a href="#监测软件" class="headerlink" title="监测软件"></a>监测软件</h4><p>用GPU-z来观察显卡的实时状态，并且目前只有RTX3080及其以上的显卡才能看显存温度。</p><h3 id="风险提示"><a href="#风险提示" class="headerlink" title="风险提示"></a>风险提示</h3><ul><li>不要在挖矿软件里面填错任何地址，不然你的收益都变成别人的了；</li><li>交易所和矿池潜在倒闭跑路风险，建议用用户量较大的主流平台；</li><li>交易所提现过程中可能受到不干净的资金，导致卡被冻结，建议拿一个闲置的银行卡来换取资金；</li></ul><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="http://www.qskg.top/">轻松矿工</a></li><li><a href="https://help.sparkpool.com/hc/kb/article/1413628/?lang=zh_cn">ETH挖矿教程—星火矿池</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 区块链 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 以太坊 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Django项目里单独运行某个py文件</title>
      <link href="2021/04/30/zai-django-xiang-mu-li-dan-du-yun-xing-mou-ge-py-wen-jian/"/>
      <url>2021/04/30/zai-django-xiang-mu-li-dan-du-yun-xing-mou-ge-py-wen-jian/</url>
      
        <content type="html"><![CDATA[<blockquote><p>在Django项目里单独运行某个py文件</p></blockquote><span id="more"></span><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span> sys<span class="token punctuation">,</span> django<span class="token comment"># BASE_DIR 寻找项目根目录</span>BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">)</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation">,</span> <span class="token string">'project_name.settings'</span><span class="token punctuation">)</span>django<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> Person<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token builtin">all</span> <span class="token operator">=</span>Person<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">all</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux常用命令整理</title>
      <link href="2021/04/29/linux-chang-yong-ming-ling-zheng-li/"/>
      <url>2021/04/29/linux-chang-yong-ming-ling-zheng-li/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Linux 常用命令整理</p></blockquote><span id="more"></span><h3 id="端口占用"><a href="#端口占用" class="headerlink" title="端口占用"></a>端口占用</h3><p>lsof -i:端口号 用于查看某一端口的占用情况，比如查看8000端口使用情况，lsof -i:8000</p><pre class="line-numbers language-none"><code class="language-none"># lsof -i:端口号➜  lsof -i:8001COMMAND   PID     USER   FD   TYPE             DEVICE SIZE&#x2F;OFF NODE NAMEPython  12594 wangqiao    5u  IPv4 0xe79196fc978d9f53      0t0  TCP *:vcom-tunnel (LISTEN)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>netstat -tunlp |grep 端口号，用于查看指定的端口号的进程情况，如查看8000端口的情况，netstat -tunlp |grep 8000</p><pre class="line-numbers language-none"><code class="language-none"># netstat -tunlp Active Internet connections (only servers)Proto Recv-Q Send-Q Local Address               Foreign Address             State       PID&#x2F;Program name   tcp        0      0 0.0.0.0:111                 0.0.0.0:*                   LISTEN      4814&#x2F;rpcbind        tcp        0      0 0.0.0.0:5908                0.0.0.0:*                   LISTEN      25492&#x2F;qemu-kvm      tcp        0      0 0.0.0.0:6996                0.0.0.0:*                   LISTEN      22065&#x2F;lwfs          tcp        0      0 192.168.122.1:53            0.0.0.0:*                   LISTEN      38296&#x2F;dnsmasq       tcp        0      0 0.0.0.0:22                  0.0.0.0:*                   LISTEN      5278&#x2F;sshd           tcp        0      0 127.0.0.1:631               0.0.0.0:*                   LISTEN      5013&#x2F;cupsd          tcp        0      0 127.0.0.1:25                0.0.0.0:*                   LISTEN      5962&#x2F;master         tcp        0      0 0.0.0.0:8666                0.0.0.0:*                   LISTEN      44868&#x2F;lwfs          tcp        0      0 0.0.0.0:8000                0.0.0.0:*                   LISTEN      22065&#x2F;lwfs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none"># netstat -tunlp | grep 8000tcp        0      0 0.0.0.0:8000                0.0.0.0:*                   LISTEN      22065&#x2F;lwfs <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="磁盘清理"><a href="#磁盘清理" class="headerlink" title="磁盘清理"></a>磁盘清理</h3><pre class="line-numbers language-none"><code class="language-none">du -shdu -sh *df -hdu -sh * grep Gll ll -h<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pycharm配置autopep8</title>
      <link href="2021/04/28/pycharm-pei-zhi-autopep8/"/>
      <url>2021/04/28/pycharm-pei-zhi-autopep8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Pycharm让代码自动转换成pip8风格</p></blockquote><span id="more"></span><p>Pycharm本身是有pep8风格检测的，当你敲得代码中不符合规范时，会有下划波浪线提示。为了去掉这些难看的波浪线，我们需要借助autopep8这个工具让代码自动转换成pip8风格。</p><h3 id="安装autopep8"><a href="#安装autopep8" class="headerlink" title="安装autopep8"></a>安装autopep8</h3><pre class="line-numbers language-none"><code class="language-none">pip install autopep8<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="mac-配置"><a href="#mac-配置" class="headerlink" title="mac 配置"></a>mac 配置</h3><p>Preferences-&gt;Tools-&gt;External Tools-&gt;点击加号<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/AcfE3V.png" alt="AcfE3V"><br>点击+号后出现配置选项<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/z0xfgQ.png" alt="z0xfgQ"><br>添加autopep8配置<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/AmDFFI.png" alt="AmDFFI"></p><pre class="line-numbers language-none"><code class="language-none">- Name：Autopep8（可以随便取）- Tools settings:     - Programs：autopep8 （前提是你已经安装了哦）    - Parameters: --in-place --aggressive --aggressive $FilePath$&#96;    - Working directory: $ProjectFileDir$- 点击Output Filters→添加，在对话框中的：Regular expression to match output中输入：$FILE_PATH$\:$LINE$\:$COLUMN$\:.*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>配置完成External Tools出现aotopep8</p><p>使用</p><p>autopep8在pycharm中的使用：在Pycharm编辑其中新建一个python文件，编辑一些不符合pep8风格的代码；将鼠标放在该文件的编辑器中→右键→External Tools→点击Autopep8。这样你的代码就符合pep8的风格了。</p><h3 id="windows-配置"><a href="#windows-配置" class="headerlink" title="windows 配置"></a>windows 配置</h3><p>File-&gt;Settings-&gt;Tools-&gt;External Tools-&gt; 点击<code>+</code>添加</p><p>配置</p><pre class="line-numbers language-none"><code class="language-none">Name: Autopep8（自定义名称）Tool Settings:    Program:C:\ProgramData\Anaconda4.3.0\Scripts\autopep8.exe    Argumetns: --in-place --aggressive --aggressive $FilePath$    Working direcroty: $ProjectFileDir$    Advanced Options:    Output filters: $FILE_PATH$\:$LINE$\:$COLUMNS$\:.*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>应用</p><p><code>Tools</code>-&gt;<code>External Tools</code>-&gt; <code>Autopep8</code></p><p>参考：</p><ul><li><a href="https://segmentfault.com/a/1190000005816556">Pycharm配置autopep8教程，让Python代码更符合pep8规范</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> pycharm </tag>
            
            <tag> autopep8 </tag>
            
            <tag> ide </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode使用教程</title>
      <link href="2021/04/28/vscode-shi-yong-jiao-cheng/"/>
      <url>2021/04/28/vscode-shi-yong-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><h4 id="在vscode中调试django"><a href="#在vscode中调试django" class="headerlink" title="在vscode中调试django"></a>在vscode中调试django</h4><p>1.创建/打开django项目</p><p>2.在调试侧边栏里，选择创建launch.json</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/VbnGJr.png" alt="创建launch.json"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/kzbo9I.png" alt="选择python环境"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/htbiNC.png" alt="选择django项目"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Z8iTuK.png" alt="launch.json"></p><p>配置参考</p><pre class="line-numbers language-none"><code class="language-none">&#123;    &#x2F;&#x2F; 使用 IntelliSense 了解相关属性。     &#x2F;&#x2F; 悬停以查看现有属性的描述。    &#x2F;&#x2F; 欲了解更多信息，请访问: https:&#x2F;&#x2F;go.microsoft.com&#x2F;fwlink&#x2F;?linkid&#x3D;830387    &quot;version&quot;: &quot;0.2.0&quot;,    &quot;configurations&quot;: [        &#123;            &quot;name&quot;: &quot;Python: Django&quot;,            &quot;type&quot;: &quot;python&quot;,            &quot;request&quot;: &quot;launch&quot;,            &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;&#x2F;manage.py&quot;,            &quot;args&quot;: [                &quot;runserver&quot;,                &quot;0.0.0.0:8001&quot;            ],            &quot;django&quot;: true        &#125;    ]&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> ide </tag>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python深拷贝与浅拷贝的区别(一文看懂)</title>
      <link href="2021/04/23/python-shen-kao-bei-yu-qian-kao-bei-de-qu-bie-yi-wen-kan-dong/"/>
      <url>2021/04/23/python-shen-kao-bei-yu-qian-kao-bei-de-qu-bie-yi-wen-kan-dong/</url>
      
        <content type="html"><![CDATA[<blockquote><p>很多人在学python的过程中往往会混淆深拷贝与浅拷贝的概念，深拷贝是对于对象的完全复制，这个好理解。很多人对浅拷贝理解为windows的快捷方式，其实也不尽然…下面的文字将会让你彻底理解他们之间的关系。</p><span id="more"></span><p>先从一道面试题开始：<br>写出下列代码运行结果：</p></blockquote><pre class="line-numbers language-none"><code class="language-none">import copy  a &#x3D; [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;]] b &#x3D; a c &#x3D; copy.copy(a) d &#x3D; copy.deepcopy(a) a.append(5)             [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;], 5] a[4].append(&#39;c&#39;)        [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]print &#39;a &#x3D; &#39;, a   [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], 5]print &#39;b &#x3D; &#39;, b  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], 5]print &#39;c &#x3D; &#39;, c  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]print &#39;d &#x3D; &#39;, d  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;]] <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>很多人不理解c的输出结果，这正是因为没有深刻理解浅拷贝而容易走进的误区。</p><hr><p>先说结论，让我们来一起按图索骥:</p><ul><li>浅拷贝：对顶层对象引用的拷贝。</li><li>深拷贝：对一个对象所有层次的拷贝（递归）。【即按照原来的样子在内存中申请空间另外创建一份，与拷贝对象没有任何关系】</li></ul><p>示例:</p><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; import copy&gt;&gt;&gt; a &#x3D; [1,2]&gt;&gt;&gt; b &#x3D; [3,4]&gt;&gt;&gt; c &#x3D; [a,b]&gt;&gt;&gt; d &#x3D; c  # d &#x3D; c相当于增加了对 对象[a,b] 的引用计数&gt;&gt;&gt; e &#x3D; copy.copy(c) # e是对c的浅拷贝，即对c顶层对象的拷贝<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="d-c-与-e-copy-copy-c-的区别？"><a href="#d-c-与-e-copy-copy-c-的区别？" class="headerlink" title="d = c 与 e = copy.copy(c)的区别？"></a>d = c 与 e = copy.copy(c)的区别？</h3><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; id(c),id(d),id(e)(140089296095856, 140089296095856, 140089296096144)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>可以看出<code>c</code>和<code>d</code>指向同一块内存,<code>e</code>为另外一块内存区域,所以<code>d=c</code>仅仅是增加了<code>[a,b]</code>的引用计数,而<code>e = copy.copy(c)</code>使系统在内存中另外申请一块内存,用于存放<code>[a,b]</code>的值.</p><h3 id="针对可变与不可变类型的浅拷贝"><a href="#针对可变与不可变类型的浅拷贝" class="headerlink" title="针对可变与不可变类型的浅拷贝"></a>针对可变与不可变类型的浅拷贝</h3><ul><li>可变类型mutable：列表、字典</li></ul><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; import copy&gt;&gt;&gt; a &#x3D; [1,2]&gt;&gt;&gt; b &#x3D; copy.copy(a)&gt;&gt;&gt; id(a)139729228940856&gt;&gt;&gt; id(b) 139729228503808<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>浅拷贝对于可变类型而言：在内存重新划分一块区域，其中保存对顶层对象的引用</p><ul><li>不可变类型immutable：数字、字符串、元组</li></ul><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; import copy&gt;&gt;&gt; a &#x3D; &quot;amuqiao&quot;&gt;&gt;&gt; b &#x3D; copy.copy(a)&gt;&gt;&gt; id(a)140663661215344&gt;&gt;&gt; id(b)140663661215344<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>浅拷贝对于不可变类型而言是对被拷贝对象的引用</p><h3 id="带着结论回顾第一题"><a href="#带着结论回顾第一题" class="headerlink" title="带着结论回顾第一题"></a>带着结论回顾第一题</h3><pre class="line-numbers language-none"><code class="language-none">import copy  a &#x3D; [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;]] b &#x3D; a c &#x3D; copy.copy(a) d &#x3D; copy.deepcopy(a) a.append(5)             [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;], 5] a[4].append(&#39;c&#39;)        [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]print &#39;a &#x3D; &#39;, a   [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], 5]print &#39;b &#x3D; &#39;, b  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], 5]# 可以得到两点:1.c是对a的浅拷贝;2.a是可变类型,即只保存对a顶层对象的引用。# 换句话说:在内存中重新划分一块内存,用于保存对a顶层对象的引用,此时id(a)不等于id(c),# 当a.append(5)的时候,c中保存的&quot;a的顶层对象的引用&quot;的值并没有改变,所以c不变# 当a[4].append(&#39;c&#39;)的时候,c中保存的&quot;a的顶层对象的引用&quot;的值[&#39;a&#39;, &#39;b&#39;]变成了# [&#39;a&#39;, &#39;b&#39;,&#39;c&#39;],所以c也改变了print &#39;c &#x3D; &#39;, c  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]print &#39;d &#x3D; &#39;, d  [1, 2, 3, 4, [&#39;a&#39;, &#39;b&#39;]] <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h3><p>对一个对象所有层次的拷贝（递归）。【即按照原来的样子在内存中申请空间另外创建一份，与拷贝对象没有任何关系】</p><p>参考链接:<br>1.<a href="http://www.cnblogs.com/nobkb/p/3322684.html">Python中的copy和deepcopy</a><br>2.<a href="http://www.cnblogs.com/huamingao/p/5809936.html">理解python可变类型vs不可变类型，深拷贝vs浅拷贝</a></p>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> copy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python中requests使用指南</title>
      <link href="2021/04/23/python-zhong-requests-shi-yong-zhi-nan/"/>
      <url>2021/04/23/python-zhong-requests-shi-yong-zhi-nan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>python模块requests使用指南</p></blockquote><span id="more"></span><ul><li>使用get方法带参数请求时，是params=参数字典</li><li>使用post方法带参数请求时，是post=参数字典</li><li>在url编码时，有些编码是把空格编码为+，有些则是编码为%20</li><li>requests会对参数进行自动编码</li></ul><h3 id="get方法带参数请求"><a href="#get方法带参数请求" class="headerlink" title="get方法带参数请求"></a>get方法带参数请求</h3><pre class="line-numbers language-none"><code class="language-none">params&#x3D;&#123;    &#39;cid&#39;:567464,    &#39;page&#39;:1,    &#39;key&#39;:&#39;&#39;,    &#39;language&#39;:1,    &#39;gtk&#39;:6,    &#39;_cid&#39;:567464,    &#39;_mid&#39;:34949,    &#39;_dt&#39;:&#39;2019-05-03 13:03:08&#39;,    &#39;_sign&#39;:&#39;e74c8c52618a64a454dd7f12aff3cc1c&#39;    &#125;def getFun(url,data):    ret&#x3D;requests.get(url,params&#x3D;params)    print(ret.url)    return ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="post方法带参数请求"><a href="#post方法带参数请求" class="headerlink" title="post方法带参数请求"></a>post方法带参数请求</h3><pre class="line-numbers language-none"><code class="language-none">data&#x3D;&#123;    &#39;cid&#39;:567464,    &#39;page&#39;:1,    &#39;key&#39;:&#39;&#39;,    &#39;language&#39;:1,    &#39;gtk&#39;:6,    &#39;_cid&#39;:567464,    &#39;_mid&#39;:34949,    &#39;_dt&#39;:&#39;2019-05-03 13:03:08&#39;,    &#39;_sign&#39;:&#39;e74c8c52618a64a454dd7f12aff3cc1c&#39;    &#125;def getFun(url,data):    ret&#x3D;requests.post(url,data&#x3D;data)    print(ret.url)    return ret<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> requests </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python模块搜索路径(看这一篇就够了)</title>
      <link href="2021/04/22/python-mo-kuai-sou-suo-lu-jing-kan-zhe-yi-pian-jiu-gou-liao/"/>
      <url>2021/04/22/python-mo-kuai-sou-suo-lu-jing-kan-zhe-yi-pian-jiu-gou-liao/</url>
      
        <content type="html"><![CDATA[<blockquote><p>由于某些原因，执行Python程序时，常常出现ImportError、ModuleNotFoundError等错误，归根究底，是当前需要的模块不在python搜索路径中。那么，Python 如何知道在哪里搜索模块的路径呢？</p></blockquote><h3 id="什么是模块搜索路径？"><a href="#什么是模块搜索路径？" class="headerlink" title="什么是模块搜索路径？"></a>什么是模块搜索路径？</h3><p>Python导入模块<code>hello</code>时，按照以下路径进行搜索</p><pre class="line-numbers language-none"><code class="language-none">1.具有该名称的内置模块2.在变量 sys.path 给出的目录列表中搜索名为 hello.py 的文件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>sys.path</code> 从这些位置初始化：</p><pre class="line-numbers language-none"><code class="language-none">1.包含输入脚本的目录（或当前目录，当没有指定文件时）2.PYTHONPATH（目录名列表，与 shell 变量 PATH 语法相同）3.与安装相关的默认值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>查看搜索路径</p><pre class="line-numbers language-none"><code class="language-none"># &#39;&#39; 表示当前目录（当前脚本所在的路径）$ python&gt;&gt;&gt; import sys&gt;&gt;&gt; sys.path[&#39;&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python36.zip&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python3.6&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python3.6&#x2F;lib-dynload&#39;, &#39;&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH&#x2F;THKarma&#x2F;venv&#x2F;lib&#x2F;python3.6&#x2F;site-packages&#39;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="添加模块搜索路径"><a href="#添加模块搜索路径" class="headerlink" title="添加模块搜索路径"></a>添加模块搜索路径</h3><p>为了解决上述问题，需要添加模块搜索路径，可以使用以下几种方式</p><h4 id="动态增加路径"><a href="#动态增加路径" class="headerlink" title="动态增加路径"></a>动态增加路径</h4><p>临时生效，对于不经常使用的模块，这通常是最好的方式，因为不必用所有次要模块的路径来污染 <code>PYTHONPATH</code>。</p><p>通过 <code>sys</code> 模块的 <code>append()</code> 方法在 Python 环境中增加搜索路径：</p><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; import sys&gt;&gt;&gt; sys.path.append(&#39;&#x2F;home&#x2F;wang&#x2F;workspace&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="修改-PYTHONPATH-变量"><a href="#修改-PYTHONPATH-变量" class="headerlink" title="修改 PYTHONPATH 变量"></a>修改 <code>PYTHONPATH</code> 变量</h4><p>永久生效，对于在许多程序中都使用的模块，可以采用这种方式。这将改变所有 Python 应用的搜索路径，因为启动 Python 时，它会读取这个变量，甚至不同版本的 Python 都会受影响。</p><pre class="line-numbers language-none"><code class="language-none">vi ~&#x2F;.bash_profileexport PYTHONPATH&#x3D;$PYTHONPATH:&#x2F;home&#x2F;wang&#x2F;workspace或者export PYTHONPATH&#x3D;&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH:$PYTHONPATHsource ~&#x2F;.bash_profile  # 使配置生效<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="增加-pth-文件"><a href="#增加-pth-文件" class="headerlink" title="增加 .pth 文件"></a>增加 <code>.pth</code> 文件</h4><p>永久生效，这是最简单的、也是推荐的方式,<br>Python在遍历已知的库文件目录过程中，如果见到一个<code>.pth</code> 文件，就会将文件中所记录的路径加入到 <code>sys.path</code> 设置中，于是 <code>.pth</code> 文件说指明的库也就可以被 Python 运行环境找到了。<br>python中有一个<code>.pth</code>文件，该文件的用法是：</p><p>在 <code>/usr/local/lib/python3.5/site-packages</code> 或者当前虚拟环境下<code>site-packages</code> 中添加一个扩展名为 <code>.pth</code> 的配置文件（例如：my.pth），内容为要添加的路径：</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH&#x2F;THKarma&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>验证路径是否添加</p><pre class="line-numbers language-none"><code class="language-none">$ python&gt;&gt;&gt; import sys&gt;&gt;&gt; sys.path[&#39;&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python36.zip&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python3.6&#39;, &#39;&#x2F;usr&#x2F;local&#x2F;var&#x2F;pyenv&#x2F;versions&#x2F;3.6.5&#x2F;lib&#x2F;python3.6&#x2F;lib-dynload&#39;, &#39;&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH&#x2F;THKarma&#x2F;venv&#x2F;lib&#x2F;python3.6&#x2F;site-packages&#39;, &#39;&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH&#x2F;THKarma&#39;, &#39;&#x2F;Users&#x2F;wangqiao&#x2F;code&#x2F;TH&#39;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>注意，如果添加了路径还是出现<code>ModuleNotFoundError</code>，将项目的上层路径也添加到搜索路径中</p><p>参考：</p><ul><li><a href="https://www.jianshu.com/p/cb6447e1cf88">为Python添加默认模块搜索路径</a></li><li><a href="https://blog.csdn.net/liang19890820/article/details/76219560">Python 模块搜索路径</a></li><li><a href="https://www.cnblogs.com/luoye00/p/5223543.html">python在不同层级目录import模块的方法</a></li><li><a href="https://www.cnblogs.com/ydf0509/p/8298551.html">python 导入模块的坑(帮助理解导包)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 模块搜索路径 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>simplejson和json使用及区别</title>
      <link href="2021/04/22/simplejson-he-json-shi-yong-ji-qu-bie/"/>
      <url>2021/04/22/simplejson-he-json-shi-yong-ji-qu-bie/</url>
      
        <content type="html"><![CDATA[<blockquote><p>json、simplejson效率比较：simplejson在效率上来得有优势，推荐用simplejson</p></blockquote><span id="more"></span><p>几个主要函数：dump、dumps、load、loads，带s跟不带s的区别： 带s的是对 字符串的处理，而不带 s的是对文件对像的处理。</p><h3 id="python-json-dumps-json-dump-的区别"><a href="#python-json-dumps-json-dump-的区别" class="headerlink" title="python json.dumps() json.dump()的区别"></a>python json.dumps() json.dump()的区别</h3><p>首先说明基本功能：</p><ul><li>dumps是将dict转化成str格式，loads是将str转化成dict格式。</li><li>dump和load也是类似的功能，只是与文件操作结合起来了。</li></ul><pre class="line-numbers language-none"><code class="language-none">import simplejson as jsonfw &#x3D; open(&quot;test.txt&quot;,&quot;wb&quot;)dict &#x3D; &#123;&quot;name&quot;:xiaoming,&quot;age&quot;:20,&quot;school&quot;:&quot;sysu&quot;&#125;json.dump(dict,fw) # 存入文件dict &#x3D; json.load(open(&quot;test.txt&quot;,&quot;rb&quot;))for k,v in dict.items():    print k,v<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考文档</p><ul><li><a href="http://www.cnblogs.com/wswang/p/5411826.html">python json.dumps() json.dump()的区别</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> json </tag>
            
            <tag> simplejson </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Django ORM中原生JSONField的使用方法</title>
      <link href="2021/04/21/django-orm-zhong-yuan-sheng-jsonfield-de-shi-yong-fang-fa/"/>
      <url>2021/04/21/django-orm-zhong-yuan-sheng-jsonfield-de-shi-yong-fang-fa/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Django最新版v3.1的主要更新之一便是完善了对JSON数据存储的支持，新增models.JSONField<br>和forms.JSONField，可在所有受支持的数据库后端上使用</p></blockquote><p>目前支持的数据库以及对应版本主要有</p><ul><li>MariaDB 10.2.7+</li><li>MySQL 5.7.8+</li><li>Oracle</li><li>PostgreSQL</li><li>SQLite 3.9.0+</li></ul><p>但个别Django的查询方法可能与部分数据库不兼容，例如contains<br>和contained_by<br>就不支持Oracle和SQLite数据库</p><h3 id="JSONField使用"><a href="#JSONField使用" class="headerlink" title="JSONField使用"></a>JSONField使用</h3><pre class="line-numbers language-none"><code class="language-none">from django.db import modelsclass Hero(models.Model):        name &#x3D; models.CharField(max_length&#x3D;200)        data &#x3D; models.JSONField(null&#x3D;True)          def __str__(self):                return self.name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过models.JSONField</p><p>可指定此字段为存储类型为JSON格式。null=True</p><p>表示此字段可以为空，这个NULL指的是SQL NULL</p><p>如果想存储为JsonNULL，则可以使用Value(‘null’)来实现</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.create(name&#x3D;&#39;coffee&#39;, data&#x3D;Value(&#39;null&#39;))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>SQL NULL与JsonNULL的区别主要在is_null<br>的查询上不同，可以通过以下这个示例来理解下</p><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt; from django.db.models import Value&gt;&gt;&gt;&gt;&gt;&gt; Hero.objects.create(name&#x3D;&#39;ops&#39;)&lt;Hero: ops&gt;&gt;&gt;&gt; Hero.objects.create(name&#x3D;&#39;coffee&#39;, data&#x3D;Value(&#39;null&#39;))&lt;Hero: coffee&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hero.objects.filter(data&#x3D;None)&lt;QuerySet [&lt;Hero: coffee&gt;]&gt;&gt;&gt;&gt; Hero.objects.filter(data&#x3D;Value(&#39;null&#39;))&lt;QuerySet [&lt;Hero: coffee&gt;]&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hero.objects.get(name&#x3D;&#39;ops&#39;).data&gt;&gt;&gt; Hero.objects.get(name&#x3D;&#39;coffee&#39;).data&gt;&gt;&gt;&gt;&gt;&gt; Hero.objects.filter(data__isnull&#x3D;True)&lt;QuerySet [&lt;Hero: ops&gt;]&gt;&gt;&gt;&gt; Hero.objects.filter(data__isnull&#x3D;False)&lt;QuerySet [&lt;Hero: coffee&gt;]&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="JSONField查询"><a href="#JSONField查询" class="headerlink" title="JSONField查询"></a>JSONField查询</h3><pre class="line-numbers language-none"><code class="language-none">data &#x3D; &#123;&#39;age&#39;: 12,&#39;group&#39;:                 &#123;                    &#39;name&#39;: &#39;ow1&#39;,                    &#39;skill&#39;: [                            &#123;&#39;name&#39;: &#39;swim&#39;, &#39;rank&#39;: &#39;A+&#39;&#125;,                            &#123;&#39;name&#39;: &#39;shot&#39;, &#39;rank&#39;: None&#125;                            ]                                    &#125;            &#125;Hero.objects.create(name&#x3D;&#39;ops-coffee.cn&#39;, data&#x3D;data)Hero.objects.create(name&#x3D;&#39;ops-coffee&#39;, data&#x3D;&#123;&#39;age&#39;:16&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当想要查询age为12的数据时可以这样查询</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__age&#x3D;12)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想要查询group的name为ow1的数据时可以这样查询</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__group__name&#x3D;&#39;ow1&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想要查询group下skill中第一个数据的name值为swim的数据时可以这样查询</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__group__skill__0__name&#x3D;&#39;swim&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想要查找包含group键的所有数据时，可以通过has_key来实现</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__has_key&#x3D;&#39;group&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想要查找同时包含group<br>键和age<br>键的所有数据时，可以通过has_keys<br>来实现</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__has_keys&#x3D;[&#39;group&#39;,&#39;age&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想要查找包含group<br>键或者age<br>键的所有数据时，可以通过has_any_keys<br>来实现</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__has_any_keys&#x3D;[&#39;group&#39;,&#39;age&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>当想一次性查找包含age<br>为12<br>且group<br>的name<br>为ow1<br>的数据时，可以通过contains<br>来实现</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__contains&#x3D;&#123;&#39;age&#39;:12,&#39;group&#39;: &#123;&#39;name&#39;: &#39;ow1&#39;&#125;&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>JSONField除了支持以上查询方式外，对于ORM所提供的大部分其他查询方式同样支持，例如</p><ul><li>icontains</li><li>endswith</li><li>iendswith</li><li>iexact</li><li>regex</li><li>iregex</li><li>startswith</li><li>istartswith</li><li>lt</li><li>lte</li><li>gt</li><li>gte</li></ul><p>使用起来也是非常方便</p><pre class="line-numbers language-none"><code class="language-none">Hero.objects.filter(data__age__lte&#x3D;12)Hero.objects.filter(data__group__name__startswith&#x3D;&#39;ow&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>参考文档</p><ul><li><a href="https://www.modb.pro/db/28826">Django ORM中原生JSONField的使用方法</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
            <tag> python </tag>
            
            <tag> orm </tag>
            
            <tag> jsonfield </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python列表项为dict的去重</title>
      <link href="2021/04/21/python-lie-biao-xiang-wei-dict-de-qu-chong/"/>
      <url>2021/04/21/python-lie-biao-xiang-wei-dict-de-qu-chong/</url>
      
        <content type="html"><![CDATA[<p>有如下列表</p><pre class="line-numbers language-none"><code class="language-none">li &#x3D; [&#123;&#39;a&#39;: 1&#125;, &#123;&#39;b&#39;: 2&#125;, &#123;&#39;a&#39;: 1&#125;]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果采用set的去重方式，则会报错</p><pre class="line-numbers language-none"><code class="language-none">li &#x3D; list(set(li))&gt;&gt;&gt;TypeError: unhashable type: &#39;dict&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>可以用下面的方法：<br>第一种：reduce</p><pre class="line-numbers language-none"><code class="language-none">def deleteDuplicate(li):    func &#x3D; lambda x, y: x if y in x else x + [y]    li &#x3D; reduce(func, [[], ] + li)    return li&gt;&gt;&gt; deleteDuplicate(li)&gt;&gt;&gt;[&#123;&#39;a&#39;: 1&#125;, &#123;&#39;b&#39;: 2&#125;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第二种：</p><pre class="line-numbers language-none"><code class="language-none">def deleteDuplicate(li):    temp_list &#x3D; list(set([str(i) for i in li]))    li&#x3D;[eval(i) for i in temp_list]    return li&gt;&gt;&gt; deleteDuplicate(li)&gt;&gt;&gt;[&#123;&#39;a&#39;: 1&#125;, &#123;&#39;b&#39;: 2&#125;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第三种：</p><pre class="line-numbers language-none"><code class="language-none">&gt;&gt;&gt;li &#x3D; [dict(t) for t in set([tuple(d.items()) for d in li])]&gt;&gt;&gt;li&gt;&gt;&gt;[&#123;&#39;a&#39;: 1&#125;, &#123;&#39;b&#39;: 2&#125;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>建议使用第三种，因为速度更加快，经过测试相同的数据，第三种方法速度比第一种的10倍。</p>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> dict </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlalchemy使用教程</title>
      <link href="2021/04/10/sqlalchemy-shi-yong-jiao-cheng/"/>
      <url>2021/04/10/sqlalchemy-shi-yong-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>sqlalchemy使用教程</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlalchemy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python项目配置文件</title>
      <link href="2021/04/09/python-xiang-mu-pei-zhi-wen-jian/"/>
      <url>2021/04/09/python-xiang-mu-pei-zhi-wen-jian/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Python 项目配置文件</p></blockquote><h3 id="Yaml格式配置文件"><a href="#Yaml格式配置文件" class="headerlink" title="Yaml格式配置文件"></a>Yaml格式配置文件</h3><h4 id="为什么使用YAML"><a href="#为什么使用YAML" class="headerlink" title="为什么使用YAML"></a>为什么使用YAML</h4><ul><li>YAML的可读性好。</li><li>YAML和脚本语言的交互性好。</li><li>YAML使用实现语言的数据类型。</li><li>YAML有一个一致的信息模型。</li><li>YAML易于实现。</li></ul><h4 id="首先安装yaml模块"><a href="#首先安装yaml模块" class="headerlink" title="首先安装yaml模块"></a>首先安装yaml模块</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip3 install pyyaml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="编写yaml配置文件-yaml-example-yaml"><a href="#编写yaml配置文件-yaml-example-yaml" class="headerlink" title="编写yaml配置文件 yaml_example.yaml"></a>编写yaml配置文件 yaml_example.yaml</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">app_config</span><span class="token punctuation">:</span>    <span class="token key atrule">log_level</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token key atrule">session_server</span><span class="token punctuation">:</span>    <span class="token key atrule">driver</span><span class="token punctuation">:</span> redis    <span class="token key atrule">driver_settings</span><span class="token punctuation">:</span>        <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>        <span class="token key atrule">password</span><span class="token punctuation">:</span>         <span class="token key atrule">db</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token key atrule">max_connections</span><span class="token punctuation">:</span> <span class="token number">512</span><span class="token key atrule">cache_server</span><span class="token punctuation">:</span>    <span class="token key atrule">driver</span><span class="token punctuation">:</span> redis    <span class="token key atrule">driver_settings</span><span class="token punctuation">:</span>        <span class="token key atrule">REDIS_HOST</span><span class="token punctuation">:</span> localhost        <span class="token key atrule">REDIS_PORT</span><span class="token punctuation">:</span> <span class="token number">6379</span>        <span class="token key atrule">REDIS_PASSWORD</span><span class="token punctuation">:</span>         <span class="token key atrule">REDIS_DB</span><span class="token punctuation">:</span> <span class="token number">2</span>        <span class="token key atrule">REDIS_EX</span><span class="token punctuation">:</span> <span class="token number">172800</span>         <span class="token key atrule">REDIS_MAX_CONNECTIONS</span><span class="token punctuation">:</span> <span class="token number">512</span><span class="token key atrule">database</span><span class="token punctuation">:</span>    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3306</span>    <span class="token key atrule">user</span><span class="token punctuation">:</span> root    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>    <span class="token key atrule">database</span><span class="token punctuation">:</span> test    <span class="token key atrule">charset</span><span class="token punctuation">:</span> utf8<span class="token key atrule">captcha_fonts</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> fonts/RedHatDisplay<span class="token punctuation">-</span>Regular.ttf    <span class="token punctuation">-</span> fonts/RedHatDisplay<span class="token punctuation">-</span>Medium.ttf    <span class="token punctuation">-</span> fonts/RedHatDisplay<span class="token punctuation">-</span>Black.ttf    <span class="token punctuation">-</span> fonts/RedHatDisplay<span class="token punctuation">-</span>Bold.ttf<span class="token key atrule">crypto_rsa</span><span class="token punctuation">:</span>    <span class="token key atrule">public_key_file</span><span class="token punctuation">:</span> keys/rsa_pub_key.pem    <span class="token key atrule">private_key_file</span><span class="token punctuation">:</span> keys/rsa_pri_key.pem<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="编写解析yaml文件的python程序-yaml-example-py"><a href="#编写解析yaml文件的python程序-yaml-example-py" class="headerlink" title="编写解析yaml文件的python程序 yaml_example.py"></a>编写解析yaml文件的python程序 yaml_example.py</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> yaml<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'local.yml'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    content <span class="token operator">=</span> yaml<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'before modification:'</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>    content<span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">17</span>    content<span class="token punctuation">[</span><span class="token string">'children'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'after modification'</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出配置结果"><a href="#输出配置结果" class="headerlink" title="输出配置结果:"></a>输出配置结果:</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">></span>before modification<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'junxi'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'spouse'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Rui'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">'children'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Chen You'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Ruo Xi'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>after modification <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'junxi'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">'spouse'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Rui'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">'children'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Chen You'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Ruo Xi'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> yaml </tag>
            
            <tag> 配置文件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python日期转换</title>
      <link href="2021/04/09/python-ri-qi-zhuan-huan/"/>
      <url>2021/04/09/python-ri-qi-zhuan-huan/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Python日期转换、datetime模块和time模块的使用</p></blockquote><span id="more"></span><h3 id="Datetime-模块"><a href="#Datetime-模块" class="headerlink" title="Datetime 模块"></a>Datetime 模块</h3><blockquote><p>datetime是Python处理日期和时间的标准库。</p></blockquote><h4 id="获取utc时间"><a href="#获取utc时间" class="headerlink" title="获取utc时间"></a>获取utc时间</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetimeutc_now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span>utc_now_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取年月日</span>utc_now_utctimetuple <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>utctimetuple<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取utc时间戳</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">08</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">23.513941</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">></span> time<span class="token punctuation">.</span>struct_time<span class="token punctuation">(</span>tm_year<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span> tm_mon<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> tm_mday<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> tm_hour<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> tm_min<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> tm_sec<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">,</span> tm_wday<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> tm_yday<span class="token operator">=</span><span class="token number">99</span><span class="token punctuation">,</span> tm_isdst<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="将datetime格式转换成字符串"><a href="#将datetime格式转换成字符串" class="headerlink" title="将datetime格式转换成字符串"></a>将datetime格式转换成字符串</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetime<span class="token comment"># datetime.datetime(year, month, day, hour,minute, second）microsecond)</span>d0 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>d0_str <span class="token operator">=</span> d0<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="将字符串转换为datetime格式"><a href="#将字符串转换为datetime格式" class="headerlink" title="将字符串转换为datetime格式"></a>将字符串转换为datetime格式</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetimed1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2021-4-3 17:10:20'</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="求时间差"><a href="#求时间差" class="headerlink" title="求时间差"></a>求时间差</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetimed1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>d0 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span>   day_difference <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token operator">-</span>d0<span class="token punctuation">)</span><span class="token punctuation">.</span>days <span class="token comment"># 4月份共30天 相差9天(不包括5月8日)</span>second_difference <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token operator">-</span>d0<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 计算相差秒数</span><span class="token operator">></span> <span class="token number">9</span><span class="token operator">></span> <span class="token number">777600.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="日期加减"><a href="#日期加减" class="headerlink" title="日期加减"></a>日期加减</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetime<span class="token comment"># timedelta 入参可选(days: float = ..., seconds: float = ..., microseconds: float = ...,milliseconds: float = ..., minutes: float = ..., hours: float = ...,weeks: float = ...)</span>d0 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>next_day <span class="token operator">=</span> d0 <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">05</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="转换为unix时间戳"><a href="#转换为unix时间戳" class="headerlink" title="转换为unix时间戳"></a>转换为unix时间戳</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">import</span> datetimed0 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>ans_time <span class="token operator">=</span> time<span class="token punctuation">.</span>mktime<span class="token punctuation">(</span>d0<span class="token punctuation">.</span>timetuple<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1617441020.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="将unix时间戳转换为datetime"><a href="#将unix时间戳转换为datetime" class="headerlink" title="将unix时间戳转换为datetime"></a>将unix时间戳转换为datetime</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetimedtime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span><span class="token number">1617441020.0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="输出带有utc时区的datime类型"><a href="#输出带有utc时区的datime类型" class="headerlink" title="输出带有utc时区的datime类型"></a>输出带有utc时区的datime类型</h4><pre class="line-numbers language-none"><code class="language-none">import pytzfrom datetime import datetimeutc &#x3D; pytz.utcdef now() -&gt; datetime:    &quot;&quot;&quot;    返回带有utc时区的aware time    &quot;&quot;&quot;    return datetime.utcnow().replace(tzinfo&#x3D;utc)if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    print(now())    print(now().strftime(&#39;%Y-%m-%d %H:%M:%S&#39;))# 输出2019-04-28 04:20:13.259841+00:002019-04-28 04:20:13<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="time-模块"><a href="#time-模块" class="headerlink" title="time 模块"></a>time 模块</h3><blockquote><p>time.time() 返回当前时间的时间戳（1970纪元后经过的浮点秒数，UTC标准时间戳）</p></blockquote><pre class="line-numbers language-none"><code class="language-none">import timeans_time &#x3D; time.time()&gt; 1617957802.867904<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="将时间戳转换成时间字符串"><a href="#将时间戳转换成时间字符串" class="headerlink" title="将时间戳转换成时间字符串"></a>将时间戳转换成时间字符串</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> timetimestamp <span class="token operator">=</span> <span class="token number">1617441020.0</span><span class="token comment"># 将时间戳转换为本地时间字符串</span>time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token comment"># 将时间戳转换为utc时间字符串</span>time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>gmtime<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">03</span> <span class="token number">09</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token comment"># 将当前时间戳转换本地时间为字符串</span>time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>  <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token comment"># 将当前时间戳转换本地时间为字符串 同上</span>time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token comment"># 将当前时间戳转换为UTC时间字符串</span>time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>gmtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">08</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token punctuation">:</span><span class="token number">32</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="日期格式转换"><a href="#日期格式转换" class="headerlink" title="日期格式转换"></a>日期格式转换</h3><p>python中时间日期格式化符号</p><pre class="line-numbers language-none"><code class="language-none">%y 两位数的年份表示（00-99）%Y 四位数的年份表示（000-9999）%m 月份（01-12）%d 月内中的一天（0-31）%H 24小时制小时数（0-23）%I 12小时制小时数（01-12）%M 分钟数（00-59）%S 秒（00-59）%a 本地简化星期名称%A 本地完整星期名称%b 本地简化的月份名称%B 本地完整的月份名称%c 本地相应的日期表示和时间表示%j 年内的一天（001-366）%p 本地A.M.或P.M.的等价符%U 一年中的星期数（00-53）星期天为星期的开始%w 星期（0-6），星期天为 0，星期一为 1，以此类推。%W 一年中的星期数（00-53）星期一为星期的开始%x 本地相应的日期表示%X 本地相应的时间表示%Z 当前时区的名称%% %号本身<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>方法</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">trans_format</span><span class="token punctuation">(</span>time_string<span class="token punctuation">,</span> from_format<span class="token punctuation">,</span> to_format<span class="token operator">=</span><span class="token string">'%Y.%m.%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time_struct <span class="token operator">=</span> time<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>time_string<span class="token punctuation">,</span> from_format<span class="token punctuation">)</span>    times <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>to_format<span class="token punctuation">,</span> time_struct<span class="token punctuation">)</span>    <span class="token keyword">return</span> times<span class="token comment"># 将11 May转为mm-dd形式</span>time_string <span class="token operator">=</span> <span class="token string">"11 May"</span>times <span class="token operator">=</span> trans_format<span class="token punctuation">(</span>time_string<span class="token punctuation">,</span> <span class="token string">'%d %b'</span><span class="token punctuation">,</span> <span class="token string">'%m-%d'</span><span class="token punctuation">)</span>  <span class="token comment"># 由于没有输入年份，所以输出的默认年份是1900</span><span class="token operator">></span> <span class="token number">05</span><span class="token operator">-</span><span class="token number">11</span><span class="token comment"># 将 %m/%d/%Y 转为 %Y-%m-%d 形式</span>time_string2 <span class="token operator">=</span> <span class="token string">"08/26/1988"</span>times2 <span class="token operator">=</span> trans_format<span class="token punctuation">(</span>time_string2<span class="token punctuation">,</span> <span class="token string">'%m/%d/%Y'</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>times2<span class="token punctuation">)</span><span class="token operator">></span> <span class="token number">1988</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="获取两个日期之间的所有日期"><a href="#获取两个日期之间的所有日期" class="headerlink" title="获取两个日期之间的所有日期"></a>获取两个日期之间的所有日期</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta<span class="token keyword">def</span> <span class="token function">get_date_list</span><span class="token punctuation">(</span>start_ymd<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> end_ymd<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    获取日期列表    :param start_ymd: 开始日期 type:datetime or str    :param end_ymd: 结束日期 type:datetime or str    :return:    """</span>    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>start_ymd<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>start_ymd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        start <span class="token operator">=</span> start_ymd    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>end_ymd<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>end_ymd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        end <span class="token operator">=</span> end_ymd    <span class="token keyword">def</span> <span class="token function">gen_dates</span><span class="token punctuation">(</span>b_date<span class="token punctuation">,</span> days<span class="token punctuation">)</span><span class="token punctuation">:</span>        day <span class="token operator">=</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>days<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">yield</span> b_date <span class="token operator">+</span> day <span class="token operator">*</span> i    <span class="token keyword">if</span> start <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> end <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> d <span class="token keyword">in</span> gen_dates<span class="token punctuation">(</span>start<span class="token punctuation">,</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">.</span>days<span class="token punctuation">)</span><span class="token punctuation">:</span>        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span>    end <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>    date_list <span class="token operator">=</span> get_date_list<span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>    date_list <span class="token operator">=</span> get_date_list<span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">20180528</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">20180602</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>date_list<span class="token punctuation">)</span>    <span class="token punctuation">[</span><span class="token string">'20180528'</span><span class="token punctuation">,</span> <span class="token string">'20180529'</span><span class="token punctuation">,</span> <span class="token string">'20180530'</span><span class="token punctuation">,</span> <span class="token string">'20180531'</span><span class="token punctuation">,</span> <span class="token string">'20180601'</span><span class="token punctuation">]</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="封装成类"><a href="#封装成类" class="headerlink" title="封装成类"></a>封装成类</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token triple-quoted-string string">"""日期处理类"""</span><span class="token keyword">import</span> datetime<span class="token keyword">import</span> time<span class="token keyword">class</span> <span class="token class-name">TimeFormat</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">timestamp_2_datetime</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> ans_time<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""将unix时间戳转换为python的datetime"""</span>        <span class="token keyword">return</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>ans_time<span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">timestamp_2_str</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> ans_time<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""将unix时间戳转换为时间字符串"""</span>        <span class="token keyword">return</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>gmtime<span class="token punctuation">(</span>ans_time<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">datetime_2_timestamp</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> d_time<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""将python的datetime转换为unix时间戳"""</span>        <span class="token keyword">return</span> time<span class="token punctuation">.</span>mktime<span class="token punctuation">(</span>d_time<span class="token punctuation">.</span>timetuple<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">datetime_2_str</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> d_time<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""将python的datetime转换为字符串"""</span>        <span class="token keyword">return</span> d_time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    timestamp <span class="token operator">=</span> <span class="token number">1617776979</span>    now_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>utcnow<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>TimeFormat<span class="token punctuation">.</span>timestamp_2_str<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>TimeFormat<span class="token punctuation">.</span>timestamp_2_datetime<span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>TimeFormat<span class="token punctuation">.</span>datetime_2_timestamp<span class="token punctuation">(</span>now_time<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>TimeFormat<span class="token punctuation">.</span>datetime_2_str<span class="token punctuation">(</span>now_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">07</span> <span class="token number">06</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">07</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token operator">></span> <span class="token number">1617930414.0</span><span class="token operator">></span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">09</span> <span class="token number">09</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">54</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="其他时间处理模块"><a href="#其他时间处理模块" class="headerlink" title="其他时间处理模块"></a>其他时间处理模块</h3><ul><li>pytz模块</li><li>dateutil模块</li></ul>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> datetime </tag>
            
            <tag> time </tag>
            
            <tag> 时间戳 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python文件路径</title>
      <link href="2021/04/02/python-wen-jian-lu-jing/"/>
      <url>2021/04/02/python-wen-jian-lu-jing/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-none"><code class="language-none"># -*- coding: utf-8 -*-# @Time    :2018&#x2F;11&#x2F;19 1:16 PM# @Author  : wangqiao# -*- coding: UTF-8 -*-import os.pathimport sysdef print_path():    print(&quot;项目绝对路径 os.path.dirname(os.path.abspath(__file__)):&#123;&#125;&quot;.format(os.path.dirname(os.path.abspath(__file__))))    print(&#39;在原路径上添加路径:&#39;, os.path.join(&#39;&#x2F;home&#x2F;python&#39;, &#39;Desktop&#39;))    print(&#39;文件绝对路径:&#39;, os.path.abspath(sys.argv[0]))    print(&#39;文件当前目录&#39;, os.path.dirname(__file__))    print(        &#39;文件上级目录&#39;,        os.path.abspath(            os.path.join(                os.path.dirname(__file__),                &#39;..&#39;)))    print(        &#39;同级其他目录&#39;,        os.path.abspath(            os.path.join(                os.path.dirname(__file__),                &#39;..&#x2F;database&#39;)))    print(        &#39;文件上上级目录&#39;,        os.path.abspath(            os.path.join(                os.path.dirname(__file__),                &#39;..&#x2F;..&#39;)))    print(        &#39;文件上上上级目录&#39;,        os.path.abspath(            os.path.join(                os.path.dirname(__file__),                &#39;..&#x2F;..&#x2F;..&#39;)))    print(&#39;csv&#39;, os.path.join(os.path.dirname(__file__), &#39;csv&#x2F;app_store&#39;))    print(        &#39;csv&#39;,        os.path.abspath(            os.path.join(                os.path.dirname(__file__),                &#39;csv&#x2F;app_store&#39;)))if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    print_path()    print(os.path.abspath(__file__))    print(os.path.commonpath(os.path.abspath(__file__)))    print(os.path.dirname(os.path.abspath(__file__)).split(&#39;&#x2F;&#39;)[-1])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 文件路径 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitignore文件屏蔽规则</title>
      <link href="2021/03/31/gitignore-wen-jian-ping-bi-gui-ze/"/>
      <url>2021/03/31/gitignore-wen-jian-ping-bi-gui-ze/</url>
      
        <content type="html"><![CDATA[<p>在使用git仓库时，有些特殊文件我们希望能够进行屏蔽，而有些文件我们希望能够保留在版本库中，此时就用到了git的.gitignore 文件。</p><p>在项目根路径创建<code>.gitignore</code>文件</p><h3 id="gitignore-文件规范"><a href="#gitignore-文件规范" class="headerlink" title="gitignore 文件规范"></a>gitignore 文件规范</h3><p><code>.gitignore </code>文件格式规范如下：</p><ul><li>所有空行或#开头的行都会被忽略；</li><li>可以使用标准的 glob 模式匹配；</li><li>文件或目录前加 / 表示仓库根目录的对应文件；</li><li>匹配模式最后跟反斜杠 / 说明要忽略的是目录；</li><li>要特殊不忽略某个文件或目录，可以在模式前加上取反 ! 。</li></ul><p>其中 glob 模式是指 shell 所使用的简化了的正则表达式。</p><ul><li>星号 * 匹配零个或多个任意字符；</li><li>[abc]匹配任何一个列在方括号中的字符（这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）；- - 问号 ? 只匹配一个任意字符；</li><li>如果在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如 [0-9] 表示匹配所有 0 到 9 的数字）。</li></ul><p>下面是一个 <code>.gitignore</code> 文件例子，注释上附录有说明：</p><pre class="line-numbers language-none"><code class="language-none">*.a                 # 所有以 &#39;.a&#39; 为后缀的文件都屏蔽掉# Office 缓存文件~&#39;$&#39;*.docx~&#39;$&#39;*.ppt~&#39;$&#39;*.pptx ~&#39;$&#39;*.xlstags                # 仓库中所有名为 tags 的文件都屏蔽core.*              # 仓库中所有以 &#39;core.&#39; 开头的文件都屏蔽tools&#x2F;              # 屏蔽目录 toolslog&#x2F;*               # 屏蔽目录 log 下的所有文件，但不屏蔽 log 目录本身&#x2F;log.log            # 只屏蔽仓库根目录下的 log.log 文件，其他目录中的不屏蔽readme.md           # 屏蔽仓库中所有名为 readme.md 的文件!&#x2F;readme.md         # 在上一条屏蔽规则的条件下，不屏蔽仓库根目录下的 readme.md 文件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>例子中的最后两条的顺序很重要，必须要先屏蔽所有的，然后才建立特殊不屏蔽的规则！</p><h3 id="在github上创建代码仓库时忘记添加-gitignore文件或修改了-gitignore该怎么办？"><a href="#在github上创建代码仓库时忘记添加-gitignore文件或修改了-gitignore该怎么办？" class="headerlink" title="在github上创建代码仓库时忘记添加.gitignore文件或修改了.gitignore该怎么办？"></a>在<code>github</code>上创建代码仓库时忘记添加<code>.gitignore</code>文件或修改了<code>.gitignore</code>该怎么办？</h3><pre class="line-numbers language-none"><code class="language-none">#清除本地缓存(改变成未track状态)#git rm -r --cached . 表示清除项目中所有文件的本地缓存#xxx表示不想版本控制的文件，比如小编可以输入test.o#.gitignore中的忽略规则应该与之相对应git rm -r --cached xxxgit add .   #添加除了忽略文件外的所有文件git commit -m &quot;此处可以描述你提交的信息&quot;git push -f #强制推送<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> gitignore </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Prometheus入门教程</title>
      <link href="2021/03/31/prometheus-ru-men-jiao-cheng/"/>
      <url>2021/03/31/prometheus-ru-men-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Prometheus 一款优秀的开源监控告警系统</p></blockquote><span id="more"></span><h3 id="Prometheus是什么"><a href="#Prometheus是什么" class="headerlink" title="Prometheus是什么"></a>Prometheus是什么</h3><p>Prometheus 最开始是由 SoundCloud 开发的开源监控告警系统，是 Google BorgMon 监控系统的开源版本。能很好地与容器平台、云平台配合。</p><p>2016年继Kubernetes之后成为第二个正式加入CNCF基金会的项目，随着 Kubernetes 在容器编排领头羊地位的确立，Prometheus 也成为 Kubernetes 容器监控的标配。</p><h4 id="设计架构"><a href="#设计架构" class="headerlink" title="设计架构"></a>设计架构</h4><p>监控系统的总体架构大多是类似的，都有数据采集、数据处理存储、告警动作触发和告警，以及对监控数据的展示。</p><p>下面是 Prometheus 的架构：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Prometheus%E8%AE%BE%E8%AE%A1%E6%9E%B6%E6%9E%84.png" alt="Prometheus设计架构"></p><p>Prometheus Server 负责定时从 Prometheus 采集端 Pull(拉) 监控数据。Prometheus 采集端可以是实现了 /metrics 接口的服务，可以是从第三方服务导出监控数据的 exporter，也可以是存放短生命周期服务监控数据的 Pushgateway。相比大多数采用 Push(推) 监控数据的方式，Pull 使得 Promethues Server 与被采集端的耦合度更低，Prometheus Server 更容易实现水平拓展。</p><p>对于采集的监控数据，Prometheus Server 使用内置时序数据库 TSDB 进行存储。同时也会使用这些监控数据进行告警规则的计算，产生的告警将会通过 Prometheus 另一个独立的组件 Alertmanager 进行发送。Alertmanager 提供了十分灵活的告警方式，并且支持高可用部署。</p><p>对于采集到的监控数据，可以通过 Prometheus 自身提供的 Web UI 进行查询，也可以使用 Grafana 进行展示。</p><h4 id="Prometheus与Influxdb的区别"><a href="#Prometheus与Influxdb的区别" class="headerlink" title="Prometheus与Influxdb的区别"></a>Prometheus与Influxdb的区别</h4><p><strong>prometheus是pull模型，influxdb是push模型。</strong></p><p>prometheus server启动的时候，你需要告诉它你想它监听哪些节点，每次增加或者减少节点，得重启prometheus server的。</p><p>而influxdb则是，每个监控的节点自己配置好influxdb server的地址，向服务端推送数据</p><p>对于Prometheus而言，监控节点不需要知道server在哪里，即使server挂了，对监控节点本身无影响</p><p>相对的，influxdb server如果挂了，那么所有influxdb 节点发送的请求都会出错</p><p>当然，prometheus可以通过push gateway转换成push模型，influxdb可以通过collector转化成pull模型</p><p><strong>influxdb的查询语句是类SQL，prometheus则不是</strong></p><p>Prometheus 是一套完整的监控系统，包括数据采集、数据处理存储、告警动作触发和告警，以及对监控数据的展示(数据展示很烂，官方都推荐使用Grafana)</p><p>influxdb 只是一个数据库</p><h3 id="安装Prometheus"><a href="#安装Prometheus" class="headerlink" title="安装Prometheus"></a>安装Prometheus</h3><p>Prometheus基于Golang编写，编译后的软件包，不依赖于任何的第三方依赖。用户只需要下载对应平台的二进制包，解压并且添加基本的配置即可正常启动Prometheus Server。<a href="https://github.com/prometheus/prometheus">Prometheus-GitHub项目</a></p><p>本文直接从<a href="https://prometheus.io/download/">官网下载</a></p><p><code>从二进制包安装</code>和<code>使用Docker安装</code>请查阅<a href="https://github.com/prometheus/prometheus">Prometheus-GitHub项目</a></p><p>解压，并将Prometheus相关的命令，添加到系统环境变量路径即可</p><p>解压后当前目录会包含默认的Prometheus配置文件promethes.yml</p><pre class="line-numbers language-none"><code class="language-none">➜  prometheus-2.25.2.darwin-amd64 lsLICENSE           console_libraries prometheus        promtoolNOTICE            consoles          prometheus.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Promtheus包含一个时间序列数据库，其采集的数据会以文件的形式存储在本地中，默认的存储路径为data/</p><p>用户也可以通过参数<code>--storage.tsdb.path=&quot;data/&quot;</code>修改本地数据存储的路径</p><h3 id="启动prometheus服务"><a href="#启动prometheus服务" class="headerlink" title="启动prometheus服务"></a>启动prometheus服务</h3><p>其会默认加载当前路径下的prometheus.yaml文件：</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;prometheus <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>正常的情况下，你可以看到以下输出内容：</p><pre class="line-numbers language-none"><code class="language-none">➜  prometheus-2.25.2.darwin-amd64 .&#x2F;prometheuslevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:366 msg&#x3D;&quot;No time or size retention was set so using the default time retention&quot; duration&#x3D;15dlevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:404 msg&#x3D;&quot;Starting Prometheus&quot; version&#x3D;&quot;(version&#x3D;2.25.2, branch&#x3D;HEAD, revision&#x3D;bda05a23ada314a0b9806a362da39b7a1a4e04c3)&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:409 build_context&#x3D;&quot;(go&#x3D;go1.15.10, user&#x3D;root@de38ec01ef10, date&#x3D;20210316-18:16:26)&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:410 host_details&#x3D;(darwin)level&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:411 fd_limits&#x3D;&quot;(soft&#x3D;256, hard&#x3D;unlimited)&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.254Z caller&#x3D;main.go:412 vm_limits&#x3D;&quot;(soft&#x3D;unlimited, hard&#x3D;unlimited)&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.256Z caller&#x3D;web.go:532 component&#x3D;web msg&#x3D;&quot;Start listening for connections&quot; address&#x3D;0.0.0.0:9090level&#x3D;info ts&#x3D;2021-03-31T06:06:48.256Z caller&#x3D;main.go:779 msg&#x3D;&quot;Starting TSDB ...&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.258Z caller&#x3D;tls_config.go:191 component&#x3D;web msg&#x3D;&quot;TLS is disabled.&quot; http2&#x3D;falselevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.260Z caller&#x3D;head.go:668 component&#x3D;tsdb msg&#x3D;&quot;Replaying on-disk memory mappable chunks if any&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.260Z caller&#x3D;head.go:682 component&#x3D;tsdb msg&#x3D;&quot;On-disk memory mappable chunks replay completed&quot; duration&#x3D;6.222µslevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.260Z caller&#x3D;head.go:688 component&#x3D;tsdb msg&#x3D;&quot;Replaying WAL, this may take a while&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.260Z caller&#x3D;head.go:740 component&#x3D;tsdb msg&#x3D;&quot;WAL segment loaded&quot; segment&#x3D;0 maxSegment&#x3D;0level&#x3D;info ts&#x3D;2021-03-31T06:06:48.260Z caller&#x3D;head.go:745 component&#x3D;tsdb msg&#x3D;&quot;WAL replay completed&quot; checkpoint_replay_duration&#x3D;37.072µs wal_replay_duration&#x3D;250.379µs total_replay_duration&#x3D;308.367µslevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.261Z caller&#x3D;main.go:799 fs_type&#x3D;1alevel&#x3D;info ts&#x3D;2021-03-31T06:06:48.261Z caller&#x3D;main.go:802 msg&#x3D;&quot;TSDB started&quot;level&#x3D;info ts&#x3D;2021-03-31T06:06:48.261Z caller&#x3D;main.go:928 msg&#x3D;&quot;Loading configuration file&quot; filename&#x3D;prometheus.ymllevel&#x3D;info ts&#x3D;2021-03-31T06:06:50.775Z caller&#x3D;main.go:959 msg&#x3D;&quot;Completed loading of configuration file&quot; filename&#x3D;prometheus.yml totalDuration&#x3D;2.513709691s remote_storage&#x3D;4.524µs web_handler&#x3D;305ns query_engine&#x3D;721ns scrape&#x3D;2.513249415s scrape_sd&#x3D;80.407µs notify&#x3D;65.766µs notify_sd&#x3D;46.36µs rules&#x3D;9.82µslevel&#x3D;info ts&#x3D;2021-03-31T06:06:50.775Z caller&#x3D;main.go:751 msg&#x3D;&quot;Server is ready to receive web requests.&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="采集数据"><a href="#采集数据" class="headerlink" title="采集数据"></a>采集数据</h4><p>若使用Prometheus默认配置文件启动，由于默认配置文件中已经配置了数据采集节点</p><p>这一步可以跳过，直接看<strong>使用Node Exporter采集主机数据</strong></p><pre class="line-numbers language-none"><code class="language-none">scrape_configs:  # The job name is added as a label &#96;job&#x3D;&lt;job_name&gt;&#96; to any timeseries scraped from this config.  - job_name: &#39;prometheus&#39;    # metrics_path defaults to &#39;&#x2F;metrics&#39;    # scheme defaults to &#39;http&#39;.    static_configs:    - targets: [&#39;localhost:9090&#39;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用<code>metrics</code>接口获取采集数据</p><pre class="line-numbers language-none"><code class="language-none">➜  prometheus-2.25.2.darwin-amd64 curl http:&#x2F;&#x2F;localhost:9090&#x2F;metrics# HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.# TYPE go_gc_duration_seconds summarygo_gc_duration_seconds&#123;quantile&#x3D;&quot;0&quot;&#125; 7.5208e-05go_gc_duration_seconds&#123;quantile&#x3D;&quot;0.25&quot;&#125; 0.000109181go_gc_duration_seconds&#123;quantile&#x3D;&quot;0.5&quot;&#125; 0.000141038go_gc_duration_seconds&#123;quantile&#x3D;&quot;0.75&quot;&#125; 0.000168269go_gc_duration_seconds&#123;quantile&#x3D;&quot;1&quot;&#125; 0.00025607go_gc_duration_seconds_sum 0.008501346go_gc_duration_seconds_count 61# HELP go_goroutines Number of goroutines that currently exist.# TYPE go_goroutines gauge<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>启动完成后，可以通过<a href="http://localhost:9090/">http://localhost:9090</a>访问Prometheus的UI界面：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/O6L7Sd.png" alt="Prometheus"></p><h3 id="使用Node-Exporter采集主机数据"><a href="#使用Node-Exporter采集主机数据" class="headerlink" title="使用Node Exporter采集主机数据"></a>使用Node Exporter采集主机数据</h3><h4 id="安装Node-Exporter"><a href="#安装Node-Exporter" class="headerlink" title="安装Node Exporter"></a>安装Node Exporter</h4><p>在Prometheus的架构设计中，Prometheus Server并不直接服务监控特定的目标，其主要任务负责数据的收集，存储并且对外提供数据查询支持。因此为了能够能够监控到某些东西，如主机的CPU使用率，我们需要使用到Exporter。Prometheus周期性的从Exporter暴露的HTTP服务地址（通常是/metrics）拉取监控样本数据。</p><p>从上面的描述中可以看出Exporter可以是一个相对开放的概念，其可以是一个独立运行的程序独立于监控目标以外，也可以是直接内置在监控目标中。只要能够向Prometheus提供标准格式的监控样本数据即可。</p><p>这里为了能够采集到主机的运行指标如CPU, 内存，磁盘等信息。我们可以使用<a href="https://github.com/prometheus/node_exporter">Node Exporter</a>。</p><p>Node Exporter同样采用Golang编写，并且不存在任何的第三方依赖，只需要下载，解压即可运行。</p><p>本文直接从<a href="https://prometheus.io/download/">官网下载</a></p><h4 id="启动Exporter"><a href="#启动Exporter" class="headerlink" title="启动Exporter"></a>启动Exporter</h4><p>解压，进入目录执行</p><pre class="line-numbers language-none"><code class="language-none">➜  node_exporter-1.1.2.darwin-amd64 lsLICENSE       NOTICE        node_exporter➜  node_exporter-1.1.2.darwin-amd64 .&#x2F;node_exporter<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>访问<a href="http://localhost:9100/">http://localhost:9100/</a>可以看到以下页面<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/VFogux.png" alt="http://localhost:9100/"></p><h3 id="监控数据可视化"><a href="#监控数据可视化" class="headerlink" title="监控数据可视化"></a>监控数据可视化</h3><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://juejin.cn/post/6844903938001469453">Prometheus入门实践</a></li><li><a href="https://yunlzheng.gitbook.io/prometheus-book/">Prometheus-book</a></li><li><a href="https://opensource.actionsky.com/20200427-prometheus/">第01期：详解 Prometheus 专栏开篇</a></li><li><a href="https://www.jianshu.com/p/6cc9a5046f17">Prometheus数据采集</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 数据库 </tag>
            
            <tag> 监控 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker使用手册</title>
      <link href="2021/03/26/docker-shi-yong-shou-ce/"/>
      <url>2021/03/26/docker-shi-yong-shou-ce/</url>
      
        <content type="html"><![CDATA[<h3 id="利用-Dockerfile-来创建镜像"><a href="#利用-Dockerfile-来创建镜像" class="headerlink" title="利用 Dockerfile 来创建镜像"></a>利用 Dockerfile 来创建镜像</h3><p>使用 <code>docker commit</code> 来扩展一个镜像比较简单，但是不方便在一个团队中分享。我们可以使用 <code>docker build</code>来创建一个新的镜像。为此，首先需要创建一个 <code>Dockerfile</code>，包含一些如何创建镜像的指令。</p><p>新建一个目录和一个 <code>Dockerfile</code></p><pre class="line-numbers language-none"><code class="language-none">$ mkdir sinatra$ cd sinatra$ touch Dockerfile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Dockerfile 中每一条指令都创建镜像的一层，例如：</p><pre class="line-numbers language-none"><code class="language-none"># This is a commentFROM ubuntu:20.04.2MAINTAINER Docker Newbee &lt;newbee@docker.com&gt;RUN apt-get -qq updateRUN apt-get -qqy install ruby ruby-devRUN gem install sinatra<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Dockerfile-基本的语法"><a href="#Dockerfile-基本的语法" class="headerlink" title="Dockerfile 基本的语法"></a>Dockerfile <a href="http://www.dockerinfo.net/dockerfile%e4%bb%8b%e7%bb%8d">基本的语法</a></h4><ul><li>使用<code>#</code>来注释</li><li><code>FROM</code> 指令告诉 <code>Docker</code> 使用哪个镜像作为基础</li><li>接着是维护者的信息</li><li><code>RUN</code>开头的指令会在创建中运行，比如安装一个软件包，在这里使用 <code>apt-get</code> 来安装了一些软件<br>编写完成 <code>Dockerfile</code> 后可以使用 <code>docker build</code> 来生成镜像。<pre class="line-numbers language-none"><code class="language-none"># docker build -t&#x3D;&quot;仓库名:tag&quot; .sudo docker build -t&#x3D;&quot;ouruser&#x2F;sinatra:v2&quot; .➜  sinatra docker build -t&#x3D;&quot;ouruser&#x2F;sinatra:v2&quot; .[+] Building 432.0s (8&#x2F;8) FINISHED &#x3D;&gt; [internal] load build definition from Dockerfile                                                                                                                0.0s &#x3D;&gt; &#x3D;&gt; transferring dockerfile: 215B                                                                                                                                0.0s &#x3D;&gt; [internal] load .dockerignore                                                                                                                                   0.0s &#x3D;&gt; &#x3D;&gt; transferring context: 2B                                                                                                                                     0.0s &#x3D;&gt; [internal] load metadata for docker.io&#x2F;library&#x2F;ubuntu:20.04.2                                                                                                   0.0s &#x3D;&gt; [1&#x2F;4] FROM docker.io&#x2F;library&#x2F;ubuntu:20.04.2                                                                                                                     0.0s &#x3D;&gt; [2&#x2F;4] RUN apt-get -qq update                                                                                                                                   33.8s &#x3D;&gt; [3&#x2F;4] RUN apt-get -qqy install ruby ruby-dev                                                                                                                   68.3s &#x3D;&gt; [4&#x2F;4] RUN gem install sinatra                                                                                                                                 327.8s &#x3D;&gt; exporting to image                                                                                                                                              1.9s &#x3D;&gt; &#x3D;&gt; exporting layers                                                                                                                                             1.9s &#x3D;&gt; &#x3D;&gt; writing image sha256:32d826e013b38ee6a8d80fac491e9f39a59028252bf0aeeffb70db25bcd4a1c4                                                                        0.0s &#x3D;&gt; &#x3D;&gt; naming to docker.io&#x2F;ouruser&#x2F;sinatra:v2                    ➜  sinatra docker imagesREPOSITORY           TAG       IMAGE ID       CREATED         SIZEouruser&#x2F;sinatra      v2        32d826e013b3   2 minutes ago   160MBubuntu               20.04.2   8e428cff54c8   4 hours ago     72.9MB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>其中 -t 标记来添加 tag，指定新的镜像的用户信息。 “.” 是 Dockerfile 所在的路径（当前目录），也可以替换为一个具体的 Dockerfile 的路径。</li></ul><p>可以看到 build 进程在执行操作。它要做的第一件事情就是上传这个 Dockerfile 内容，因为所有的操作都要依据 Dockerfile 来进行。 然后，Dockfile 中的指令被一条一条的执行。每一步都创建了一个新的容器，在容器中执行指令并提交修改（就跟之前介绍过的 docker commit 一样）。当所有的指令都执行完毕之后，返回了最终的镜像 id。所有的中间步骤所产生的容器都被删除和清理了。</p><p>*注意一个镜像不能超过 127 层</p><p>此外，还可以利用 ADD 命令复制本地文件到镜像；用 EXPOSE 命令来向外部开放端口；用 CMD 命令来描述容器启动后运行的程序等。例如</p><pre class="line-numbers language-none"><code class="language-none"># put my local web site in myApp folder to &#x2F;var&#x2F;wwwADD myApp &#x2F;var&#x2F;www# expose httpd portEXPOSE 80# the command to runCMD [&quot;&#x2F;usr&#x2F;sbin&#x2F;apachectl&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="其他配置示例"><a href="#其他配置示例" class="headerlink" title="其他配置示例"></a>其他配置示例</h4><pre class="line-numbers language-none"><code class="language-none">FROM python:3.7-alpine # WORKDIR 工作路径WORKDIR &#x2F;app# COPY 复制文件COPY requirements.txt &#x2F;app# RUN 执行命令RUN pip3 install -r requirements.txt --no-cache-dirCOPY . &#x2F;app ENTRYPOINT [&quot;python3&quot;] # CMD [&quot;app.py&quot;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="docker-run-常用参数"><a href="#docker-run-常用参数" class="headerlink" title="docker run 常用参数"></a>docker run 常用参数</h3><pre class="line-numbers language-none"><code class="language-none">-i以交互模式运行容器，通常与 -t 同时使用；-t为容器重新分配一个伪输入终端，通常与 -i 同时使用；-d后台运行容器，并返回容器ID；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.docker.org.cn/book/docker/what-is-docker-16.html">Docker入门教程</a></li><li><a href="http://www.dockerinfo.net/document">Docker中文文档</a></li><li><a href="https://hujb2000.gitbooks.io/docker-flow-evolution/content/cn/index.html">Docker入门与实践</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker命令大全</title>
      <link href="2021/03/26/docker-ming-ling-da-quan/"/>
      <url>2021/03/26/docker-ming-ling-da-quan/</url>
      
        <content type="html"><![CDATA[<h3 id="容器生命周期管理"><a href="#容器生命周期管理" class="headerlink" title="容器生命周期管理"></a>容器生命周期管理</h3><h4 id="run"><a href="#run" class="headerlink" title="run"></a>run</h4><h4 id="start-stop-restart"><a href="#start-stop-restart" class="headerlink" title="start/stop/restart"></a>start/stop/restart</h4><h4 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h4><h4 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h4><h4 id="pause-unpause"><a href="#pause-unpause" class="headerlink" title="pause/unpause"></a>pause/unpause</h4><h4 id="create"><a href="#create" class="headerlink" title="create"></a>create</h4><h4 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h4><h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><ul><li>ps</li><li>inspect</li><li>top</li><li>attach</li><li>events</li><li>logs</li><li>wait</li><li>export</li><li>port<h3 id="容器rootfs命令"><a href="#容器rootfs命令" class="headerlink" title="容器rootfs命令"></a>容器rootfs命令</h3></li><li>commit</li><li>cp</li><li>diff<h3 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h3></li><li>login</li><li>pull</li><li>push</li><li>search<h3 id="本地镜像管理"><a href="#本地镜像管理" class="headerlink" title="本地镜像管理"></a>本地镜像管理</h3></li><li>images</li><li>rmi</li><li>tag</li><li>build</li><li>history</li><li>save</li><li>load</li><li>import</li><li>info|version</li><li>info</li><li>version</li></ul><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><h4 id="docker镜像列表存在但删除显示-No-such-image问题解决"><a href="#docker镜像列表存在但删除显示-No-such-image问题解决" class="headerlink" title="docker镜像列表存在但删除显示 No such image问题解决"></a>docker镜像列表存在但删除显示 No such image问题解决</h4><ol><li>停掉容器（docker stop 容器ID或容器名称）</li><li>删除容器（docker rm 容器ID或容器名称）</li><li>删除镜像（docker rmi 镜像ID或镜像名称:版本号）</li></ol><h4 id="docker-run-启动容器"><a href="#docker-run-启动容器" class="headerlink" title="docker run 启动容器"></a>docker run 启动容器</h4><pre class="line-numbers language-none"><code class="language-none">-i以交互模式运行容器，通常与 -t 同时使用；-t为容器重新分配一个伪输入终端，通常与 -i 同时使用；-d后台运行容器，并返回容器ID；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.runoob.com/docker/docker-command-manual.html">Docker 命令大全</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker入门手册</title>
      <link href="2021/03/25/docker-ru-men-shou-ce/"/>
      <url>2021/03/25/docker-ru-men-shou-ce/</url>
      
        <content type="html"><![CDATA[<blockquote><p>原文发布在docker中文论坛上，归纳整理一遍</p></blockquote><h3 id="docker-快速入门"><a href="#docker-快速入门" class="headerlink" title="docker 快速入门"></a>docker 快速入门</h3><h4 id="什么是Docker"><a href="#什么是Docker" class="headerlink" title="什么是Docker?"></a>什么是Docker?</h4><blockquote><p>简介：Docker是一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、bare metal、OpenStack 集群和其他的基础应用平台。</p></blockquote><p>Docker是一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、 bare metal、OpenStack 集群和其他的基础应用平台。 </p><p>Docker通常用于如下场景：</p><ul><li>web应用的自动化打包和发布；</li><li>自动化测试和持续集成、发布；</li><li>在服务型环境中部署和调整数据库或其他的后台应用；</li><li>从头编译或者扩展现有的OpenShift或Cloud</li><li>Foundry平台来搭建自己的PaaS环境。</li></ul><h4 id="2-关于docker入门教程"><a href="#2-关于docker入门教程" class="headerlink" title="2.关于docker入门教程"></a>2.关于docker入门教程</h4><p>docker入门教程翻译自docker官方网站的Docker getting started 教程，官方网站： <a href="https://docs.docker.com/linux/started/">https://docs.docker.com/linux/started/</a></p><p>官方网站是一个交互的教程，在左侧是相应的说明，右侧是一个交互的终端，输入预期的目录，可以跳到下一步，大家可以参考我们的翻译，在官网上面运行相应的命令，以验证效果。</p><h4 id="3-准备"><a href="#3-准备" class="headerlink" title="3.准备"></a>3.准备</h4><blockquote><p>简介：Docker系统有两个程序：docker服务端和docker客户端。其中docker服务端是一个服务进程，管理着所有的容器。</p></blockquote><p>准备开始</p><p>Docker系统有两个程序：docker服务端和docker客户端。其中docker服务端是一个服务进程，管理着所有的容器。docker客户端则扮演着docker服务端的远程控制器，可以用来控制docker的服务端进程。大部分情况下，docker服务端和客户端运行在一台机器上。</p><p>目标：</p><p>检查docker的版本，这样可以用来确认docker服务在运行并可通过客户端链接。</p><p>提示：</p><ul><li>可以通过在终端输入docker命令来查看所有的参数。</li><li>官网的在线模拟器只提供了有限的命令，无法保证所有的命令可以正确执行。</li></ul><p>正确的命令：<code>docker version</code></p><pre class="line-numbers language-none"><code class="language-none">✗ docker versionClient: Docker Engine - Community Cloud integration: 1.0.9 Version:           20.10.5 API version:       1.41 Go version:        go1.13.15 Git commit:        55c4c88 Built:             Tue Mar  2 20:13:00 2021 OS&#x2F;Arch:           darwin&#x2F;amd64 Context:           default Experimental:      trueServer: Docker Engine - Community Engine:  Version:          20.10.5  API version:      1.41 (minimum version 1.12)  Go version:       go1.13.15  Git commit:       363e9a8  Built:            Tue Mar  2 20:15:47 2021  OS&#x2F;Arch:          linux&#x2F;amd64  Experimental:     true containerd:  Version:          1.4.3  GitCommit:        269548fa27e0089a8b8278fc4fc781d7f65a939b runc:  Version:          1.0.0-rc92  GitCommit:        ff819c7e9184c13b7c2607fe6c30ae19403a7aff docker-init:  Version:          0.19.0  GitCommit:        de40ad0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-搜索可用docker镜像"><a href="#4-搜索可用docker镜像" class="headerlink" title="4.搜索可用docker镜像"></a>4.搜索可用docker镜像</h4><blockquote><p>简介：这一步的目标是学会使用docker search命令来检索可用镜像。</p></blockquote><p>搜索可用的docker镜像</p><p>使用docker最简单的方式莫过于从现有的容器镜像开始。Docker官方网站专门有一个页面来存储所有可用的镜像，网址是： index.docker.io。你可以通过浏览这个网页来查找你想要使用的镜像，或者使用命令行的工具来检索。</p><p>目标：</p><p>学会使用命令行的工具来检索名字叫做tutorial的镜像。</p><p>提示：</p><p>命令行的格式为：docker search 镜像名字</p><p>正确的命令：<code>docker search tutorial</code></p><pre class="line-numbers language-none"><code class="language-none"> ✗ docker search tutorialNAME                                             DESCRIPTION                                     STARS     OFFICIAL   AUTOMATEDlearn&#x2F;tutorial                                                                                   42fiware&#x2F;tutorials.tourguide-app                   FIWARE Tour Guide App sample application        2                    [OK]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-下载容器镜像"><a href="#5-下载容器镜像" class="headerlink" title="5.下载容器镜像"></a>5.下载容器镜像</h4><blockquote><p>简介：学会使用docker pull命令下载一个镜像。</p></blockquote><p>学会使用docker命令来下载镜像</p><p>下载镜像的命令非常简单，使用docker pull命令即可。(译者按：docker命令和git有一些类似的地方）。在docker的镜像索引网站上面，镜像都是按照 <strong>用户名/ 镜像名</strong>的方式来存储的。有一组比较特殊的镜像，比如ubuntu这类基础镜像，经过官方的验证，值得信任，可以直接用 <strong>镜像名</strong>来检索到。</p><p>目标：</p><p>通过docker命令下载tutorial镜像。</p><p>提示：</p><p>执行pull命令的时候要写完整的名字，比如”learn/tutorial”。</p><p>正确的命令：<code>docker pull learn/tutorial</code></p><h4 id="6-在docker容器中运行hello-world"><a href="#6-在docker容器中运行hello-world" class="headerlink" title="6.在docker容器中运行hello world!"></a>6.在docker容器中运行hello world!</h4><blockquote><p>简介：通过docker run命令可以启动某一个镜像，并运行一个命令。</p></blockquote><p>在docker容器中运行hello world!</p><p>docker容器可以理解为在沙盒中运行的进程。这个沙盒包含了该进程运行所必须的资源，包括文件系统、系统类库、shell 环境等等。但这个沙盒默认是不会运行任何程序的。你需要在沙盒中运行一个进程来启动某一个容器。这个进程是该容器的唯一进程，所以当该进程结束的时候，容器也会完全的停止。</p><p>目标：</p><p>在我们刚刚下载的镜像中输出”hello word”。为了达到这个目的，我们需要在这个容器中运行”echo”命令，输出”hello word”。</p><p>提示：</p><p>docker run命令有两个参数，一个是镜像名，一个是要在镜像中运行的命令。</p><p>正确的命令：<code>docker run learn/tutorial echo &quot;hello word&quot;</code></p><pre class="line-numbers language-none"><code class="language-none"> ✗ docker run learn&#x2F;tutorial echo &quot;hello word&quot;WARNING: The requested image&#39;s platform (unknown) does not match the detected host platform (linux&#x2F;amd64) and no specific platform was requestedhello word<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="7-在容器中安装新的程序"><a href="#7-在容器中安装新的程序" class="headerlink" title="7.在容器中安装新的程序"></a>7.在容器中安装新的程序</h4><blockquote><p>简介：在docker容器中安装新的程序。</p></blockquote><p>在容器中安装新的程序</p><p>下一步我们要做的事情是在容器里面安装一个简单的程序(ping)。我们之前下载的tutorial镜像是基于ubuntu的，所以你可以使用ubuntu的apt-get命令来安装ping程序： apt-get install -y ping。</p><p>备注：apt-get 命令执行完毕之后，容器就会停止，但对容器的改动不会丢失。</p><p>目标：</p><p>在learn/tutorial镜像里面安装ping程序。</p><p>提示：</p><p>在执行apt-get 命令的时候，要带上-y参数。如果不指定-y参数的话，apt-get命令会进入交互模式，需要用户输入命令来进行确认，但在docker环境中是无法响应这种交互的。</p><p>正确的命令：<code>docker run learn/tutorial apt-get install -y ping</code></p><h4 id="8-保存对容器的修改"><a href="#8-保存对容器的修改" class="headerlink" title="8.保存对容器的修改"></a>8.保存对容器的修改</h4><blockquote><p>简介：通过docker commit命令保存对容器的修改</p></blockquote><p>保存对容器的修改</p><p>当你对某一个容器做了修改之后（通过在容器中运行某一个命令），可以把对容器的修改保存下来，这样下次可以从保存后的最新状态运行该容器。docker中保存状态的过程称之为committing，它保存的新旧状态之间的区别，从而产生一个新的版本。</p><p>目标：</p><p>首先使用 docker ps -l命令获得安装完ping命令之后容器的id。然后把这个镜像保存为learn/ping。</p><p>提示：</p><ol><li>运行docker commit，可以查看该命令的参数列表。</li><li>你需要指定要提交保存容器的ID。(译者按：通过docker ps -l 命令获得)</li><li>无需拷贝完整的id，通常来讲最开始的三至四个字母即可区分。（译者按：非常类似git里面的版本号)</li></ol><p>正确的命令：<br>$ docker commit 46e learn/ping</p><pre class="line-numbers language-none"><code class="language-none"> ✗ docker ps -lCONTAINER ID   IMAGE            COMMAND                  CREATED              STATUS                          PORTS     NAMES46e2ce790513   learn&#x2F;tutorial   &quot;apt-get install -y …&quot;   About a minute ago   Exited (0) About a minute ago             flamboyant_ramanujan✗ docker commit 46e learn&#x2F;pingsha256:968d45d2b4f4fa2dc9a52ee01ce420b08b3efe676fd17787735bc5c18143c41f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>执行完docker commit命令之后，会返回sha256。</p><h4 id="9-运行新的镜像"><a href="#9-运行新的镜像" class="headerlink" title="9.运行新的镜像"></a>9.运行新的镜像</h4><blockquote><p>简介：对一个镜像提交修改之后，就可以运行它里面新安装的命令了。</p></blockquote><p>运行新的镜像</p><p>ok，到现在为止，你已经建立了一个完整的、自成体系的docker环境，并且安装了ping命令在里面。它可以在任何支持docker环境的系统中运行啦！(译者按：是不是很神奇呢？)让我们来体验一下吧！</p><p>目标：</p><p>在新的镜像中运行ping <a href="http://www.google.com命令./">www.google.com命令。</a></p><p>提示：</p><p>一定要使用新的镜像名 learn/ping来运行ping命令。(译者按：最开始下载的learn/tutorial镜像中是没有ping命令的)</p><p>正确的命令：<br>$ docker run lean/ping ping <a href="http://www.google.com/">www.google.com</a></p><h4 id="10-检查运行中的镜像"><a href="#10-检查运行中的镜像" class="headerlink" title="10.检查运行中的镜像"></a>10.检查运行中的镜像</h4><blockquote><p>简介：使用docker ps命令可以查看所有正在运行中的容器列表，使用docker inspect命令我们可以查看更详细的关于某一个容器的信息。</p></blockquote><p>检查运行中的镜像</p><p>现在你已经运行了一个docker容器，让我们来看下正在运行的容器。</p><p>使用 docker ps命令可以查看所有正在运行中的容器列表，使用 docker inspect命令我们可以查看更详细的关于某一个容器的信息。</p><p>目标：</p><p>查找某一个运行中容器的id，然后使用docker inspect命令查看容器的信息。</p><p>提示：</p><p>可以使用镜像id的前面部分，不需要完整的id。</p><p>正确的命令：</p><pre class="line-numbers language-none"><code class="language-none">$ docker inspect efe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="11-发布自己的镜像"><a href="#11-发布自己的镜像" class="headerlink" title="11.发布自己的镜像"></a>11.发布自己的镜像</h4><blockquote><p>简介：我们也可以把我们自己编译的镜像发布到索引页面，一方面可以自己重用，另一方面也可以分享给其他人使用。</p></blockquote><p>发布docker镜像</p><p>现在我们已经验证了新镜像可以正常工作，下一步我们可以将其发布到官方的索引网站。还记得我们最开始下载的learn/tutorial镜像吧，我们也可以把我们自己编译的镜像发布到索引页面，一方面可以自己重用，另一方面也可以分享给其他人使用。</p><p>目标：</p><p>把learn/ping镜像发布到docker的index网站。</p><p>提示：<br>1.docker images命令可以列出所有安装过的镜像。<br>2.docker push命令可以将某一个镜像发布到官方网站。<br>3.你只能将镜像发布到自己的空间下面。这个模拟器登录的是learn帐号。</p><p>预期的命令：</p><pre class="line-numbers language-none"><code class="language-none">$ docker push learn&#x2F;ping<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="12-知识点整理"><a href="#12-知识点整理" class="headerlink" title="12.知识点整理"></a>12.知识点整理</h4><pre class="line-numbers language-none"><code class="language-none"># 查看docker版本docker version# 搜索可用docker镜像$ docker search tutorial# 下载容器镜像$ docker pull learn&#x2F;tutorial# 在docker容器中运行hello world!$ docker run learn&#x2F;tutorial echo &quot;hello word&quot;# 在容器中安装新的程序$ docker run learn&#x2F;tutorial apt-get install -y ping# 查看被修改的容器 ：$ docker ps -l#提交指定容器保存为新的镜像： $ docker commit &lt;container id&gt; &lt;new image name&gt;# 显示本地已有的镜像docker images# 使用下载的镜像启动容器$ sudo docker run -t -i training&#x2F;sinatra &#x2F;bin&#x2F;bash# 检查运行中的镜像$ docker inspect efe# 发布自己的镜像$ $ docker push learn&#x2F;ping<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.docker.org.cn/book/docker/what-is-docker-16.html">Docker入门教程</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker部署flask服务</title>
      <link href="2021/03/25/docker-bu-shu-flask-fu-wu/"/>
      <url>2021/03/25/docker-bu-shu-flask-fu-wu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>docker部署flask服务示例</p></blockquote><span id="more"></span><p>首先推荐阅读Flask 官方文档<a href="https://dormousehole.readthedocs.io/en/latest/">欢迎来到 Flask 的世界</a>快速了解Flask架构</p><h3 id="快速搭建一个flask服务"><a href="#快速搭建一个flask服务" class="headerlink" title="快速搭建一个flask服务"></a>快速搭建一个flask服务</h3><p>一个最小的应用</p><pre class="line-numbers language-none"><code class="language-none">from flask import Flaskapp &#x3D; Flask(__name__)@app.route(&#39;&#x2F;&#39;)def hello():return &quot;Hello World!&quot;if __name__ &#x3D;&#x3D; &#39;__main__&#39;:app.run(host&#x3D;&#39;0.0.0.0&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行demo</p><pre class="line-numbers language-none"><code class="language-none">$ export FLASK_APP&#x3D;app.py$ flask run * Running on http:&#x2F;&#x2F;127.0.0.1:5000&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>或者<code>python -m flask</code></p><pre class="line-numbers language-none"><code class="language-none">$ export FLASK_APP&#x3D;app.py$ python -m flask run * Running on http:&#x2F;&#x2F;127.0.0.1:5000&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>或者</p><pre class="line-numbers language-none"><code class="language-none">✗ python3 app.py * Serving Flask app &quot;app&quot; (lazy loading) * Environment: production   WARNING: This is a development server. Do not use it in a production deployment.   Use a production WSGI server instead. * Debug mode: off * Running on http:&#x2F;&#x2F;0.0.0.0:5000&#x2F; (Press CTRL+C to quit)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>外部可见的服务器</p><pre class="line-numbers language-none"><code class="language-none">flask run --host&#x3D;0.0.0.0  # 可以让服务器被公开访问<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>调试模式</p><pre class="line-numbers language-none"><code class="language-none"># 如果需要打开所有开发功能（包括调试模式），那么要在运行服务器之前导出 FLASK_ENV 环境变量并把其设置为 development$ export FLASK_ENV&#x3D;development$ flask run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="项目文件"><a href="#项目文件" class="headerlink" title="项目文件"></a>项目文件</h3><p><a href="https://github.com/docker/awesome-compose/tree/master/flask">代码示例下载</a></p><pre class="line-numbers language-none"><code class="language-none">.├── README.md├── app│   ├── Dockerfile│   ├── app.py│   └── requirements.txt└── docker-compose.yaml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="docker-部署服务"><a href="#docker-部署服务" class="headerlink" title="docker 部署服务"></a>docker 部署服务</h3><pre class="line-numbers language-none"><code class="language-none"> ✗ cd flask-demo&#x2F;app ✗ docker build -t&#x3D;&quot;flask-demo:v1&quot; .[+] Building 26.3s (11&#x2F;11) FINISHED &#x3D;&gt; [internal] load build definition from Dockerfile                                                                                                                0.0s &#x3D;&gt; &#x3D;&gt; transferring dockerfile: 296B                                                                                                                                0.0s &#x3D;&gt; [internal] load .dockerignore                                                                                                                                   0.0s &#x3D;&gt; &#x3D;&gt; transferring context: 2B                                                                                                                                     0.0s &#x3D;&gt; [internal] load metadata for docker.io&#x2F;library&#x2F;python:3.7-alpine                                                                                               26.1s &#x3D;&gt; [auth] library&#x2F;python:pull token for registry-1.docker.io                                                                                                       0.0s &#x3D;&gt; [internal] load build context                                                                                                                                   0.0s &#x3D;&gt; &#x3D;&gt; transferring context: 697B                                                                                                                                   0.0s &#x3D;&gt; [1&#x2F;5] FROM docker.io&#x2F;library&#x2F;python:3.7-alpine@sha256:39ad96c8188f69d513ded616433396a9ab90e061ca85d8eacf6514fa27ec3d40                                          0.0s &#x3D;&gt; &#x3D;&gt; resolve docker.io&#x2F;library&#x2F;python:3.7-alpine@sha256:39ad96c8188f69d513ded616433396a9ab90e061ca85d8eacf6514fa27ec3d40                                          0.0s &#x3D;&gt; CACHED [2&#x2F;5] WORKDIR &#x2F;app                                                                                                                                       0.0s &#x3D;&gt; CACHED [3&#x2F;5] COPY requirements.txt &#x2F;app                                                                                                                         0.0s &#x3D;&gt; CACHED [4&#x2F;5] RUN pip3 install -r requirements.txt --no-cache-dir                                                                                                0.0s &#x3D;&gt; [5&#x2F;5] COPY . &#x2F;app                                                                                                                                               0.1s &#x3D;&gt; exporting to image                                                                                                                                              0.0s &#x3D;&gt; &#x3D;&gt; exporting layers                                                                                                                                             0.0s &#x3D;&gt; &#x3D;&gt; writing image sha256:9fc116d3008819bf171b4cb2a10957e842b77aa24bde2582d737040cd6f9eaec                                                                        0.0s &#x3D;&gt; &#x3D;&gt; naming to docker.io&#x2F;library&#x2F;flask-demo:v1   ✗ docker imagesREPOSITORY           TAG       IMAGE ID       CREATED         SIZEflask-demo           v1        9fc116d30088   3 minutes ago   51.6MB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>启动容器</p><ul><li><code>-p </code>指定端口映射，格式为：主机(宿主)端口:容器端口</li><li><code>-d</code>: 后台运行容器，并返回容器ID；</li><li><code>-i</code>: 以交互模式运行容器，通常与 -t 同时使用；</li><li><code>-P</code>: 随机端口映射，容器内部端口随机映射到主机的端口</li><li><code>-p</code>: 指定端口映射，格式为：主机(宿主)端口:容器端口</li><li><code>-t</code>: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；<pre class="line-numbers language-none"><code class="language-none">✗ docker run -d -p 5000:5000 flask-demo:v1* Serving Flask app &quot;app&quot; (lazy loading)* Environment: production  WARNING: This is a development server. Do not use it in a production deployment.  Use a production WSGI server instead.* Debug mode: off* Running on http:&#x2F;&#x2F;0.0.0.0:5000&#x2F; (Press CTRL+C to quit)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/r1MVwF.png" alt="hello world"></li></ul><p>打开浏览器输入<a href="localhost:5000">localhost:5000</a></p><p>关闭容器</p><pre class="line-numbers language-none"><code class="language-none">✗ docker psCONTAINER ID   IMAGE           COMMAND            CREATED              STATUS          PORTS                    NAMES8c87f5f494b8   flask-demo:v1   &quot;python3 app.py&quot;   About a minute ago   Up 10 seconds   0.0.0.0:5000-&gt;5000&#x2F;tcp   nervous_bassi(venv) ➜  app git:(main) ✗ docker stop 8c87f5f494b88c87f5f494b8(venv) ➜  app git:(main) ✗ docker start 8c87f5f494b88c87f5f494b8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="docker-compose-部署服务"><a href="#docker-compose-部署服务" class="headerlink" title="docker-compose 部署服务"></a><a href="http://www.dockerinfo.net/docker-compose-%e9%a1%b9%e7%9b%ae">docker-compose</a> 部署服务</h3><blockquote><p>Docker Compose 是 Docker 官方编排（Orchestration）项目之一，负责快速在集群中部署分布式应用。</p></blockquote><pre class="line-numbers language-none"><code class="language-none">✗ docker-compose upBuilding web[+] Building 16.4s (11&#x2F;11) FINISHED &#x3D;&gt; [internal] load build definition from Dockerfile                                                                                                                0.0s &#x3D;&gt; &#x3D;&gt; transferring dockerfile: 120B                                                                                                                                0.0s &#x3D;&gt; [internal] load .dockerignore                                                                                                                                   0.0s &#x3D;&gt; &#x3D;&gt; transferring context: 2B                                                                                                                                     0.0s &#x3D;&gt; [internal] load metadata for docker.io&#x2F;library&#x2F;python:3.7-alpine                                                                                               16.3s &#x3D;&gt; [auth] library&#x2F;python:pull token for registry-1.docker.io                                                                                                       0.0s &#x3D;&gt; [internal] load build context                                                                                                                                   0.0s &#x3D;&gt; &#x3D;&gt; transferring context: 505B                                                                                                                                   0.0s &#x3D;&gt; [1&#x2F;5] FROM docker.io&#x2F;library&#x2F;python:3.7-alpine@sha256:39ad96c8188f69d513ded616433396a9ab90e061ca85d8eacf6514fa27ec3d40                                          0.0s &#x3D;&gt; &#x3D;&gt; resolve docker.io&#x2F;library&#x2F;python:3.7-alpine@sha256:39ad96c8188f69d513ded616433396a9ab90e061ca85d8eacf6514fa27ec3d40                                          0.0s &#x3D;&gt; CACHED [2&#x2F;5] WORKDIR &#x2F;app                                                                                                                                       0.0s &#x3D;&gt; CACHED [3&#x2F;5] COPY requirements.txt &#x2F;app                                                                                                                         0.0s &#x3D;&gt; CACHED [4&#x2F;5] RUN pip3 install -r requirements.txt --no-cache-dir                                                                                                0.0s &#x3D;&gt; CACHED [5&#x2F;5] COPY . &#x2F;app                                                                                                                                        0.0s &#x3D;&gt; exporting to image                                                                                                                                              0.0s &#x3D;&gt; &#x3D;&gt; exporting layers                                                                                                                                             0.0s &#x3D;&gt; &#x3D;&gt; writing image sha256:9fc116d3008819bf171b4cb2a10957e842b77aa24bde2582d737040cd6f9eaec                                                                        0.0s &#x3D;&gt; &#x3D;&gt; naming to docker.io&#x2F;library&#x2F;flask-demo_web                                                                                                                   0.0sSuccessfully built 9fc116d3008819bf171b4cb2a10957e842b77aa24bde2582d737040cd6f9eaecWARNING: Image for service web was built because it did not already exist. To rebuild this image you must use &#96;docker-compose build&#96; or &#96;docker-compose up --build&#96;.Creating flask-demo_web_1 ... doneAttaching to flask-demo_web_1web_1  |  * Serving Flask app &quot;app&quot; (lazy loading)web_1  |  * Environment: productionweb_1  |    WARNING: This is a development server. Do not use it in a production deployment.web_1  |    Use a production WSGI server instead.web_1  |  * Debug mode: offweb_1  |  * Running on http:&#x2F;&#x2F;0.0.0.0:5000&#x2F; (Press CTRL+C to quit)^CGracefully stopping... (press Ctrl+C again to force)Stopping flask-demo_web_1 ... done(venv) ➜  flask-demo git:(main) ✗ docker ps -aCONTAINER ID   IMAGE                COMMAND                  CREATED          STATUS                        PORTS                    NAMES2e48108b8e1d   flask-demo_web       &quot;python3 app.py&quot;         6 minutes ago    Exited (137) 9 seconds ago                             flask-demo_web_1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>ctrl+c</code>终止服务,使用<code>docker ps -a</code>查看所有容器，再次启动容器使用<code>docker start 容器id</code></p><pre class="line-numbers language-none"><code class="language-none">✗ docker start 2e48108b8e1d2e48108b8e1d(venv) ➜  flask-demo git:(main) ✗ docker psCONTAINER ID   IMAGE            COMMAND            CREATED         STATUS          PORTS                    NAMES2e48108b8e1d   flask-demo_web   &quot;python3 app.py&quot;   9 minutes ago   Up 16 seconds   0.0.0.0:5000-&gt;5000&#x2F;tcp   flask-demo_web_1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>up参数</p><ul><li>构建，（重新）创建，启动，链接一个服务相关的容器。</li><li>链接的服务都将会启动，除非他们已经运行。</li><li>默认情况， <code>docker-compose up</code> 将会整合所有容器的输出，并且退出时，所有容器将会停止。</li><li>如果使用 <code>docker-compose up -d</code> ，将会在后台启动并运行所有的容器。</li><li>默认情况，如果该服务的容器已经存在， <code>docker-compose up</code> 将会停止并尝试重新创建他们（保持使用<code>volumes-from</code> 挂载的卷），以保证 <code>docker-compose.yml</code> 的修改生效。如果你不想容器被停止并重新创建，可以使用 <code>docker-compose up --no-recreate</code>。如果需要的话，这样将会启动已经停止的容器。</li></ul><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://github.com/docker/awesome-compose">一些docker-compose 部署示例</a></li><li><a href="https://github.com/docker/awesome-compose/tree/master/flask">docker-compose部署flask</a> </li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git操作手册</title>
      <link href="2021/03/24/git-cao-zuo-shou-ce/"/>
      <url>2021/03/24/git-cao-zuo-shou-ce/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Git 常用操作示例</p></blockquote><span id="more"></span><h3 id="添加远程仓库"><a href="#添加远程仓库" class="headerlink" title="添加远程仓库"></a>添加远程仓库</h3><pre class="line-numbers language-none"><code class="language-none">git remote add origin git@github.com:michaelliao&#x2F;learngit.git  git push -u origin master  向master 分支推送<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="删除本地分支-远程分支"><a href="#删除本地分支-远程分支" class="headerlink" title="删除本地分支|远程分支"></a>删除本地分支|远程分支</h3><ul><li>删除远程分支(推送一个空分支)<pre class="line-numbers language-none"><code class="language-none">git push origin :issue_101 删除远程分支<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><h3 id="远程分支管理"><a href="#远程分支管理" class="headerlink" title="远程分支管理"></a>远程分支管理</h3><pre class="line-numbers language-none"><code class="language-none">git branch -a # 查看所有本地分支和远程分支git branch -r # 只查看远程分支git remote prune origin # 发现很多在远程仓库已经删除的分支在本地依然可以看到,删除远程不存在的分支git remote show origin # 查看remote地址，远程分支，还有本地分支与之相对应关系等信息<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="设置默认推送远程分支"><a href="#设置默认推送远程分支" class="headerlink" title="设置默认推送远程分支"></a>设置默认推送远程分支</h3><pre class="line-numbers language-none"><code class="language-none"># 将本地分支与远程分支进行关联# 设置git push&#x2F;pull 默认推送远程分支 git branch --set-upstream-to&#x3D;origin&#x2F;&lt;远端分支&gt; &lt;本地分支&gt;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="删除远程不存在的分支"><a href="#删除远程不存在的分支" class="headerlink" title="删除远程不存在的分支"></a>删除远程不存在的分支</h3><p>使用<code>git branch -a</code>命令可以查看所有本地分支和远程分支（<code>git branch -r</code>可以只查看远程分支）<br>发现很多在远程仓库已经删除的分支在本地依然可以看到。</p><pre class="line-numbers language-none"><code class="language-none">$ git branch -a  feature-account-resell  feature-code-refactor  feature-crontab  feature-data-source  feature-utf8* master  remotes&#x2F;origin&#x2F;HEAD -&gt; origin&#x2F;master  remotes&#x2F;origin&#x2F;feature-account-resell  remotes&#x2F;origin&#x2F;feature-add-faka  remotes&#x2F;origin&#x2F;feature-code-refactor  remotes&#x2F;origin&#x2F;feature-crontab  remotes&#x2F;origin&#x2F;feature-data-source  remotes&#x2F;origin&#x2F;feature-ias  remotes&#x2F;origin&#x2F;feature-utf8  remotes&#x2F;origin&#x2F;master  remotes&#x2F;origin&#x2F;zengjinping<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用命令 <code>git remote show origin</code>，可以查看<code>remote</code>地址，远程分支，还有本地分支与之相对应关系等信息。</p><pre class="line-numbers language-none"><code class="language-none">$ git remote show origin* remote origin  Fetch URL: git@wangqiao.threathunter.cn:alert&#x2F;SaleCardScript.git  Push  URL: git@wangqiao.threathunter.cn:alert&#x2F;SaleCardScript.git  HEAD branch: master  Remote branches:    feature-add-faka                           tracked    feature-ias                                tracked    master                                     tracked    refs&#x2F;remotes&#x2F;origin&#x2F;feature-account-resell stale (use &#39;git remote prune&#39; to remove)    refs&#x2F;remotes&#x2F;origin&#x2F;feature-code-refactor  stale (use &#39;git remote prune&#39; to remove)    refs&#x2F;remotes&#x2F;origin&#x2F;feature-crontab        stale (use &#39;git remote prune&#39; to remove)    refs&#x2F;remotes&#x2F;origin&#x2F;feature-data-source    stale (use &#39;git remote prune&#39; to remove)    refs&#x2F;remotes&#x2F;origin&#x2F;feature-utf8           stale (use &#39;git remote prune&#39; to remove)    zengjinping                                tracked  Local branches configured for &#39;git pull&#39;:    feature-account-resell merges with remote feature-account-resell    feature-code-refactor  merges with remote feature-code-refactor    feature-crontab        merges with remote feature-crontab    feature-data-source    merges with remote feature-data-source    feature-utf8           merges with remote feature-utf8    master                 merges with remote master  Local ref configured for &#39;git push&#39;:    master pushes to master (up to date)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>此时我们可以看到那些远程仓库已经不存在的分支，根据提示，使用 <code>git remote prune origin</code> 命令</p><pre class="line-numbers language-none"><code class="language-none">$ git remote prune originPruning originURL: git@wangqiao.threathunter.cn:alert&#x2F;SaleCardScript.git * [pruned] origin&#x2F;feature-account-resell * [pruned] origin&#x2F;feature-code-refactor * [pruned] origin&#x2F;feature-crontab * [pruned] origin&#x2F;feature-data-source * [pruned] origin&#x2F;feature-utf8(venv) [user_00@test-env &#x2F;data&#x2F;server&#x2F;SaleCardScript]$ (venv) [user_00@test-env &#x2F;data&#x2F;server&#x2F;SaleCardScript]$ git branch -a  feature-account-resell  feature-code-refactor  feature-crontab  feature-data-source  feature-utf8* master  remotes&#x2F;origin&#x2F;HEAD -&gt; origin&#x2F;master  remotes&#x2F;origin&#x2F;feature-add-faka  remotes&#x2F;origin&#x2F;feature-ias  remotes&#x2F;origin&#x2F;master  remotes&#x2F;origin&#x2F;zengjinping<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这样就删除了那些远程仓库不存在的分支。</p><h3 id="删除已提交的-需要被忽略-的文件"><a href="#删除已提交的-需要被忽略-的文件" class="headerlink" title="删除已提交的(需要被忽略)的文件"></a>删除已提交的(需要被忽略)的文件</h3><pre class="line-numbers language-none"><code class="language-none">1.在终端输入;git rm -r --cached 要删除的文件名,如:git rm -r --cached .idea--cached 只删远程仓库的文件,不会删除本地的2.提交操作记录描述git commit -m &#39;删除XX文件&#39;3.推送到远程仓库git push -u origin master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支"><a href="#更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支" class="headerlink" title="更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支"></a>更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支</h3><pre class="line-numbers language-none"><code class="language-none">$ git pushTo github.com:amuqiao&#x2F;amuqiao.github.io.git ! [rejected]        hexo -&gt; hexo (non-fast-forward)error: 推送一些引用到 &#39;github.com:amuqiao&#x2F;amuqiao.github.io.git&#39; 失败提示：更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支。提示：再次推送前，先与远程变更合并（如 &#39;git pull ...&#39;）。详见提示：&#39;git push --help&#39; 中的 &#39;Note about fast-forwards&#39; 小节。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>解决方案：需要先获取远端更新并与本地合并,再git push</p><pre class="line-numbers language-none"><code class="language-none">git remote add origin https:&#x2F;&#x2F;github.com&#x2F;miaoihan&#x2F;weibo.git  $git fetch origin    &#x2F;&#x2F;获取远程更新$git merge origin&#x2F;master &#x2F;&#x2F;把更新的内容合并到本地分支<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="将本地已有的项目完整的提交到github上"><a href="#将本地已有的项目完整的提交到github上" class="headerlink" title="将本地已有的项目完整的提交到github上"></a>将本地已有的项目完整的提交到github上</h3><p><code>~/NutstoreFiles/project/grafana-tutorial</code>项目为示例进行操作</p><p>在GitHub新建一个仓库</p><pre class="line-numbers language-none"><code class="language-none">$ cd ~&#x2F;NutstoreFiles&#x2F;project&#x2F;grafana-tutorial# 本地仓库初始化$ git init# 把全部文件添加到暂存区git add .# 把暂存区的文件提交到本地仓库git commit -m &quot;初始化提交&quot;# 连接远程仓库并推送# git remote add origin 远程仓库地址# origin是给远程仓库取的一个别名，远程仓库地址是GitHub仓库地址。该命令作用是让本地仓库和远程仓库相连接。git remote add origin git@github.com:amuqiao&#x2F;grafana-tutorial.git# 把本地库的内容推送到远程，用git push命令，实际上是把当前分支master推送到远程。由于远程库是空的，# 我们第一次推送master分支时，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，# 还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令（直接用git pull或者git push）。# 向master分支进行推送git push -u origin master# 强行推送，本地仓库代码强行覆盖远程仓库：$ git push -f origin master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>参考 <a href="https://blog.csdn.net/qq_42780289/article/details/102512463">Git：将本地项目推送到GitHub</a></li><li></li></ul><h3 id="git-branch-结果不在当前页显示"><a href="#git-branch-结果不在当前页显示" class="headerlink" title="git branch 结果不在当前页显示"></a>git branch 结果不在当前页显示</h3><p>某些git命令的输出内容不是直接显示在命令下面，而是会额外打开一个窗口来显示，按q才能退出该窗口<br>终端执行</p><pre class="line-numbers language-none"><code class="language-none">git config --global core.pager &#39;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tmux使用教程</title>
      <link href="2021/03/22/tmux-shi-yong-jiao-cheng/"/>
      <url>2021/03/22/tmux-shi-yong-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Tmux 是一个终端复用器（terminal multiplexer），非常有用，属于常用的开发工具。</p></blockquote><span id="more"></span><h3 id="tmux的基本操作"><a href="#tmux的基本操作" class="headerlink" title="tmux的基本操作"></a>tmux的基本操作</h3><p><code>Prefix-Command</code>前置操作：所有下面介绍的快捷键，都必须以前置操作开始。tmux默认的前置操作是<code>CTRL+b</code>。例如，我们想要新建一个窗体，就需要先在键盘上摁下<code>CTRL+b</code>，松开后再摁下<code>n</code>键。</p><p>下面所有的<code>prefix</code>均代表<code>CTRL+b</code></p><h3 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h3><pre class="line-numbers language-none"><code class="language-none">d  退出 tmux（tmux 仍在后台运行）t  窗口中央显示一个数字时钟?  列出所有快捷键:  命令提示符<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Session相关操作"><a href="#Session相关操作" class="headerlink" title="Session相关操作"></a>Session相关操作</h3><table><thead><tr><th>操作</th><th>快捷键</th></tr></thead><tbody><tr><td>新建一个无名称的会话</td><td>tmux</td></tr><tr><td>新建一个名称为demo的会话</td><td>tmux new -s demo</td></tr><tr><td>默认进入第一个会话</td><td>tmux a</td></tr><tr><td>进入到名称为demo的会话</td><td>tmux a -t demo</td></tr><tr><td>session 重命名</td><td>tmux rename -t old_name new_name</td></tr><tr><td>查看所有 session</td><td>tmux ls</td></tr><tr><td>查看/切换session</td><td>prefix s</td></tr><tr><td>离开Session</td><td>prefix d</td></tr><tr><td>重命名当前Session</td><td>prefix $</td></tr></tbody></table><h3 id="Window相关操作"><a href="#Window相关操作" class="headerlink" title="Window相关操作"></a>Window相关操作</h3><table><thead><tr><th>操作</th><th>快捷键</th></tr></thead><tbody><tr><td>新建窗口</td><td>prefix c</td></tr><tr><td>新建命名窗口</td><td>prefix -s new_name</td></tr><tr><td>切换到上一个活动的窗口</td><td>prefix space</td></tr><tr><td>关闭当前窗口</td><td>prefix &amp;</td></tr><tr><td>使用窗口号切换</td><td>prefix 窗口号</td></tr><tr><td>列出所有窗口</td><td>prefix w</td></tr><tr><td>前一个窗口</td><td>p</td></tr><tr><td>后一个窗口</td><td>n</td></tr><tr><td>重命名当前窗口</td><td>,</td></tr><tr><td>查找窗口</td><td>f</td></tr></tbody></table><h4 id="调整窗口排序"><a href="#调整窗口排序" class="headerlink" title="调整窗口排序"></a>调整窗口排序</h4><table><thead><tr><th>操作</th><th>快捷键</th></tr></thead><tbody><tr><td>交换 3 号和 1 号窗口</td><td>swap-window -s 3 -t 1</td></tr><tr><td>交换当前和 1 号窗口</td><td>swap-window -t 1</td></tr><tr><td>移动当前窗口到 1 号</td><td>move-window -t 1</td></tr></tbody></table><h3 id="Pane相关操作"><a href="#Pane相关操作" class="headerlink" title="Pane相关操作"></a>Pane相关操作</h3><table><thead><tr><th>操作</th><th>快捷键</th></tr></thead><tbody><tr><td>切换到下一个窗格</td><td>prefix o</td></tr><tr><td>查看所有窗格的编号</td><td>prefix q</td></tr><tr><td>垂直拆分出一个新窗格</td><td>prefix “</td></tr><tr><td>水平拆分出一个新窗格</td><td>prefix %</td></tr><tr><td>切换窗格最大化/最小化</td><td>z</td></tr><tr><td>与上一个窗格交换位置</td><td>{</td></tr><tr><td>与下一个窗格交换位置</td><td>}</td></tr><tr><td>关闭窗格</td><td>x</td></tr><tr><td>垂直分割</td><td>%</td></tr><tr><td>水平分割</td><td>“</td></tr></tbody></table><h4 id="调整窗格尺寸"><a href="#调整窗格尺寸" class="headerlink" title="调整窗格尺寸"></a>调整窗格尺寸</h4><p>如果你不喜欢默认布局，可以重调窗格的尺寸。虽然这很容易实现，但一般不需要这么干。这几个命令用来调整窗格：</p><h3 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h3><pre class="line-numbers language-none"><code class="language-none"># 列出所有快捷键，及其对应的 Tmux 命令$ tmux list-keys# 列出所有 Tmux 命令及其参数$ tmux list-commands# 列出当前所有 Tmux 会话的信息$ tmux info# 重新加载当前的 Tmux 配置$ tmux source-file ~&#x2F;.tmux.conf# 关闭服务器，所有的会话都将关闭, 重启tmux生效配置tmux kill-server # 在session中，先按C+b，然后输入：，进入命令行模式，在命令行模式下输入source-file ~&#x2F;.tmux.conf# 关闭demo会话tmux kill-session -t demo <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Tmux-安装"><a href="#Tmux-安装" class="headerlink" title="Tmux 安装"></a>Tmux 安装</h3><pre class="line-numbers language-none"><code class="language-none">$ brew install tmux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="修改tmux配置"><a href="#修改tmux配置" class="headerlink" title="修改tmux配置"></a>修改tmux配置</h3><h4 id="鼠标滚动查看上下文"><a href="#鼠标滚动查看上下文" class="headerlink" title="鼠标滚动查看上下文"></a><a href="https://github.com/NHDaly/tmux-better-mouse-mode">鼠标滚动查看上下文</a></h4><pre class="line-numbers language-none"><code class="language-none">vi ~&#x2F;.tmux.conf# 开启鼠标模式set -g mouse on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="修改Prefix-Command"><a href="#修改Prefix-Command" class="headerlink" title="修改Prefix-Command"></a>修改<code>Prefix-Command</code></h4><pre class="line-numbers language-none"><code class="language-none"># 修改前置快捷键set -g prefix C-zunbind C-b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="窗口自定义命名"><a href="#窗口自定义命名" class="headerlink" title="窗口自定义命名"></a>窗口自定义命名</h4><pre class="line-numbers language-none"><code class="language-none"># 如果喜欢给窗口自定义命名，那么需要关闭窗口的自动命名set-option -g allow-rename off<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="鼠标选中复制"><a href="#鼠标选中复制" class="headerlink" title="鼠标选中复制"></a>鼠标选中复制</h4><pre class="line-numbers language-none"><code class="language-none"># 鼠标选中复制bind -n WheelUpPane if-shell -F -t &#x3D; &quot;#&#123;mouse_any_flag&#125;&quot; &quot;send-keys -M&quot; &quot;if -Ft&#x3D; &#39;#&#123;pane_in_mode&#125;&#39; &#39;send-keys -M&#39; &#39;select-pane -t&#x3D;; copy-mode -e; send-keys -M&#39;&quot;bind -n WheelDownPane select-pane -t&#x3D; \; send-keys -Mbind -n C-WheelUpPane select-pane -t&#x3D; \; copy-mode -e \; send-keys -Mbind -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-upbind -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-downbind -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-upbind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down# To copy, left click and drag to highlight text in yellow,# once you release left click yellow text will disappear and will automatically be available in clibboard# # Use vim keybindings in copy modesetw -g mode-keys vi# Update default binding of &#96;Enter&#96; to also use copy-pipeunbind -T copy-mode-vi Enterbind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel &quot;pbcopy&quot;bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel &quot;pbcopy&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="TMUX-插件"><a href="#TMUX-插件" class="headerlink" title="TMUX 插件"></a>TMUX 插件</h3><h4 id="TMUX-插件管理器"><a href="#TMUX-插件管理器" class="headerlink" title="TMUX 插件管理器"></a><a href="https://github.com/tmux-plugins/tpm">TMUX 插件管理器</a></h4><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><pre class="line-numbers language-none"><code class="language-none">git clone https:&#x2F;&#x2F;github.com&#x2F;tmux-plugins&#x2F;tpm ~&#x2F;.tmux&#x2F;plugins&#x2F;tpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>添加以下信息到配置文件中<code>~/.tmux.conf</code>($XDG_CONFIG_HOME/tmux/tmux.conf works too):</p><pre class="line-numbers language-none"><code class="language-none"># 插件列表set -g @plugin &#39;tmux-plugins&#x2F;tpm&#39;set -g @plugin &#39;tmux-plugins&#x2F;tmux-sensible&#39;# 其他示例:# set -g @plugin &#39;github_username&#x2F;plugin_name&#39;# set -g @plugin &#39;git@github.com:user&#x2F;plugin&#39;# set -g @plugin &#39;git@bitbucket.com:user&#x2F;plugin&#39;# 初始化tmux插件管理器 (将这行添加到配置文件最底部)run &#39;~&#x2F;.tmux&#x2F;plugins&#x2F;tpm&#x2F;tpm&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启<code>TMUX</code>环境,使<code>TPM</code>生效(添加其他插件也需要执行该命令):</p><pre class="line-numbers language-none"><code class="language-none"># 如果tmux正在运行，在终端执行该命令$ tmux source ~&#x2F;.tmux.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h5><ul><li>添加插件到配置文件<code>~/.tmux.conf</code>中，例如:set -g @plugin ‘…’</li><li>按 prefix + I (如Install中的大写字母I) 安装插件.</li></ul><p>稍等片刻，插件会被下载到<code>~/.tmux/plugins/</code>文件夹中</p><h5 id="卸载插件"><a href="#卸载插件" class="headerlink" title="卸载插件"></a>卸载插件</h5><ul><li>在插件列表中移除该插件.</li><li>输入<code>prefix + alt + u</code> (小写u进行卸载) 来移除插件.</li></ul><h5 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h5><p><code>prefix + I</code></p><ul><li>从<code>github</code>或者其他仓库中安装在插件列表中的插件</li><li>刷新<code>TMUX</code>环境</li></ul><p><code>prefix + U</code></p><ul><li>更新插件<br>prefix + alt + u</li><li>移除/下载不在插件列表中的插件</li></ul><h5 id="更新配置信息"><a href="#更新配置信息" class="headerlink" title="更新配置信息"></a>更新配置信息</h5><p>若对<code>~/.tmux.conf</code>做出修改，执行<code>tmux source-file ~/.tmux.conf</code>命令使配置生效</p><h4 id="TMUX插件中心"><a href="#TMUX插件中心" class="headerlink" title="TMUX插件中心"></a><a href="https://github.com/tmux-plugins/list">TMUX插件中心</a></h4><p>tmux支持下列插件</p><ul><li>extrakto - Allows you to select text from your window by fuzzy matching it through a set of filters with fzf. Look ma, no mouse!</li><li>tmux-battery - Plug and play battery percentage and icon indicator.</li><li>tmux-colours-superhero - A superhero themed tmux colour theme.</li><li>tmux-continuum - Continuous saving of tmux environment. Automatic restore when tmux is started. Automatic tmux start when computer is turned on.</li><li>tmux-copycat - Enhances tmux search.</li><li>tmux-copytk - Multi utility rapid copy toolkit.</li><li>tmux-cpu - Plug and play cpu percentage and icon indicator.</li><li>tmux-fpp - Quickly open any path on your terminal window in your $EDITOR of choice!</li><li>tmux-jump - Vimium/Easymotion like navigation for tmux.</li><li>tmux-keyboard-layout - Show current keyboard layout in your status bar</li><li>tmux-logging - Easy logging and screen capturing.</li><li>tmux-maildir-counter - Plugin that counts files on a specific mail directory.</li><li>tmux-mem-cpu-load - CPU, RAM, and load monitor for use with tmux.</li><li>tmux-net-speed - Tmux plugin to monitor upload and download speed of one or all interfaces.</li><li>tmux-online-status - Tmux plugin that displays online status of your computer.</li><li>tmux-open - Tmux key bindings for quick opening of a highlighted file or url.</li><li>tmux-pain-control - Standard pane key-bindings for tmux.</li><li>tmux-peacock - Per session color and style based on session name</li><li>tmux-piavpn - Keep track of your Private Internet Access VPN status.</li><li>tmux-pomodoro - Use Pomodoro technique with timer showing in tmux status bar.</li><li><a href="https://github.com/tmux-plugins/tmux-prefix-highlight">tmux-prefix-highlight</a> 当你按下tmux前缀键时突出显示的插件.</li><li><a href="https://github.com/tmux-plugins/tmux-resurrect">tmux-resurrect</a> - 在系统重启时持续tmux环境.</li><li>tmux-sensible - Basic tmux settings everyone can agree on.</li><li>tmux-sessionist - Lightweight utils for manipulating sessions.</li><li>tmux-sidebar - A sidebar with the directory tree for the current path. Tries to make tmux more IDE like.</li><li>tmux-ticker - Keep a track of popular market indexes and stock price.</li><li>tmux-update-display - When attaching to tmux session, update $DISPLAY for each tmux pane in that session.</li><li>tmux-urlview - Quickly open any url on your terminal window!</li><li>tmux-weather - Display weather information in your terminal.</li><li>tmux-yank - 用于复制到系统剪贴板。适用于MacOS, Linux和Cygwin.</li><li>tpm - Tmux plugin manager.</li></ul><h4 id="窗口持久化插件-tmux-resurrect"><a href="#窗口持久化插件-tmux-resurrect" class="headerlink" title="窗口持久化插件 tmux-resurrect"></a>窗口持久化插件 <a href="https://github.com/tmux-plugins/tmux-resurrect"><code>tmux-resurrect</code></a></h4><p>Tmux 虽好，但是一旦重启，之前的窗口环境都会消失得无影无踪，幸好有了这个插件<br>有了它，你可以通过简单的两个快捷键随时备份或恢复窗口环境。</p><p>使用 <a href="https://github.com/tmux-plugins/tpm">Tmux插件管理器</a>(推荐)，安装插件后，在配置文件中插件列表的位置加入这一行</p><pre class="line-numbers language-none"><code class="language-none">set -g @plugin &#39;tmux-plugins&#x2F;tmux-resurrect&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>点击<code>prefix + I</code>来获取插件使之生效。</p><p>安装成功后使用 <code>prefix + Ctrl-s</code> 保存，使用 <code>prefix + Ctrl-r</code> 恢复。</p><p>值得注意的是，恢复后，原窗口中的进程会被杀掉。如果你是重启后恢复，那自然没什么问题，但是平时试验的时候可要留心有没有重要的任务正在运行中。</p><p><a href="https://github.com/tmux-plugins/tmux-resurrect/blob/e4825055c92e54b0c6ec572afc9b6c4723aba6c8/docs/save_dir.md">Resurrect save dir</a></p><p>Tmux 环境默认保存在<code> ~/.tmux/resurrect dir</code>中，如果需要更改，使用以下命令</p><pre class="line-numbers language-none"><code class="language-none"># set -g @resurrect-dir &#39;&#x2F;some&#x2F;path&#39;set -g @resurrect-dir &#39;~&#x2F;.tmux&#x2F;resurrect&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>在这个选项中不允许使用环境变量或shell插值，因为字符串是按字面意思使用的。所以下面这些不会达到预期的效果:</p><pre class="line-numbers language-none"><code class="language-none">set -g @resurrect-dir &#39;&#x2F;path&#x2F;$MY_VAR&#x2F;$(some_executable)&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>仅支持这些变量设置: <code>$HOME</code>, <code>$HOSTNAME</code>, 和 <code>~</code>.</p><h5 id="mac系统重启后，tmux-插件失效"><a href="#mac系统重启后，tmux-插件失效" class="headerlink" title="mac系统重启后，tmux 插件失效"></a>mac系统重启后，tmux 插件失效</h5><p>mac系统重启后，tmux进程终止，tmux 插件失效，<code>tmux-prefix-highlight</code>无法高亮显示<code>prefix</code>键，使用<code>tmux</code>启动进程，<code>prefix + Ctrl-r</code>无法恢复<code>session</code></p><p>按以下方式可恢复session</p><ol><li>重启mac系统</li><li>启动tmux进程，<code>$ tmux</code></li><li>重载tmux配置文件，<code>$ prefix + I</code></li><li>恢复之前保存的session，<code>prefix + Ctrl-r</code></li></ol><h3 id="我的配置文件-tmux-conf"><a href="#我的配置文件-tmux-conf" class="headerlink" title="我的配置文件~/tmux.conf"></a>我的配置文件<code>~/tmux.conf</code></h3><pre class="line-numbers language-none"><code class="language-none"># -----------------------------------------------------------------------------# Tmux 基本配置 - 要求 Tmux &gt;&#x3D; 2.3# 如果不想使用插件，只需要将此节的内容写入 ~&#x2F;.tmux.conf 即可# -----------------------------------------------------------------------------# 开启鼠标模式set -g mouse on# 修改前置快捷键set -g prefix C-zunbind C-b# 鼠标选中复制bind -n WheelUpPane if-shell -F -t &#x3D; &quot;#&#123;mouse_any_flag&#125;&quot; &quot;send-keys -M&quot; &quot;if -Ft&#x3D; &#39;#&#123;pane_in_mode&#125;&#39; &#39;send-keys -M&#39; &#39;select-pane -t&#x3D;; copy-mode -e; send-keys -M&#39;&quot;bind -n WheelDownPane select-pane -t&#x3D; \; send-keys -Mbind -n C-WheelUpPane select-pane -t&#x3D; \; copy-mode -e \; send-keys -Mbind -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-upbind -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-downbind -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-upbind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down# To copy, left click and drag to highlight text in yellow,# once you release left click yellow text will disappear and will automatically be available in clibboard# # Use vim keybindings in copy modesetw -g mode-keys vi# Update default binding of &#96;Enter&#96; to also use copy-pipeunbind -T copy-mode-vi Enterbind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel &quot;pbcopy&quot;bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel &quot;pbcopy&quot;# -----------------------------------------------------------------------------# 使用插件 - via tpm# -----------------------------------------------------------------------------# 插件列表set -g @plugin &#39;tmux-plugins&#x2F;tpm&#39;set -g @plugin &#39;tmux-plugins&#x2F;tmux-sensible&#39;set -g @plugin &#39;tmux-plugins&#x2F;tmux-resurrect&#39;set -g @plugin &#39;tmux-plugins&#x2F;tmux-prefix-highlight&#39;# 其他示例:# set -g @plugin &#39;github_username&#x2F;plugin_name&#39;# set -g @plugin &#39;git@github.com:user&#x2F;plugin&#39;# set -g @plugin &#39;git@bitbucket.com:user&#x2F;plugin&#39;# tmux-prefix-highlight 插件配置set -g status-right &#39;#&#123;prefix_highlight&#125; #H | %a %Y-%m-%d %H:%M&#39;set -g @prefix_highlight_show_copy_mode &#39;on&#39;set -g @prefix_highlight_copy_mode_attr &#39;fg&#x3D;white,bg&#x3D;blue&#39;# resurrect 插件配置 保存现场到以下目录set -g @resurrect-dir &#39;~&#x2F;.tmux&#x2F;resurrect&#39;# 初始化tmux插件管理器 (将这行添加到配置文件最底部)run &#39;~&#x2F;.tmux&#x2F;plugins&#x2F;tpm&#x2F;tpm&#39;# -----------------------------------------------------------------------------# 结束# -----------------------------------------------------------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="http://louiszhai.github.io/2017/09/30/tmux/">Tmux使用手册</a></li><li><a href="https://www.cnblogs.com/kaiye/p/6275207.html">十分钟学会 tmux</a></li><li><a href="https://gist.github.com/ryerh/14b7c24dfd623ef8edc7">Tmux 快捷键 &amp; 速查表</a></li><li><a href="http://blog.codepiano.com/2018/06/11/tmux-tpm">tmux 插件管理器和插件</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tmux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grafana入门教程</title>
      <link href="2021/03/22/grafana-ru-men-jiao-cheng/"/>
      <url>2021/03/22/grafana-ru-men-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/grafana/grafana">Grafana</a>是一个开源的度量分析与可视化套件。<span id="more"></span> 经常被用作基础设施的时间序列数据和应用程序分析的可视化，它在其他领域也被广泛的使用包括工业传感器、家庭自动化、天气和过程控制等。</p></blockquote><h3 id="Grafana-是什么"><a href="#Grafana-是什么" class="headerlink" title="Grafana 是什么"></a>Grafana 是什么</h3><p>Grafana 是一个监控仪表系统，它是由 Grafana Labs 公司开源的的一个系统监测 (System Monitoring) 工具。它可以大大帮助你简化监控的复杂度，你只需要提供你需要监控的数据，它就可以帮你生成各种可视化仪表。同时它还有报警功能，可以在系统出现问题时通知你。</p><p>Grafana 不对数据源作假设，它支持以下各种数据，也就是说如果你的数据源是以下任意一种，它都可以帮助生成仪表。同时在市面上，如果 Grafana 称第二，那么应该没有敢称第一的仪表可视化工具了。因此，如果你搞定了 Grafana，它几乎是一个会陪伴你到各个公司的一件称心应手的兵器。</p><h4 id="Grafana-支持的数据源"><a href="#Grafana-支持的数据源" class="headerlink" title="Grafana 支持的数据源"></a>Grafana 支持的数据源</h4><ul><li>Prometheus 时序数据库 本文中的例子，你没听过也没关系不影响阅读，把它想象成带时间戳的 MySQL 就好</li><li>Graphite</li><li>OpenTSDB</li><li>InfluxDB</li><li>MySQL/PostgreSQL</li><li>Microsoft SQL Server</li></ul><h3 id="安装和配置-Grafana"><a href="#安装和配置-Grafana" class="headerlink" title="安装和配置 Grafana"></a>安装和配置 Grafana</h3><blockquote><p>为了简化各种系统不一致的乱七八糟问题，我们用 Docker 来安装 Grafana。</p></blockquote><p>请 clone <a href="https://github.com/amuqiao/grafana-tutorial/tree/main">本教程代码</a>，然后确认本地已经安装 <code>docker-compose</code> 后，在本目录运行</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这条命令会启动三个 docker 容器，<code>prometheus</code>, <code>service</code> 和 <code>grafana</code></p><ul><li>prometheus 是普罗米修斯时序数据库</li><li>service 是普罗米修斯自带的数据生成器（监控本机 CPU 内存等信息）</li><li>grafana 就是 Grafana 服务本身</li></ul><p>在你的浏览器中访问 <a href="localhost:3000">localhost:3000</a> 即可看到运行的 Grafana，再根据教程中的步骤设置好源即可</p><h3 id="配置仪表盘"><a href="#配置仪表盘" class="headerlink" title="配置仪表盘"></a>配置仪表盘</h3><p>在使用<code>docker-compose up</code>启动服务后，到你的浏览器中，复制 <a href="http://localhost:3000/">http://localhost:3000</a> 应该就可以看到 Grafana 跑起来的初始登录界面。初始的用户名是 admin，密码也是 admin。输入之后，会要求你改密码,这里我改为123456<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/22B15n.png" alt="22B15n"></p><p>然后就可以进入 Grafana 的主界面了：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/eNTG0T.png" alt="eNTG0T"></p><p>到这里，你的 Grafana 就已经搭起来了。注意到 Docker 的配置文件中我们创建了三个服务，这三个服务之间分别有什么关系呢？</p><p>或者说，Grafana 和时序数据库，数据源之间有什么关系呢？请看下文 Grafana 工作原理</p><h3 id="Grfana-工作原理"><a href="#Grfana-工作原理" class="headerlink" title="Grfana 工作原理"></a>Grfana 工作原理</h3><p>上面说到，Grafana 是一个仪表盘，而仪表盘必然是用来显示数据的。</p><p>Grafana 本身并不负责数据层，它只提供了通用的接口，让底层的数据库可以把数据给它。而我们起的另一个服务，叫 Prometheus （中文名普罗米修斯数据库）则是负责存储和查询数据的。</p><p>也就是说，Grafana 每次要展现一个仪表盘的时候，会向 Prometheus 发送一个查询请求。</p><p>那么配置里的另一个服务 Prometheus-exporter 又是什么呢？</p><p>这个就是你真正监测的数据来源了，Prometheus-exporter 这个服务，会查询你的本地电脑的信息，比如内存还有多少、CPU 负载之类，然后将数据导出至普罗米修斯数据库。</p><p>在真实世界中，你的目的是监控你自己的服务，比如你的 Web 服务器，你的数据库之类。</p><p>那么你就需要在你自己的服务器中把数据发送给普罗米修斯数据库。当然，你完全可以把数据发送给 MySQL (Grafana 也支持)，但普罗米修斯几乎是标配的时序数据库，强烈建议你用。</p><p>用<a href="https://shahbhargav.medium.com/monitoring-docker-containers-using-cadvisor-and-prometheus-5350ae038f45">一张图</a>来说明它们之间的关系:<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/hq0RtW.jpg" alt="hq0RtW"></p><p>这里，最左边的 Docker 服务会将服务的数据发送给中间的普罗米修斯（对应上文的 Prometheus-exporter），而最右边的 Grafana 会查询中间的普罗米修斯，来展示仪表盘。</p><h3 id="搭建你的第一个仪表盘"><a href="#搭建你的第一个仪表盘" class="headerlink" title="搭建你的第一个仪表盘"></a>搭建你的第一个仪表盘</h3><h4 id="设置数据源"><a href="#设置数据源" class="headerlink" title="设置数据源"></a>设置数据源</h4><p>进入 Grafana 后，在左侧你会发现有一个 Data Source 即数据源选项<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/c6T5xz.png" alt="c6T5xz"><br>点击后进入，点 Add Data Source 即添加数据源，选择 Prometheus<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/nTuJVL.png" alt="nTuJVL"></p><p>之后设置数据源 URL。请注意，Promethues 的工作原理是通过轮询一个 HTTP 请求来获取数据的，而 Grafana 在获取数据源的时候也是通过一个 HTTP 请求，因此这个地方你需要告诉 Grafana 你的 Prometheus 的数据端点是什么。</p><p>这里我们填入 <a href="http://prometheus:9090/">http://prometheus:9090</a> 就可以了。<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/ohtJiw.png" alt="ohtJiw"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/xXyiQB.png" alt="xXyiQB"><br>点确认时一定要确认出现 Data source is working 这个检测，这时表明你的 Grafana 已经跟普罗米修斯说上话了</p><h4 id="导入-Dashboard"><a href="#导入-Dashboard" class="headerlink" title="导入 Dashboard"></a>导入 Dashboard</h4><p>在 Grafana 里，仪表盘的配置可以通过图形化界面进行，但配置好的仪表盘是以 JSON 存储的。这也就是说，如果你把你的 JSON 数据分享出去，别人导入就可以直接导入同样的仪表盘（前提是你们的监测数据一样）。</p><p>对于我们的例子来说，回忆一下，因为我们用了 prometheus-exporter 也就是本机的系统信息监控，那么我们可以先找一个同样用了这个数据源的仪表盘。在 Grafana 网站上，你其实可以找到很多别人已经做好的仪表，可以用来监测非常多标准化的服务。</p><p>Grafana 的仪表盘市场：<a href="https://grafana.com/grafana/dashboards">https://grafana.com/grafana/dashboards</a></p><p>比如说针对以下一些服务的标准仪表盘就可以在这里找到</p><ul><li>JVM</li><li>Spring Boot</li><li>MySQL 监控</li><li>Laravel 监控<br>那么，这里我们就用一个标准的仪表盘：<a href="https://grafana.com/grafana/dashboards/1860">https://grafana.com/grafana/dashboards/1860</a></li></ul><p>在左侧的加号里，点 Import 即导入，在出现的界面中填入 1860 即我们要导入的仪表盘编号即可。<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/j198Ty.png" alt="j198Ty"><br>然后填入你需要的信息，比如仪表盘名字等<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/J6HLTl.png" alt="J6HLTl"><br>确认之后 Grafana 就会根据你的本机信息，生成类似 CPU 负载，内存和 I/O 之类的信息。我的磁盘状况如图：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/HZrRYJ.png" alt="HZrRYJ"><br>要注意的是，这里的信息真正监控的是你的 Docker 中的系统信息。如果你只给你的 Docker 分配 1 个核和 2G 内存，那么这里应该看到的就是 1 个核和 2G 内存</p><h4 id="生成和创建新的仪表盘"><a href="#生成和创建新的仪表盘" class="headerlink" title="生成和创建新的仪表盘"></a>生成和创建新的仪表盘</h4><p>最后，在上面导入信息的基础上，你就可以开始创建和你的服务、业务相关的仪表盘了。</p><p>但在这步之前，你需要先在你的服务中开始记录一些数据。</p><p>这一步涉及</p><p><strong>如何在各种语言中记录你关注的数据？</strong></p><p>拿卡拉搜索举例子，我们关注用卡拉搜索的 APP 的搜索响应速度，所以自然我们需要在所有搜索请求处记录延迟。</p><p>对于你的服务，你需要根据自己的业务确认哪些数据是重要的，关于如何记录数据，如何思考运维等，我会在之后的博客中继续深入讨论。如果你想更深入地了解这个领域，推荐阅读 Google 运维手册这本书，英文名叫《Google SRE Book》，免费的书。</p><p><strong>包括如何用 Prometheus 查询数据</strong></p><p>普罗米修斯本身也是个非常大的话题，我们会在之后的博客中继续讨论。普罗米修斯包括所有其它时序数据库通常都会定义一个查询语言，比如说 PromQL，如果需要熟练地构建仪表盘的话，需要对这个查询语言有一定了解。</p><p><strong>如何手动生成一个仪表盘</strong></p><p>假设你已经按上面的步骤生成了一个基本的仪表盘，那么现在可以开始手动添加仪表盘了。同样是点左侧的加号，点 Dashboard 就可以进入添加仪表盘的界面。</p><p>这里我们选择一个数据叫 scrape_duration_seconds，先不用管它的含义是什么，就当它是双 11 的销售额好了：<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/OHf5oL.png" alt="OHf5oL"><br>添加好后点右上角的 Apply 或 Save 你的仪表盘就被保存了。这时候，用一个大屏幕展示一下，庆祝一下双十一又过了千亿吧 :D</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>这篇文章里我们从头到尾介绍了如何用 Grafana 生成仪表盘，如何配置和连接数据源，以及如何导入和创建一个仪表盘。</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://support.websoft9.com/docs/grafana/zh/">Grafana 管理员手册</a></li><li><a href="https://kalasearch.cn/blog/grafana-with-prometheus-tutorial/">Grafana 教程 - 构建你的第一个仪表盘</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> grafana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>精品mac应用分享</title>
      <link href="2021/03/20/jing-pin-mac-ying-yong-fen-xiang/"/>
      <url>2021/03/20/jing-pin-mac-ying-yong-fen-xiang/</url>
      
        <content type="html"><![CDATA[<blockquote><p>推荐优质mac应用，开发效率利器，亲自验证</p></blockquote><span id="more"></span><h4 id="文件处理"><a href="#文件处理" class="headerlink" title="文件处理"></a>文件处理</h4><ul><li><a href="https://itunes.apple.com/us/app/the-unarchiver/id425424353?mt=12">The Unarchiver</a> 解压</li></ul><h4 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h4><ul><li><a href="https://nitroshare.net/">nitroshare</a> 跨平台网络文件传输应用</li></ul><h4 id="网络工具"><a href="#网络工具" class="headerlink" title="网络工具"></a>网络工具</h4><ul><li><a href="https://github.com/yangshun1029/aria2gui">Aria2GUI</a> 一款百度云文件不限速下载工具</li><li><a href="https://motrix.app/">Motrix</a> “十分清爽的下载软件，无会员制、不限速。还可以按照步骤在应用中增加百度网盘下载助手，但没有会员还是会被限速哦。” </li></ul><h4 id="数据库工具"><a href="#数据库工具" class="headerlink" title="数据库工具"></a>数据库工具</h4><ul><li><a href="https://www.jetbrains.com/datagrip/">DataGrip</a> JetBrains公司旗下一款数据库管理工具</li><li><a href="http://xclient.info/s/navicat-for-mysql.html?t=6b420ac7268d7637225dd7d2519333ebc31537ba">Navicat for MySQL</a> 图形化 MySQL 数据库管理工具</li><li><a href="https://www.charlesproxy.com/">Charles</a> 一个HTTP代理/ HTTP监视器/反向代理,它使开发人员能够查看他们的机器和Internet之间的所有HTTP和SSL / HTTPS通信。这包括请求、响应和HTTP头(其中包含cookie和缓存信息)。</li></ul><h4 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h4><ul><li><a href="http://xclient.info/s/transmit.html?t=6b420ac7268d7637225dd7d2519333ebc31537ba">Transmit</a> mac上最好用的功能齐全的FTP客户端<h4 id="Markdown编辑器"><a href="#Markdown编辑器" class="headerlink" title="Markdown编辑器"></a>Markdown编辑器</h4></li><li><a href="https://ivarptr.github.io/yu-writer.site/">Yu Writer</a>一款能够找到写作乐趣的Markdown文本编辑器</li><li><a href="https://toolinbox.net/iPic/">Typora</a> 一款极致简洁的 markdown 编辑器</li></ul><h4 id="语音识别"><a href="#语音识别" class="headerlink" title="语音识别"></a>语音识别</h4><ul><li><a href="https://apps.apple.com/cn/app/%E8%AE%AF%E9%A3%9E%E8%AF%AD%E9%9F%B3%E8%BE%93%E5%85%A5-%E6%99%BA%E8%83%BD%E8%AF%86%E5%88%AB-%E8%BD%BB%E6%9D%BE%E5%86%99%E4%BD%9C/id1243368435?mt=12">讯飞语音输入</a> 语义识别度较高</li></ul><h4 id="markdown-图床工具"><a href="#markdown-图床工具" class="headerlink" title="markdown 图床工具"></a>markdown 图床工具</h4><ul><li> 【<a href="https://github.com/gee1k/uPic/releases">uPic</a>】<a href="https://sspai.com/post/55933">支持自定义，一款免费而强大的Mac图床客户端</a></li></ul><h4 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h4><ul><li><a href="https://boostnote.io/#download">Boostnote</a> 程序员的开源笔记,除了日常笔记记录，最大的用处就是帮你记录无数的代码资源片段，支持markdown</li><li><a href="https://note.youdao.com/?keyfrom=ydoc">有道云笔记</a> 免费全平台同步，支持markdown</li></ul><h4 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h4><ul><li><a href="http://xclient.info/s/things.html?t=6b420ac7268d7637225dd7d2519333ebc31537ba">Things</a> 一款优秀的GTD任务管理工具<h4 id="音频和视频"><a href="#音频和视频" class="headerlink" title="音频和视频"></a>音频和视频</h4></li><li><a href="https://lhc70000.github.io/iina/">IINA</a>基于<a href="https://github.com/mpv-player/mpv">MPV</a>的，现代视频播放器，支持多点触摸控制，目前mac上最好用的免费开源播放器</li><li><a href="http://music.163.com/">网易云音乐</a><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4></li><li><a href="https://www.macupdate.com/app/mac/37872/scroll-reverser">Scroll Reverser</a> 一款mac上能够分开设定触摸板和鼠标的滚动方向的小工具</li><li><a href="http://mac.softpedia.com/get/Utilities/Shift-It.shtml">Shift It for Mac</a> 轻松用快捷键实现窗口管理</li><li><a href="https://www.macbartender.com/">Bartender</a>  一款实用的菜单栏管理工具,Bartender可以整理这些快捷菜单图标，提供折叠、排序等功能，并支持快捷键查找打开</li><li><a href="http://xclient.info/s/daisy-disk.html?t=cf45be83ba9e7cbc54b5a457f912356b56190ed7#versions">DaisyDisk</a> 一款快速扫描出磁盘上各文件夹的占用比例，并按文件大小排列的小工具，这对于定期清理旧文件和大文件非常有帮助</li><li><h4 id="程序员必备"><a href="#程序员必备" class="headerlink" title="程序员必备"></a>程序员必备</h4><a href="https://xclient.info/s/beyond-compare.html">Beyond Compare</a> 文件对比利器 <a href="https://blog.csdn.net/tanningzhong/article/details/81285278">破解教程</a></li></ul><h4 id="磁盘分析工具"><a href="#磁盘分析工具" class="headerlink" title="磁盘分析工具"></a>磁盘分析工具</h4><ul><li><a href="https://lemon.qq.com/">腾讯柠檬</a> 匠心打磨清理体验，一键释放磁盘空间</li></ul><h4 id="日历"><a href="#日历" class="headerlink" title="日历"></a>日历</h4><ul><li><a href="https://xclient.info/s/tinycal.html">TinyCal</a> 小而美的日历</li></ul><h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><ul><li><a href="http://www.sequelpro.com/">sequel pro</a> 一款管理Mysql的工具，界面简洁易用</li></ul><h4 id="vpn"><a href="#vpn" class="headerlink" title="vpn"></a>vpn</h4><ul><li><a href="https://duotai.love/">多态</a>  好用的vpn</li><li><a href="https://getlantern.org/zh_CN/index.html">蓝灯</a> 免费vpn</li><li><a href="https://www.yaoleguan.com/cn/?a=ez">佛跳墙</a> 免费vpn<h4 id="时间管理工具"><a href="#时间管理工具" class="headerlink" title="时间管理工具"></a>时间管理工具</h4></li><li><a href="https://mac.pomotodo.com/">番茄土豆</a> 番茄土豆帮助你保持专注，完成更多工作</li></ul><h4 id="项目流程管理工具"><a href="#项目流程管理工具" class="headerlink" title="项目流程管理工具"></a>项目流程管理工具</h4><p><a href="https://www.waitsun.com/omniplan-pro.html">OmniPlan Pro Mac</a> Mac上最优秀的项目流程管理工具</p><h4 id="GTD效率工具"><a href="#GTD效率工具" class="headerlink" title="GTD效率工具"></a>GTD效率工具</h4><p><a href="https://www.waitsun.com/omnifocus-3.html">OmniFocus Pro Mac</a> 优秀的GTD效率工具</p><h4 id="图表"><a href="#图表" class="headerlink" title="图表"></a>图表</h4><ul><li><a href="https://www.waitsun.com/omnigraffle-pro.html">OmniGraffle</a> 苹果上最著名的绘图软件，主要用于绘制流程图、图表、组织结构图、UI界面设计等等</li><li><a href="https://www.waitsun.com/xmind-zen.html">Xmind</a> 全新的思维导图软件,界面简洁，上手容易操作简单</li></ul><h4 id="编辑器"><a href="#编辑器" class="headerlink" title="编辑器"></a>编辑器</h4><ul><li><a href="https://www.waitsun.com/sublime-text.html">Sublime Text</a>  绝对强大的代码编辑神器</li></ul><h4 id="阅读"><a href="#阅读" class="headerlink" title="阅读"></a>阅读</h4><ul><li><a href="http://irreader.fatecore.com/">irreader</a> “订阅网页、RSS和Podcast，具备急速的阅读体验，高品质、免费、无广告、多平台的阅读器。”</li></ul><h4 id="壁纸"><a href="#壁纸" class="headerlink" title="壁纸"></a>壁纸</h4><ul><li><a href="https://www.waitsun.com/wallpaper-wizard.html">Wallpaper Wizard</a> 壁纸巫师， 超过10万张的超高质量壁纸</li></ul><h4 id="mac效率工具"><a href="#mac效率工具" class="headerlink" title="mac效率工具"></a>mac效率工具</h4><ul><li><a href="https://xclient.info/s/alfred.html">Alfred</a>  Mac 上最强大的工具台，一个图形化的终端，重新定义搜索功能</li><li><a href="https://www.baidu.com/link?url=me7E9iOUvk4y3WtK0YGmM2DP3doY9KMxroRr61QtyWCkhWDb5cB_IUTyaQAOW0MJ&wd=&eqid=de42068a0004bdbc000000065dc8d961">HyperDock</a>  Mac 窗口管理，支持窗口预览</li><li><a href="https://github.com/fikovnik/ShiftIt">shiftit</a> 快捷键窗口管理</li><li><a href="https://xclient.info/s/bettertouchtool.html">BetterTouchTool</a> 把鼠标触控板的潜力发挥到淋漓尽致</li><li><a href="https://www.waitsun.com/cd-to.html">cd to mac</a> 在Finder目录中快速打开终端</li><li><a href="https://www.waitsun.com/one-switch.html">One Switch</a> 一键切换系统各项功能</li><li><a href="https://www.waitsun.com/slidepad.html">Slidepad</a> iPad式APP切换工具，在系统侧边上设置一个窗口提供我们使用</li><li><a href="https://apps.apple.com/cn/app/manico/id724472954?mt=12">Manico</a> 一个强大的 App 启动器和切换器</li><li><a href="https://zh.snipaste.com/index.html">Snipaste</a> 一个简单但强大的截图工具</li></ul>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深刻理解python装饰器</title>
      <link href="2021/03/19/shen-ke-li-jie-python-zhuang-shi-qi/"/>
      <url>2021/03/19/shen-ke-li-jie-python-zhuang-shi-qi/</url>
      
        <content type="html"><![CDATA[<p>装饰器是程序开发中经常会⽤到的⼀个功能，⽤好了装饰器，开发效率如⻁添翼</p><span id="more"></span><h1 id="一、示例代码"><a href="#一、示例代码" class="headerlink" title="一、示例代码"></a>一、示例代码</h1><pre class="line-numbers language-none"><code class="language-none"># coding&#x3D;utf-8def w1(func):    print &#39;--执行w1()--&#39;    def inner():        print &#39;--执行inner()--&#39;        func()    print &#39;--w1()执行结束--&#39;    return inner@w1def f1():    print &#39;--f1()--&#39;f1()# 执行结果--执行w1()----w1()执行结束----执行inner()----f1()--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="二、执行过程"><a href="#二、执行过程" class="headerlink" title="二、执行过程"></a>二、执行过程</h1><h2 id="1-语法糖-函数名"><a href="#1-语法糖-函数名" class="headerlink" title="1.语法糖:@+函数名"></a>1.语法糖:@+函数名</h2><p>python解释器就会从上到下解释代码，步骤如下：<br>① def w1(func): ==&gt;将w1函数加载到内存<br>② @w1<br>从表⾯上看解释器仅仅会解释这两句代码，因为函数在没有被调⽤之前其内部代码不会被执⾏。<br>但是<code>@w1</code>这⼀句代码⾥却有⼤⽂章，<code>@+函数名</code>是python的⼀种<code>语法糖</code>。</p><h2 id="2-w1内部执行过程"><a href="#2-w1内部执行过程" class="headerlink" title="2.@w1内部执行过程"></a>2.@w1内部执行过程</h2><p>在@w1内部会执行下一步操作:<br>执行w1函数，并将@w1下面的函数作为w1函数的参数</p><pre class="line-numbers language-none"><code class="language-none">@w1# 等价于 f1&#x3D;w1(f1)def f1():   xxx <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>此时f1已经不再指向原来的函数体，指向w1返回的新函数体。</p><h2 id="3-python解释器执行顺序"><a href="#3-python解释器执行顺序" class="headerlink" title="3.python解释器执行顺序"></a>3.python解释器执行顺序</h2><p>从pthon解释器层面具体执行顺序:</p><pre class="line-numbers language-none"><code class="language-none">def w1(func): # 将w1函数加载到内存<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">@w1 # 即执行w1(f1),在这里先存一个记录点，此时内存中并没有f1的定义，继续向下执行<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">def f1(): # 将f1函数加载到内存<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">@w1 # 此时才会真正执行f1 &#x3D; w1(f1),将w1函数的返回值赋值给f1，f1指向新的函数体<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="三、补充说明"><a href="#三、补充说明" class="headerlink" title="三、补充说明"></a>三、补充说明</h1><p>python解释器遇到<code>函数体()</code>才会去执行一个函数，遇到<code>def func()</code>和<code>func</code>不会去执行。</p><p>最后在来看一下代码的输出结果</p><pre class="line-numbers language-none"><code class="language-none">@w1 # 执行f1&#x3D;w1(f1)，w1函数被执行，所以w1函数体的的print会执行def f1():    print &#39;--f1()--&#39;# 执行结果--执行w1()----w1()执行结束--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">f1() # 执行被装饰后的f1# 执行结果--执行inner()----f1()--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 后端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 装饰器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git pull特别慢的解决方法</title>
      <link href="2021/03/19/git-pull-te-bie-man-de-jie-jue-fang-fa/"/>
      <url>2021/03/19/git-pull-te-bie-man-de-jie-jue-fang-fa/</url>
      
        <content type="html"><![CDATA[<blockquote><p>修改<code>hosts</code>配置解决<code>git pull</code>网络通信慢的问题</p></blockquote><span id="more"></span><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><ul><li>git pull 特别慢</li><li>ssh -T <code>git@github.com </code>很慢</li></ul><h3 id="解决办法一"><a href="#解决办法一" class="headerlink" title="解决办法一"></a>解决办法一</h3><h4 id="查询GitHub域名ip"><a href="#查询GitHub域名ip" class="headerlink" title="查询GitHub域名ip"></a>查询GitHub域名ip</h4><p>我们可以利用<a href="https://www.ipaddress.com/">https://www.ipaddress.com/</a> 来获得以下两个GitHub域名的IP地址：</p><ul><li>github.com</li><li>github.global.ssl.fastly.net</li></ul><p>打开网页后，利用输入框内分别查询两个域名：</p><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/Lfp4Xj.png" alt="github.com"><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/7rUMBA.png" alt="fastly.net"></p><h4 id="修改hosts文件-刷新dns缓存"><a href="#修改hosts文件-刷新dns缓存" class="headerlink" title="修改hosts文件,刷新dns缓存"></a>修改hosts文件,刷新dns缓存</h4><p>将以上两段IP写入Hosts文件中：</p><p>mac:</p><pre class="line-numbers language-none"><code class="language-none">sudo vi &#x2F;etc&#x2F;hosts# 添加199.232.69.194 github.global.ssl.fastly.net140.82.112.4 github.com# 退出文件执行sudo killall -HUP mDNSResponder<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>windows:</p><pre class="line-numbers language-none"><code class="language-none"># hosts文件位置：C:\windows\system32\drivers\etc刷新dns：win+r，输入CMD，回车在命令行执行:ipconfig &#x2F;flushdns #清除DNS缓存内容。ps:ipconfig &#x2F;displaydns&#x2F;&#x2F;显示DNS缓存内容<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="解决办法二"><a href="#解决办法二" class="headerlink" title="解决办法二"></a>解决办法二</h3><p>由于看到github的两个IP属地为美国，因此将代理服务器切换至美国，并开启全局模式（实际验证PAC模式问题依旧），重新打开一个终端，git pull速度大幅提升</p>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2021/03/19/hello-world/"/>
      <url>2021/03/19/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! <span id="more"></span>This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>超详细Hexo+Github博客搭建小白教程</title>
      <link href="2021/03/19/chao-xiang-xi-hexo-github-bo-ke-da-jian-xiao-bai-jiao-cheng/"/>
      <url>2021/03/19/chao-xiang-xi-hexo-github-bo-ke-da-jian-xiao-bai-jiao-cheng/</url>
      
        <content type="html"><![CDATA[<blockquote><p>利用<code>github</code>和<code>hexo</code>快速搭建个人博客，效果炫酷</p></blockquote><span id="more"></span><h3 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>首先下载稳定版Node.js[<a href="https://nodejs.org/zh-cn/download/">下载地址</a>]，选择相应的系统版本。</p><p>mac用户下载macos安装包，点击下一步安装即可。</p><pre class="line-numbers language-none"><code class="language-none">This package has installed:•Node.js v14.16.0 to &#x2F;usr&#x2F;local&#x2F;bin&#x2F;node•npm v6.14.11 to &#x2F;usr&#x2F;local&#x2F;bin&#x2F;npmMake sure that &#x2F;usr&#x2F;local&#x2F;bin is in your $PATH.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>安装好之后，打开命令终端，输入node -v和npm -v，如果出现版本号，那么就安装成功了。</p><h4 id="添加国内镜像源"><a href="#添加国内镜像源" class="headerlink" title="添加国内镜像源"></a>添加国内镜像源</h4><blockquote><p>使用阿里的国内镜像进行加速</p></blockquote><pre class="line-numbers language-none"><code class="language-none">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h3><p>为了把本地的网页文件上传到github上面去，我们需要用到分布式版本控制工具—Git[<a href="https://git-scm.com/downloads">下载地址</a>]。</p><p>安装完成后在命令提示符中输入git –version验证是否安装成功。</p><h3 id="注册Github账号"><a href="#注册Github账号" class="headerlink" title="注册Github账号"></a>注册Github账号</h3><blockquote><p>打开<a href="https://github.com/">github</a>，新建一个项目,输入自己的项目名字，后面一定要加<code>.github.io</code>后缀README初始化也要勾上。名称一定要和你的github名字完全一样，比如你<code>github</code>名字叫<code>abc</code>，那么仓库名字一定要是<code>abc.github.io</code>。</p></blockquote><p>例如我的github名称为<code>amuqiao</code><br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/FvRygZ.png" alt="FvRygZ"></p><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><p>安装</p><ul><li>[<a href="https://hexo.io/zh-cn/docs/index.html">官方安装文档</a>]</li><li>在合适的地方新建一个文件夹，用来存放自己的博客文件，比如我的博客文件都存放在<code>/Users/wangqiao/NutstoreFiles/blog-new</code>目录下。</li></ul><p>按照官方文档说明完成安装、建站操作。</p><pre class="line-numbers language-none"><code class="language-none">$ npm install -g hexo-cli$ hexo init &lt;folder&gt;$ cd &lt;folder&gt;$ npm install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>输入<code>hexo s</code>打开本地服务器，然后浏览器打开<a href="http://localhost:4000/">http://localhost:4000/</a>，就可以看到我们的博客啦，</p><pre class="line-numbers language-none"><code class="language-none">➜  blog-new hexo serverINFO  Validating configINFO  Start processingINFO  Hexo is running at http:&#x2F;&#x2F;localhost:4000 . Press Ctrl+C to stop.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/bIoB82.png" alt="bIoB82"></p><h3 id="连接Github与本地"><a href="#连接Github与本地" class="headerlink" title="连接Github与本地"></a>连接Github与本地</h3><h4 id="添加github-ssh秘钥"><a href="#添加github-ssh秘钥" class="headerlink" title="添加github ssh秘钥"></a>添加github ssh秘钥</h4><pre class="line-numbers language-none"><code class="language-none">ssh-keygen  # 直接enter即可，不用选择yes or nocat ~&#x2F;.ssh&#x2F;id_rsa.pub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>在github中配置ssh公钥<br><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/BBYeWY.png" alt="BBYeWY"></p><p>打开博客根目录下的_config.yml文件，这是博客的配置文件，在这里你可以修改与博客相关的各种信息。</p><p>修改最后一行的配置：</p><pre class="line-numbers language-none"><code class="language-none">deploy:  type: git  repository: https:&#x2F;&#x2F;github.com&#x2F;amuqiao&#x2F;amuqiao.github.io.git  branch: master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>repository修改为你自己的github项目地址。</p><h3 id="写文章、发布文章"><a href="#写文章、发布文章" class="headerlink" title="写文章、发布文章"></a>写文章、发布文章</h3><p>你可以执行下列命令来创建一篇新文章或者新的页面。</p><pre class="line-numbers language-none"><code class="language-none"># 您可以在命令中指定文章的布局（layout），默认为 post，可以通过修改 _config.yml 中的 default_layout 参数来指定默认布局。$ hexo new [layout] &lt;title&gt;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>然后打开<code>blog-new/source/_posts/</code>的目录，可以发现下面多了一个文件夹和一个.md文件，一个用来存放你的图片等数据，另一个就是你的文章文件。</p><p>编写完markdown文件后，</p><pre class="line-numbers language-none"><code class="language-none">hexo g # 生成静态网页hexo s # 可以本地预览效果<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这时打开你的<a href="http://localhost:4000/">http://localhost:4000</a>就能看到发布的文章啦。</p><h3 id="一键部署"><a href="#一键部署" class="headerlink" title="一键部署"></a>一键部署</h3><p>安装 <a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a>.</p><pre class="line-numbers language-none"><code class="language-none">$ npm install hexo-deployer-git --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在 _config.yml（如果有已存在的请删除）添加如下配置：</p><pre class="line-numbers language-none"><code class="language-none">deploy:  type: git  repo: git@github.com:amuqiao&#x2F;amuqiao.github.io.git  branch: main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>运行 <code>hexo clean</code> &amp;&amp; <code>hexo deploy</code> 。</p><p>查看 <code>username.github.io</code> 上的网页是否部署成功。</p><h3 id="博客备份"><a href="#博客备份" class="headerlink" title="博客备份"></a>博客备份</h3><p>有时候我们想换一台电脑继续写博客，这时候就可以将博客目录下的所有源文件都上传到github上面。</p><p>首先在github博客仓库下新建一个分支hexo，然后git clone到本地，把.git文件夹拿出来，放在博客根目录下。</p><pre class="line-numbers language-none"><code class="language-none">git clone git@github.com:amuqiao&#x2F;amuqiao.github.io.gitcd amuqiao.github.io# mac shift+command+. 显示隐藏文件夹mv .git&#x2F; ..&#x2F;blog-new  # 将.git目录移动到博客根目录git checkout hexo # 切换到hexo分支git add . # git commit -m &quot;xxx&quot; git push origin hexo # 推送到远端分支<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在<code>github</code>上可以看到，<code>main</code>分支只有静态网页文件，<code>hexo</code>分支包含所有源文件</p><h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><p>博客主题: <a href="https://github.com/blinkfox/hexo-theme-matery/blob/develop/README_CN.md">hexo-theme-matery</a>，它的文档写得也非常的详细，还有中英文两个版本，作者回复也很及时。</p><h3 id="文章模板设置"><a href="#文章模板设置" class="headerlink" title="文章模板设置"></a>文章模板设置</h3><p>首先为了新建文章方便，建议将/scaffolds/post.md修改为如下代码：</p><pre class="line-numbers language-none"><code class="language-none">--- title: &#123;&#123; title &#125;&#125; date: &#123;&#123; date &#125;&#125; top: false cover: false password: toc: true mathjax: true summary: tags: categories: ---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>新建文章后不用你自己补充了，修改信息就行。</p><h3 id="添加百度统计和谷歌统计代码"><a href="#添加百度统计和谷歌统计代码" class="headerlink" title="添加百度统计和谷歌统计代码"></a>添加百度统计和谷歌统计代码</h3><p>首先打开<a href="https://ziyuan.baidu.com/site/index">百度站长平台</a>，然后点击添加网站，输入网址并选择领域。</p><p>接下来要验证网站所有权，有三种方式，推荐采用HTML标签验证，最简单，将代码复制出来。</p><p>打开themes/matery/layout/_partial/head.ejs，修改下面两行：</p><pre class="line-numbers language-none"><code class="language-none">&lt;meta name&#x3D;&quot;baidu-site-verification&quot; content&#x3D;&quot;xxx&quot; &#x2F;&gt;&lt;meta name&#x3D;&quot;google-site-verification&quot; content&#x3D;&quot;xxx&quot; &#x2F;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>其中content内容改成你自己刚刚复制出来的就行了。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://godweiyang.com/2018/04/13/hexo-blog/">超详细Hexo+Github博客搭建小白教程</a></li><li><a href="https://blinkfox.github.io/2018/09/28/qian-duan/hexo-bo-ke-zhu-ti-zhi-hexo-theme-matery-de-jie-shao/">Hexo博客主题之hexo-theme-matery的介绍</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> hexo-theme-matery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>matery主题定制</title>
      <link href="2021/03/19/matery-zhu-ti-ding-zhi/"/>
      <url>2021/03/19/matery-zhu-ti-ding-zhi/</url>
      
        <content type="html"><![CDATA[<blockquote><p>基于hexo-theme-matery做的个性化美化</p></blockquote><span id="more"></span><h3 id="限定预览文字字数"><a href="#限定预览文字字数" class="headerlink" title="限定预览文字字数"></a>限定预览文字字数</h3><pre class="line-numbers language-none"><code class="language-none"># 在预览文字后添加限定符号 &lt;!-- more--&gt;Welcome to Hexo &lt;!-- more--&gt; This is your very first post. <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/87j2QT.jpg" alt="限定预览文字"></p><h3 id="去掉首页banner的背景颜色"><a href="#去掉首页banner的背景颜色" class="headerlink" title="去掉首页banner的背景颜色"></a>去掉首页banner的背景颜色</h3><p>打开<code>themes/matery/source/css/matery.css</code>文件(367行，也可以快速搜索<code>.bg-cover:after</code>进行定位):<br>然后注释掉这两行<code>css</code></p><pre class="line-numbers language-none"><code class="language-none">.bg-cover:after &#123;    &#x2F;* -webkit-animation: rainbow 60s infinite;    animation: rainbow 60s infinite; *&#x2F;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="修改社交连接"><a href="#修改社交连接" class="headerlink" title="修改社交连接"></a>修改社交连接</h3><p>首页第二个按钮跳转到自己的github</p><p>修改主题配置文件，修改链接</p><pre class="line-numbers language-none"><code class="language-none">首页 banner 中的第二行个人信息配置，留空即不启用indexbtn:  enable: false  name: Github  icon: fab fa-github-alt  url: https:&#x2F;&#x2F;github.com&#x2F;blinkfox&#x2F;hexo-theme-matery  # 首页 banner 中的第二行个人信息配置，留空即不启用socialLink:  github:  https:&#x2F;&#x2F;github.com&#x2F;blinkfox  email: 1181062873@qq.com  facebook: # https:&#x2F;&#x2F;www.facebook.com&#x2F;xxx  twitter: # https:&#x2F;&#x2F;twitter.com&#x2F;xxx  qq: 1181062873  weibo: # https:&#x2F;&#x2F;weibo.com&#x2F;xxx  zhihu: # https:&#x2F;&#x2F;www.zhihu.com&#x2F;xxx  rss: true # true、false<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="本地资源文件夹"><a href="#本地资源文件夹" class="headerlink" title="本地资源文件夹"></a>本地资源文件夹</h3><blockquote><p>资源（Asset）代表 source 文件夹中除了文章以外的所有文件，例如图片、CSS、JS 文件等。比方说，如果你的Hexo项目中只有少量图片，那最简单的方法就是将它们放在 source/images 文件夹中。然后通过类似于 <img src="/images/image.jpg"> 的方法访问它们。</p></blockquote><p>添加<a href="https://hexo.io/zh-cn/docs/asset-folders.html">资源文件夹</a></p><h3 id="指定文章特色图片"><a href="#指定文章特色图片" class="headerlink" title="指定文章特色图片"></a>指定文章特色图片</h3><p><img src="https://aamuqiao.oss-cn-beijing.aliyuncs.com/uPic/%E6%A3%AE%E6%9E%97%E7%9A%84%E7%8C%AB.jpg" alt="森林的猫"></p><p>修改文章 Front-matter选项</p><ul><li>修改<code>img</code>为图片的<code>url</code>链接</li></ul><pre class="line-numbers language-none"><code class="language-none">img: https:&#x2F;&#x2F;aamuqiao.oss-cn-beijing.aliyuncs.com&#x2F;uPic&#x2F;%E6%A3%AE%E6%9E%97%E7%9A%84%E7%8C%AB.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>修改为本地资源路径</li></ul><pre class="line-numbers language-none"><code class="language-none">img: images&#x2F;森林的猫.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="添加文章特色图片"><a href="#添加文章特色图片" class="headerlink" title="添加文章特色图片"></a>添加文章特色图片</h3><p>主题下配置文件</p><pre class="line-numbers language-none"><code class="language-none">featureImages:- &#x2F;medias&#x2F;featureimages&#x2F;0.jpg- &#x2F;medias&#x2F;featureimages&#x2F;1.jpg- &#x2F;medias&#x2F;featureimages&#x2F;2.jpg- &#x2F;medias&#x2F;featureimages&#x2F;3.jpg...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在<code>featureimages</code>新增图片后添加到配置中</p><h3 id="添加视频链接"><a href="#添加视频链接" class="headerlink" title="添加视频链接"></a>添加视频链接</h3><p>若不设置height和width则采用默认大小</p><pre class="line-numbers language-none"><code class="language-none">&lt;iframe src&#x3D;&quot;https:&#x2F;&#x2F;vdn1.vzuu.com&#x2F;SD&#x2F;e3cc53d8-a9cb-11e8-9bd8-0242ac112a24.mp4?disable_local_cache&#x3D;1&amp;auth_key&#x3D;1622534176-0-0-63692becd56e6a743c78d08f951eccd8&amp;f&#x3D;mp4&amp;bu&#x3D;http-com&amp;expiration&#x3D;1622534176&amp;v&#x3D;hw&quot; &lt;&#x2F;iframe&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><iframe src="https://vdn1.vzuu.com/SD/e3cc53d8-a9cb-11e8-9bd8-0242ac112a24.mp4?disable_local_cache=1&auth_key=1622534176-0-0-63692becd56e6a743c78d08f951eccd8&f=mp4&bu=http-com&expiration=1622534176&v=hw" </iframe><p>html中的iframe标签</p><pre class="line-numbers language-none"><code class="language-none">&lt;iframe height&#x3D;520 width&#x3D;820 src&#x3D;&quot;&#x2F;&#x2F;player.bilibili.com&#x2F;player.html?aid&#x3D;502349665&amp;bvid&#x3D;BV1KK411w7rv&amp;cid&#x3D;315155499&amp;page&#x3D;1&quot; scrolling&#x3D;&quot;no&quot; border&#x3D;&quot;0&quot; frameborder&#x3D;&quot;no&quot; framespacing&#x3D;&quot;0&quot; allowfullscreen&#x3D;&quot;true&quot;&gt; &lt;&#x2F;iframe&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><iframe height=520 width=820 src="//player.bilibili.com/player.html?aid=502349665&bvid=BV1KK411w7rv&cid=315155499&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> hexo-theme-matery </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
